{
  "hash": "8c83b1af28f0f2e9e49096343a4cdc56",
  "result": {
    "engine": "knitr",
    "markdown": "# GREP and Regular Expressions {#sec-grep-regex}\n\n\n\n::: {.callout-note title=\"Learning Objectives\"}\nAfter completing this chapter, you will be able to:\n\n- Use `grep` to search for patterns in files and data streams\n- Construct regular expressions to match complex patterns\n- Apply extended regular expressions for advanced pattern matching\n- Combine `grep` with other Unix tools for sophisticated text processing\n- Search genomic data for biological patterns like restriction sites and motifs\n:::\n\n## Introduction to Pattern Matching {#sec-pattern-matching}\n\nWhile the tools in @sec-files-pipes can filter and transform data, they work on whole lines or fixed positions. **Pattern matching** lets you search based on the *content* of text—finding lines that contain specific sequences of characters.\n\n**GREP** (**G**lobal **R**egular **E**xpression **P**rint) is the Unix standard for pattern matching. Originally developed for the ed text editor in the 1970s, `grep` remains essential for bioinformatics, log analysis, and text processing.\n\n## Basic GREP Usage {#sec-basic-grep}\n\nAt its simplest, `grep` finds lines containing a specific string:\n\n```bash\n# Find lines containing \"error\"\n$ grep \"error\" logfile.txt\n\n# Search multiple files\n$ grep \"mutation\" *.txt\n\n# Search recursively in directories\n$ grep -r \"BRCA1\" data/\n```\n\n### Essential GREP Options\n\n| Option | Description |\n|:-------|:------------|\n| `-i` | Case-insensitive search |\n| `-v` | Invert match (lines NOT containing pattern) |\n| `-c` | Count matching lines |\n| `-n` | Show line numbers |\n| `-l` | List only filenames with matches |\n| `-o` | Print only the matched part |\n| `-w` | Match whole words only |\n| `-A n` | Show n lines after match |\n| `-B n` | Show n lines before match |\n| `-C n` | Show n lines before and after match |\n\n: Common `grep` options {#tbl-grep-options}\n\n### Examples\n\n```bash\n# Case-insensitive search\n$ grep -i \"gene\" annotations.txt\n\n# Count matches (not lines, just the count)\n$ grep -c \">\" sequences.fasta\n\n# Show line numbers\n$ grep -n \"ERROR\" application.log\n\n# Find files containing pattern\n$ grep -l \"experimental\" *.md\n\n# Remove comment lines (inverted match)\n$ grep -v \"^#\" config.txt\n\n# Show context around matches\n$ grep -C 2 \"significant\" results.txt\n```\n\n## Introduction to Regular Expressions {#sec-regex-intro}\n\nSo far we've searched for literal text. **Regular expressions** (regex) let you describe patterns that match multiple strings.\n\nFor example, the pattern `[ACGT]+` matches any sequence of DNA bases, while `colou?r` matches both \"color\" and \"colour\".\n\n### Metacharacters: Characters with Special Meaning\n\nRegular expressions use certain characters as pattern-building blocks:\n\n| Character | Meaning | Example |\n|:----------|:--------|:--------|\n| `.` | Any single character | `a.c` matches \"abc\", \"a1c\", \"a-c\" |\n| `*` | Zero or more of preceding | `ab*c` matches \"ac\", \"abc\", \"abbc\" |\n| `^` | Start of line | `^Hello` matches lines starting with \"Hello\" |\n| `$` | End of line | `end$` matches lines ending with \"end\" |\n| `[]` | Character class | `[aeiou]` matches any vowel |\n| `[^]` | Negated class | `[^0-9]` matches non-digits |\n| `\\` | Escape special characters | `\\.` matches literal period |\n\n: Basic regular expression metacharacters {#tbl-regex-basic}\n\n::: {.callout-note}\nThe `*` in regular expressions is different from the `*` wildcard in the shell. In regex, `*` means \"zero or more of the preceding character.\" In shell globbing, `*` means \"any characters.\"\n:::\n\n### Anchors: Position Matching\n\nAnchors don't match characters—they match positions:\n\n```bash\n# Lines starting with \"Chr\"\n$ grep \"^Chr\" genome.gff\n\n# Lines ending with \"protein\"\n$ grep \"protein$\" annotations.txt\n\n# Empty lines\n$ grep \"^$\" file.txt\n\n# Lines with exactly \"gene\"\n$ grep \"^gene$\" list.txt\n```\n\n### Character Classes\n\nCharacter classes match any single character from a set:\n\n```bash\n# Match any vowel\n$ grep \"[aeiou]\" words.txt\n\n# Match any digit\n$ grep \"[0-9]\" data.txt\n\n# Match any uppercase letter\n$ grep \"[A-Z]\" text.txt\n\n# Match DNA bases\n$ grep \"[ACGT]\" sequence.txt\n\n# Match non-DNA characters (errors in sequence)\n$ grep \"[^ACGTN]\" sequence.txt\n```\n\n**Predefined character classes:**\n\n- `[[:alpha:]]` — letters\n- `[[:digit:]]` — digits (same as `[0-9]`)\n- `[[:alnum:]]` — letters and digits\n- `[[:space:]]` — whitespace\n- `[[:upper:]]` — uppercase letters\n- `[[:lower:]]` — lowercase letters\n\n### Quantifiers\n\nQuantifiers specify how many times a pattern should repeat:\n\n```bash\n# Match \"color\" or \"colour\" (zero or one 'u')\n$ grep \"colou\\?r\" text.txt\n\n# Three consecutive A's\n$ grep \"A\\{3\\}\" sequence.txt\n\n# Two to four T's\n$ grep \"T\\{2,4\\}\" sequence.txt\n\n# At least three G's\n$ grep \"G\\{3,\\}\" sequence.txt\n```\n\n::: {.callout-warning}\nIn basic `grep`, quantifiers like `?`, `+`, and `{}` must be escaped with `\\`. Use `grep -E` or `egrep` to avoid escaping.\n:::\n\n## Extended Regular Expressions {#sec-extended-regex}\n\nExtended regular expressions (ERE) add more metacharacters and don't require escaping common quantifiers. Use `grep -E` or `egrep`:\n\n| Character | Meaning |\n|:----------|:--------|\n| `+` | One or more of preceding |\n| `?` | Zero or one of preceding |\n| `{n}` | Exactly n of preceding |\n| `{n,m}` | Between n and m of preceding |\n| `\\|` | Alternation (OR) |\n| `()` | Grouping |\n\n: Extended regular expression metacharacters {#tbl-regex-extended}\n\n### Alternation: Matching Multiple Patterns\n\n```bash\n# Match \"start\" OR \"stop\" OR \"pause\"\n$ grep -E \"start|stop|pause\" commands.txt\n\n# Match any start codon\n$ grep -E \"ATG|GTG|TTG\" sequences.fa\n\n# Match file extensions\n$ grep -E \"\\.(txt|csv|tsv)$\" filelist.txt\n```\n\n### Grouping\n\nParentheses group patterns together:\n\n```bash\n# Match \"gray\" or \"grey\"\n$ grep -E \"gr(a|e)y\" text.txt\n\n# Match \"ab\", \"abab\", \"ababab\", etc.\n$ grep -E \"(ab)+\" data.txt\n\n# Match repeated dinucleotide\n$ grep -E \"(AT){3,}\" sequence.txt\n```\n\n### The Plus Quantifier\n\nUnlike `*` (zero or more), `+` requires at least one match:\n\n```bash\n# One or more A's followed by one or more T's\n$ grep -E \"A+T+\" sequence.txt\n\n# One or more digits\n$ grep -E \"[0-9]+\" data.txt\n```\n\n## Practical Bioinformatics Examples {#sec-regex-bioinformatics}\n\n### Working with FASTA Files\n\n```bash\n# Count sequences (lines starting with >)\n$ grep -c \"^>\" sequences.fa\n\n# Extract all headers\n$ grep \"^>\" sequences.fa\n\n# Find specific gene headers\n$ grep -i \"kinase\" sequences.fa\n\n# Find sequences by organism\n$ grep -E \"^>.*Homo sapiens\" proteins.fa\n```\n\n### Searching for Biological Motifs\n\n```bash\n# Find restriction enzyme sites\n$ grep -E \"GAATTC\" genome.fa         # EcoRI\n$ grep -E \"GGATCC\" genome.fa         # BamHI\n$ grep -E \"G[ACGT]ANTC\" genome.fa    # Degenerate site\n\n# Find potential ORFs (start followed by bases, then stop)\n$ grep -oE \"ATG([ACGT]{3})*?(TAA|TAG|TGA)\" cds.fa\n\n# Find poly-A tails\n$ grep -E \"A{10,}\" transcripts.fa\n\n# Find microsatellites (dinucleotide repeats)\n$ grep -E \"(AT){5,}\" genome.fa\n$ grep -E \"(CA){5,}\" genome.fa\n```\n\n### Analyzing GFF/GTF Files\n\n```bash\n# Find all genes\n$ grep -P \"\\tgene\\t\" annotations.gff\n\n# Find genes on chromosome 1\n$ grep \"^chr1\" genes.gff | grep -P \"\\tgene\\t\"\n\n# Extract gene IDs\n$ grep -oE \"gene_id \\\"[^\\\"]+\\\"\" annotations.gtf\n\n# Find protein-coding genes\n$ grep \"protein_coding\" annotations.gtf\n```\n\n### Log File Analysis\n\n```bash\n# Find errors in logs\n$ grep -i \"error\" application.log\n\n# Find specific error codes\n$ grep -E \"error\\s*[0-9]{3}\" application.log\n\n# Extract timestamps of errors\n$ grep -E \"^[0-9]{4}-[0-9]{2}-[0-9]{2}.*error\" log.txt\n\n# Count errors per type\n$ grep -oE \"ERROR: [A-Za-z]+\" log.txt | sort | uniq -c\n```\n\n## Combining GREP with Pipes {#sec-grep-pipes}\n\nThe real power of `grep` emerges when combined with other tools:\n\n```bash\n# Count unique patterns\n$ grep \"^>\" sequences.fa | sort | uniq | wc -l\n\n# Extract sequence names without > symbol\n$ grep \"^>\" sequences.fa | cut -c2-\n\n# Find headers, then get organism names\n$ grep \"^>\" proteins.fa | grep -oE \"\\[.*\\]\" | sort | uniq -c | sort -rn\n\n# Process FASTA: count bases per sequence\n$ grep -v \"^>\" sequence.fa | while read line; do\n    echo \"$line\" | wc -c\n  done\n```\n\n### Extracting Matching Regions\n\nThe `-o` flag prints only the matched portion:\n\n```bash\n# Extract all email addresses\n$ grep -oE \"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\" contacts.txt\n\n# Extract all URLs\n$ grep -oE \"https?://[a-zA-Z0-9./?=_-]+\" webpage.html\n\n# Extract gene names from headers\n$ grep \"^>\" genes.fa | grep -oE \"gene=[^;]+\"\n```\n\n### Context Searches\n\nWhen you need to see what surrounds a match:\n\n```bash\n# Show 3 lines after each match (including the sequence)\n$ grep -A 3 \"^>interesting_gene\" sequences.fa\n\n# Show lines before and after\n$ grep -C 5 \"error\" logfile.txt\n\n# Extract sequence following a header\n$ grep -A 1 \"^>target_gene\" sequences.fa | grep -v \"^>\"\n```\n\n## Processing Genomic Data: A Complete Example {#sec-genomic-processing}\n\nLet's work through a realistic analysis pipeline for human chromosome data.\n\n### Downloading the Data\n\n```bash\n# Download human chromosome 21 (smaller for practice)\n$ wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/\\\nGCF_000001405.40_GRCh38.p14/GCF_000001405.40_GRCh38.p14_genomic.fna.gz\n\n# Or work with a subset\n$ zcat genome.fa.gz | head -1000 > sample.fa\n```\n\n### Analyzing Sequence Content\n\n```bash\n# Count sequences in the file\n$ grep -c \"^>\" genome.fa\n\n# View headers\n$ grep \"^>\" genome.fa | head\n\n# Total bases (excluding headers and newlines)\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | wc -c\n\n# Nucleotide frequencies\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | fold -w1 | sort | uniq -c\n```\n\n### Finding Restriction Enzyme Sites\n\n```bash\n# Count EcoRI sites (GAATTC)\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | grep -o \"GAATTC\" | wc -l\n\n# Count multiple restriction sites\n$ for site in GAATTC GGATCC AAGCTT CTCGAG; do\n    count=$(grep -v \"^>\" genome.fa | tr -d '\\n' | grep -o \"$site\" | wc -l)\n    echo \"$site: $count\"\n  done\n\n# Find context around restriction sites (50 bases each side)\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | grep -oE \".{50}GAATTC.{50}\" | head\n```\n\n### Finding Simple Sequence Repeats\n\n```bash\n# Dinucleotide repeats\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | grep -oE \"(AT){5,}\" | wc -l\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | grep -oE \"(CA){5,}\" | wc -l\n\n# Homopolymer runs (consecutive same base)\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | grep -oE \"A{10,}\" | wc -l\n$ grep -v \"^>\" genome.fa | tr -d '\\n' | grep -oE \"T{10,}\" | wc -l\n```\n\n### Stream Processing Large Files\n\nProcess data without loading it entirely into memory:\n\n```bash\n# Download, decompress, and analyze in one pipeline\n$ curl -s ftp://example.com/genome.fa.gz | \\\n  gunzip -c | \\\n  grep -v \"^>\" | \\\n  tr -d '\\n' | \\\n  grep -o \"GAATTC\" | \\\n  wc -l\n\n# Process compressed file directly\n$ zgrep -c \"^>\" genome.fa.gz\n```\n\n## Common Patterns Reference {#sec-common-patterns}\n\nHere's a quick reference for frequently needed patterns:\n\n| Pattern | What It Matches |\n|:--------|:----------------|\n| `^>` | FASTA headers |\n| `^#` | Comment lines |\n| `^$` | Empty lines |\n| `[ACGT]+` | DNA sequence |\n| `[ACGU]+` | RNA sequence |\n| `[A-Z]{3}` | Uppercase triplet (codon) |\n| `ATG([ACGT]{3})*` | Potential ORF |\n| `(TAA\\|TAG\\|TGA)` | Stop codons |\n| `A{n,}` | Poly-A of at least n |\n| `\\t` | Tab character |\n| `\\s+` | One or more whitespace |\n| `[0-9]+\\.[0-9]+` | Decimal number |\n\n: Common regular expression patterns for bioinformatics {#tbl-common-patterns}\n\n## Summary {#sec-regex-summary}\n\nThis chapter covered pattern matching with `grep` and regular expressions:\n\n- `grep` finds lines matching patterns in files or streams\n- Basic regex uses metacharacters: `.`, `*`, `^`, `$`, `[]`\n- Extended regex (`grep -E`) adds: `+`, `?`, `|`, `{}`\n- Character classes match sets of characters\n- Anchors match positions (start/end of line)\n- Combining `grep` with pipes enables powerful analysis\n- Genomic data analysis uses these tools for motif searching\n\nRegular expressions are a foundational skill. While the syntax can seem cryptic initially, investment in learning regex pays off enormously across all aspects of computational biology.\n\n## Additional Reading {.unnumbered}\n\nTo deepen your understanding of regular expressions:\n\n- **[Regular-Expressions.info](https://www.regular-expressions.info/)** — A comprehensive tutorial and reference site for regex\n- **[RegexOne](https://regexone.com/)** — An interactive tutorial for learning regular expressions step by step\n- **[regex101.com](https://regex101.com/)** — An online regex tester with explanations of each component\n- **\"Mastering Regular Expressions\"** by Jeffrey Friedl — The definitive book on regex theory and practice\n\nFor bioinformatics-specific pattern matching:\n\n- **[BioStars: Regular Expressions in Bioinformatics](https://www.biostars.org/)** — Community Q&A with many regex examples\n- **[Rosalind.info](http://rosalind.info/)** — Bioinformatics problem sets that often require regex solutions\n- **GNU Grep Manual** — Official documentation with advanced options: `man grep` or online at [gnu.org](https://www.gnu.org/software/grep/manual/)\n\n## Exercises {.unnumbered}\n\n::: {.callout-tip title=\"Practice Exercises\"}\n**Exercise 1: Basic Pattern Matching**\n\nCreate a file with various text and practice:\n1. Find all lines containing \"the\" (case-insensitive)\n2. Find lines starting with a capital letter\n3. Find lines ending with a period\n4. Count empty lines\n\n**Exercise 2: Biological Patterns**\n\nUsing a FASTA file:\n1. Count the number of sequences\n2. Extract headers for sequences longer than 1000 bp (hint: you'll need multiple commands)\n3. Find all sequences containing the pattern \"TATAAA\" (TATA box)\n4. Count how many sequences have \"chromosome\" in their header\n\n**Exercise 3: Regular Expression Practice**\n\nWrite `grep` commands to match:\n1. Phone numbers in format: (555) 555-5555\n2. Email addresses\n3. Dates in YYYY-MM-DD format\n4. DNA sequences that are exactly 20 bases long\n\n**Exercise 4: Genomic Analysis Pipeline**\n\nDownload a bacterial genome and:\n1. Calculate the genome size\n2. Count all restriction sites for at least 3 different enzymes\n3. Find the longest homopolymer run\n4. Calculate GC content using only Unix tools\n5. Document your pipeline in a shell script\n:::\n",
    "supporting": [
      "05-grep-regex_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}