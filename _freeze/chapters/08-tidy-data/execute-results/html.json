{
  "hash": "d53ab3d0d16e72301acb66fae2dd49ed",
  "result": {
    "engine": "knitr",
    "markdown": "# Tidy Data Principles {#sec-tidy-data}\n\n\n\n::: {.callout-note title=\"Learning Objectives\"}\nAfter completing this chapter, you will be able to:\n\n- Define tidy data and explain its three principles\n- Identify common problems in messy datasets\n- Apply tidy data principles to your own data\n- Distinguish between different data types\n- Implement best practices for data organization\n- Use appropriate file formats for data storage\n- Use the tidyverse packages for data manipulation\n- Apply dplyr verbs: filter, select, mutate, arrange, summarize\n- Join multiple data frames using various join types\n- Reshape data between wide and long formats with pivot functions\n- Chain operations using the pipe operator\n- Work with tibbles as modern data frames\n- Understand when to use data.table for high-performance data wrangling\n:::\n\n## Why Data Organization Matters {#sec-why-data-organization}\n\nBefore you can analyze data, you must organize it. The structure of your data profoundly affects how easily you can work with it. A well-organized dataset can be analyzed in minutes; a poorly organized one might require hours of preprocessing.\n\nConsider this scenario: you've completed an experiment and collected data in a spreadsheet. Now you need to analyze it. If your data is organized consistently and logically, analysis is straightforward. If it's scattered across multiple tabs with inconsistent formatting, merged cells, and color-coded values, you're in for a frustrating experience.\n\n**Tidy data** provides a standard way to organize data that makes analysis easier. It's not the only valid way to structure data, but it's particularly well-suited for analysis in R and Python.\n\n## The Three Principles of Tidy Data {#sec-tidy-principles}\n\nHadley Wickham formalized the concept of tidy data in a influential paper [@wickham2014tidy]. Tidy data follows three rules:\n\n::: {.callout-important title=\"The Three Rules of Tidy Data\"}\n1. Each **variable** forms a column\n2. Each **observation** forms a row\n3. Each **value** has its own cell\n:::\n\nLet's unpack what these mean.\n\n### Variables as Columns\n\nA **variable** is a characteristic that you measure, observe, or categorize. Examples:\n\n- Gene expression level\n- Treatment group\n- Patient age\n- Sample ID\n- Measurement date\n\nEach variable should have its own column with a descriptive header.\n\n### Observations as Rows\n\nAn **observation** is a single unit of data collection—typically one measurement from one subject at one time point. Each observation gets its own row.\n\n### Values in Cells\n\nEach cell contains exactly one value. No merged cells, no multiple values crammed together, no implicit values indicated by color or formatting.\n\n## Tidy vs. Messy Data: Examples {#sec-tidy-examples}\n\n### A Tidy Dataset\n\n\n::: {#tbl-tidy-example .cell layout-align=\"center\" tbl-cap='Example of tidy data organization'}\n\n```{.r .cell-code}\ntidy_data <- tibble(\n  sample_id = c(\"S001\", \"S002\", \"S003\", \"S001\", \"S002\", \"S003\"),\n  timepoint = c(\"0h\", \"0h\", \"0h\", \"24h\", \"24h\", \"24h\"),\n  gene = rep(\"BRCA1\", 6),\n  expression = c(4.2, 3.8, 4.5, 8.1, 7.9, 9.2)\n)\n\ntidy_data |>\n  gt() |>\n  tab_header(title = \"Gene Expression Data (Tidy Format)\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ppypubdgjn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ppypubdgjn table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ppypubdgjn thead, #ppypubdgjn tbody, #ppypubdgjn tfoot, #ppypubdgjn tr, #ppypubdgjn td, #ppypubdgjn th {\n  border-style: none;\n}\n\n#ppypubdgjn p {\n  margin: 0;\n  padding: 0;\n}\n\n#ppypubdgjn .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ppypubdgjn .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ppypubdgjn .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ppypubdgjn .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ppypubdgjn .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ppypubdgjn .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ppypubdgjn .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ppypubdgjn .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ppypubdgjn .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ppypubdgjn .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ppypubdgjn .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ppypubdgjn .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ppypubdgjn .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ppypubdgjn .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ppypubdgjn .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppypubdgjn .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ppypubdgjn .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ppypubdgjn .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ppypubdgjn .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppypubdgjn .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ppypubdgjn .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppypubdgjn .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ppypubdgjn .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppypubdgjn .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ppypubdgjn .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppypubdgjn .gt_left {\n  text-align: left;\n}\n\n#ppypubdgjn .gt_center {\n  text-align: center;\n}\n\n#ppypubdgjn .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ppypubdgjn .gt_font_normal {\n  font-weight: normal;\n}\n\n#ppypubdgjn .gt_font_bold {\n  font-weight: bold;\n}\n\n#ppypubdgjn .gt_font_italic {\n  font-style: italic;\n}\n\n#ppypubdgjn .gt_super {\n  font-size: 65%;\n}\n\n#ppypubdgjn .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ppypubdgjn .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ppypubdgjn .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ppypubdgjn .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ppypubdgjn .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ppypubdgjn .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ppypubdgjn .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ppypubdgjn .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ppypubdgjn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Gene Expression Data (Tidy Format)</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sample_id\">sample_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"timepoint\">timepoint</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gene\">gene</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"expression\">expression</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S001</td>\n<td headers=\"timepoint\" class=\"gt_row gt_left\">0h</td>\n<td headers=\"gene\" class=\"gt_row gt_left\">BRCA1</td>\n<td headers=\"expression\" class=\"gt_row gt_right\">4.2</td></tr>\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S002</td>\n<td headers=\"timepoint\" class=\"gt_row gt_left\">0h</td>\n<td headers=\"gene\" class=\"gt_row gt_left\">BRCA1</td>\n<td headers=\"expression\" class=\"gt_row gt_right\">3.8</td></tr>\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S003</td>\n<td headers=\"timepoint\" class=\"gt_row gt_left\">0h</td>\n<td headers=\"gene\" class=\"gt_row gt_left\">BRCA1</td>\n<td headers=\"expression\" class=\"gt_row gt_right\">4.5</td></tr>\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S001</td>\n<td headers=\"timepoint\" class=\"gt_row gt_left\">24h</td>\n<td headers=\"gene\" class=\"gt_row gt_left\">BRCA1</td>\n<td headers=\"expression\" class=\"gt_row gt_right\">8.1</td></tr>\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S002</td>\n<td headers=\"timepoint\" class=\"gt_row gt_left\">24h</td>\n<td headers=\"gene\" class=\"gt_row gt_left\">BRCA1</td>\n<td headers=\"expression\" class=\"gt_row gt_right\">7.9</td></tr>\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S003</td>\n<td headers=\"timepoint\" class=\"gt_row gt_left\">24h</td>\n<td headers=\"gene\" class=\"gt_row gt_left\">BRCA1</td>\n<td headers=\"expression\" class=\"gt_row gt_right\">9.2</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nThis is tidy because:\n\n- Each column is a variable (sample_id, timepoint, gene, expression)\n- Each row is an observation (one expression measurement)\n- Each cell has one value\n\n### A Messy Dataset (Same Data)\n\nA common messy format spreads measurements across columns:\n\n\n::: {#tbl-messy-example .cell layout-align=\"center\" tbl-cap='The same data in messy (wide) format'}\n\n```{.r .cell-code}\nmessy_data <- tibble(\n  sample_id = c(\"S001\", \"S002\", \"S003\"),\n  `BRCA1_0h` = c(4.2, 3.8, 4.5),\n  `BRCA1_24h` = c(8.1, 7.9, 9.2)\n)\n\nmessy_data |>\n  gt() |>\n  tab_header(title = \"Gene Expression Data (Messy Format)\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lqxmnacgwl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lqxmnacgwl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lqxmnacgwl thead, #lqxmnacgwl tbody, #lqxmnacgwl tfoot, #lqxmnacgwl tr, #lqxmnacgwl td, #lqxmnacgwl th {\n  border-style: none;\n}\n\n#lqxmnacgwl p {\n  margin: 0;\n  padding: 0;\n}\n\n#lqxmnacgwl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lqxmnacgwl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lqxmnacgwl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lqxmnacgwl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lqxmnacgwl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lqxmnacgwl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lqxmnacgwl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lqxmnacgwl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lqxmnacgwl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lqxmnacgwl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lqxmnacgwl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lqxmnacgwl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lqxmnacgwl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lqxmnacgwl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lqxmnacgwl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lqxmnacgwl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lqxmnacgwl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lqxmnacgwl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lqxmnacgwl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lqxmnacgwl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lqxmnacgwl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lqxmnacgwl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lqxmnacgwl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lqxmnacgwl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lqxmnacgwl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lqxmnacgwl .gt_left {\n  text-align: left;\n}\n\n#lqxmnacgwl .gt_center {\n  text-align: center;\n}\n\n#lqxmnacgwl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lqxmnacgwl .gt_font_normal {\n  font-weight: normal;\n}\n\n#lqxmnacgwl .gt_font_bold {\n  font-weight: bold;\n}\n\n#lqxmnacgwl .gt_font_italic {\n  font-style: italic;\n}\n\n#lqxmnacgwl .gt_super {\n  font-size: 65%;\n}\n\n#lqxmnacgwl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lqxmnacgwl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lqxmnacgwl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lqxmnacgwl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lqxmnacgwl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lqxmnacgwl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lqxmnacgwl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lqxmnacgwl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lqxmnacgwl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Gene Expression Data (Messy Format)</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sample_id\">sample_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"BRCA1_0h\">BRCA1_0h</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"BRCA1_24h\">BRCA1_24h</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S001</td>\n<td headers=\"BRCA1_0h\" class=\"gt_row gt_right\">4.2</td>\n<td headers=\"BRCA1_24h\" class=\"gt_row gt_right\">8.1</td></tr>\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S002</td>\n<td headers=\"BRCA1_0h\" class=\"gt_row gt_right\">3.8</td>\n<td headers=\"BRCA1_24h\" class=\"gt_row gt_right\">7.9</td></tr>\n    <tr><td headers=\"sample_id\" class=\"gt_row gt_left\">S003</td>\n<td headers=\"BRCA1_0h\" class=\"gt_row gt_right\">4.5</td>\n<td headers=\"BRCA1_24h\" class=\"gt_row gt_right\">9.2</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nThis is messy because:\n\n- Time point and gene are embedded in column names\n- Each row represents multiple observations\n- Adding genes or timepoints requires adding columns\n\n### Why It Matters\n\nWith tidy data, operations are straightforward:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calculate mean expression by timepoint\ntidy_data |>\n  group_by(timepoint) |>\n  summarize(mean_expression = mean(expression))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|timepoint | mean_expression|\n|:---------|---------------:|\n|0h        |        4.166667|\n|24h       |        8.400000|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Easy to filter and plot\ntidy_data |>\n  filter(timepoint == \"24h\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |timepoint |gene  | expression|\n|:---------|:---------|:-----|----------:|\n|S001      |24h       |BRCA1 |        8.1|\n|S002      |24h       |BRCA1 |        7.9|\n|S003      |24h       |BRCA1 |        9.2|\n\n</div>\n:::\n:::\n\n\nWith messy data, you must first reshape it—or write complex code to work around the structure.\n\n## Common Data Problems {#sec-data-problems}\n\n### Problem 1: Column Headers Are Values\n\nOften, column names contain data values rather than variable names:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Messy: years in column headers\npopulation_messy <- tibble(\n  country = c(\"USA\", \"Canada\", \"Mexico\"),\n  `2020` = c(331, 38, 129),\n  `2021` = c(332, 38, 130),\n  `2022` = c(333, 39, 131)\n)\n\npopulation_messy |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pllehjmyhb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pllehjmyhb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pllehjmyhb thead, #pllehjmyhb tbody, #pllehjmyhb tfoot, #pllehjmyhb tr, #pllehjmyhb td, #pllehjmyhb th {\n  border-style: none;\n}\n\n#pllehjmyhb p {\n  margin: 0;\n  padding: 0;\n}\n\n#pllehjmyhb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pllehjmyhb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pllehjmyhb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pllehjmyhb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pllehjmyhb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pllehjmyhb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pllehjmyhb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pllehjmyhb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pllehjmyhb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pllehjmyhb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pllehjmyhb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pllehjmyhb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pllehjmyhb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pllehjmyhb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pllehjmyhb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pllehjmyhb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pllehjmyhb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pllehjmyhb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pllehjmyhb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pllehjmyhb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pllehjmyhb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pllehjmyhb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pllehjmyhb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pllehjmyhb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pllehjmyhb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pllehjmyhb .gt_left {\n  text-align: left;\n}\n\n#pllehjmyhb .gt_center {\n  text-align: center;\n}\n\n#pllehjmyhb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pllehjmyhb .gt_font_normal {\n  font-weight: normal;\n}\n\n#pllehjmyhb .gt_font_bold {\n  font-weight: bold;\n}\n\n#pllehjmyhb .gt_font_italic {\n  font-style: italic;\n}\n\n#pllehjmyhb .gt_super {\n  font-size: 65%;\n}\n\n#pllehjmyhb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pllehjmyhb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pllehjmyhb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pllehjmyhb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pllehjmyhb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pllehjmyhb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pllehjmyhb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#pllehjmyhb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#pllehjmyhb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"country\">country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a2020\">2020</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a2021\">2021</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a2022\">2022</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">USA</td>\n<td headers=\"2020\" class=\"gt_row gt_right\">331</td>\n<td headers=\"2021\" class=\"gt_row gt_right\">332</td>\n<td headers=\"2022\" class=\"gt_row gt_right\">333</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Canada</td>\n<td headers=\"2020\" class=\"gt_row gt_right\">38</td>\n<td headers=\"2021\" class=\"gt_row gt_right\">38</td>\n<td headers=\"2022\" class=\"gt_row gt_right\">39</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Mexico</td>\n<td headers=\"2020\" class=\"gt_row gt_right\">129</td>\n<td headers=\"2021\" class=\"gt_row gt_right\">130</td>\n<td headers=\"2022\" class=\"gt_row gt_right\">131</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nSolution: \"Pivot\" the data to create a `year` column:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npopulation_tidy <- population_messy |>\n  pivot_longer(\n    cols = `2020`:`2022`,\n    names_to = \"year\",\n    values_to = \"population\"\n  )\n\npopulation_tidy |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wihjhgprff\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wihjhgprff table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wihjhgprff thead, #wihjhgprff tbody, #wihjhgprff tfoot, #wihjhgprff tr, #wihjhgprff td, #wihjhgprff th {\n  border-style: none;\n}\n\n#wihjhgprff p {\n  margin: 0;\n  padding: 0;\n}\n\n#wihjhgprff .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wihjhgprff .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wihjhgprff .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wihjhgprff .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wihjhgprff .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wihjhgprff .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wihjhgprff .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wihjhgprff .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wihjhgprff .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wihjhgprff .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wihjhgprff .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wihjhgprff .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wihjhgprff .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wihjhgprff .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wihjhgprff .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wihjhgprff .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wihjhgprff .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wihjhgprff .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wihjhgprff .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wihjhgprff .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wihjhgprff .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wihjhgprff .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wihjhgprff .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wihjhgprff .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wihjhgprff .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wihjhgprff .gt_left {\n  text-align: left;\n}\n\n#wihjhgprff .gt_center {\n  text-align: center;\n}\n\n#wihjhgprff .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wihjhgprff .gt_font_normal {\n  font-weight: normal;\n}\n\n#wihjhgprff .gt_font_bold {\n  font-weight: bold;\n}\n\n#wihjhgprff .gt_font_italic {\n  font-style: italic;\n}\n\n#wihjhgprff .gt_super {\n  font-size: 65%;\n}\n\n#wihjhgprff .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wihjhgprff .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wihjhgprff .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wihjhgprff .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wihjhgprff .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wihjhgprff .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wihjhgprff .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wihjhgprff .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wihjhgprff div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"country\">country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"year\">year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"population\">population</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">USA</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2020</td>\n<td headers=\"population\" class=\"gt_row gt_right\">331</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">USA</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2021</td>\n<td headers=\"population\" class=\"gt_row gt_right\">332</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">USA</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2022</td>\n<td headers=\"population\" class=\"gt_row gt_right\">333</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Canada</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2020</td>\n<td headers=\"population\" class=\"gt_row gt_right\">38</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Canada</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2021</td>\n<td headers=\"population\" class=\"gt_row gt_right\">38</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Canada</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2022</td>\n<td headers=\"population\" class=\"gt_row gt_right\">39</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Mexico</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2020</td>\n<td headers=\"population\" class=\"gt_row gt_right\">129</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Mexico</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2021</td>\n<td headers=\"population\" class=\"gt_row gt_right\">130</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Mexico</td>\n<td headers=\"year\" class=\"gt_row gt_right\">2022</td>\n<td headers=\"population\" class=\"gt_row gt_right\">131</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n### Problem 2: Multiple Variables in One Column\n\nSometimes multiple pieces of information are crammed into one cell:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Messy: rate contains both values\nmessy_rates <- tibble(\n  country = c(\"USA\", \"Canada\", \"Mexico\"),\n  rate = c(\"1000/50000\", \"200/10000\", \"500/25000\")\n)\n\nmessy_rates |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"dcrfunpacp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dcrfunpacp table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dcrfunpacp thead, #dcrfunpacp tbody, #dcrfunpacp tfoot, #dcrfunpacp tr, #dcrfunpacp td, #dcrfunpacp th {\n  border-style: none;\n}\n\n#dcrfunpacp p {\n  margin: 0;\n  padding: 0;\n}\n\n#dcrfunpacp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dcrfunpacp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dcrfunpacp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dcrfunpacp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dcrfunpacp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dcrfunpacp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dcrfunpacp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dcrfunpacp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dcrfunpacp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dcrfunpacp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dcrfunpacp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#dcrfunpacp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dcrfunpacp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dcrfunpacp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dcrfunpacp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcrfunpacp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dcrfunpacp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dcrfunpacp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dcrfunpacp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcrfunpacp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dcrfunpacp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcrfunpacp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#dcrfunpacp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcrfunpacp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dcrfunpacp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcrfunpacp .gt_left {\n  text-align: left;\n}\n\n#dcrfunpacp .gt_center {\n  text-align: center;\n}\n\n#dcrfunpacp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dcrfunpacp .gt_font_normal {\n  font-weight: normal;\n}\n\n#dcrfunpacp .gt_font_bold {\n  font-weight: bold;\n}\n\n#dcrfunpacp .gt_font_italic {\n  font-style: italic;\n}\n\n#dcrfunpacp .gt_super {\n  font-size: 65%;\n}\n\n#dcrfunpacp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dcrfunpacp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dcrfunpacp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dcrfunpacp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dcrfunpacp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dcrfunpacp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dcrfunpacp .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#dcrfunpacp .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#dcrfunpacp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"country\">country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rate\">rate</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">USA</td>\n<td headers=\"rate\" class=\"gt_row gt_right\">1000/50000</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Canada</td>\n<td headers=\"rate\" class=\"gt_row gt_right\">200/10000</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Mexico</td>\n<td headers=\"rate\" class=\"gt_row gt_right\">500/25000</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nSolution: Separate into distinct columns:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntidy_rates <- messy_rates |>\n  separate(rate, into = c(\"cases\", \"population\"), sep = \"/\", convert = TRUE)\n\ntidy_rates |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"moggbpmxvt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#moggbpmxvt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#moggbpmxvt thead, #moggbpmxvt tbody, #moggbpmxvt tfoot, #moggbpmxvt tr, #moggbpmxvt td, #moggbpmxvt th {\n  border-style: none;\n}\n\n#moggbpmxvt p {\n  margin: 0;\n  padding: 0;\n}\n\n#moggbpmxvt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#moggbpmxvt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#moggbpmxvt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#moggbpmxvt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#moggbpmxvt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#moggbpmxvt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#moggbpmxvt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#moggbpmxvt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#moggbpmxvt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#moggbpmxvt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#moggbpmxvt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#moggbpmxvt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#moggbpmxvt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#moggbpmxvt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#moggbpmxvt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#moggbpmxvt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#moggbpmxvt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#moggbpmxvt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#moggbpmxvt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#moggbpmxvt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#moggbpmxvt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#moggbpmxvt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#moggbpmxvt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#moggbpmxvt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#moggbpmxvt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#moggbpmxvt .gt_left {\n  text-align: left;\n}\n\n#moggbpmxvt .gt_center {\n  text-align: center;\n}\n\n#moggbpmxvt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#moggbpmxvt .gt_font_normal {\n  font-weight: normal;\n}\n\n#moggbpmxvt .gt_font_bold {\n  font-weight: bold;\n}\n\n#moggbpmxvt .gt_font_italic {\n  font-style: italic;\n}\n\n#moggbpmxvt .gt_super {\n  font-size: 65%;\n}\n\n#moggbpmxvt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#moggbpmxvt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#moggbpmxvt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#moggbpmxvt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#moggbpmxvt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#moggbpmxvt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#moggbpmxvt .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#moggbpmxvt .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#moggbpmxvt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"country\">country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cases\">cases</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"population\">population</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">USA</td>\n<td headers=\"cases\" class=\"gt_row gt_right\">1000</td>\n<td headers=\"population\" class=\"gt_row gt_right\">50000</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Canada</td>\n<td headers=\"cases\" class=\"gt_row gt_right\">200</td>\n<td headers=\"population\" class=\"gt_row gt_right\">10000</td></tr>\n    <tr><td headers=\"country\" class=\"gt_row gt_left\">Mexico</td>\n<td headers=\"cases\" class=\"gt_row gt_right\">500</td>\n<td headers=\"population\" class=\"gt_row gt_right\">25000</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n### Problem 3: Variables in Both Rows and Columns\n\nComplex tables sometimes mix variables across dimensions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Messy: measurement type in rows, conditions in columns\nmessy_experiment <- tibble(\n  measurement = c(\"weight\", \"height\", \"weight\", \"height\"),\n  subject = c(\"A\", \"A\", \"B\", \"B\"),\n  control = c(70, 170, 65, 165),\n  treatment = c(68, 170, 64, 166)\n)\n\nmessy_experiment |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pnkofuwxkc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pnkofuwxkc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pnkofuwxkc thead, #pnkofuwxkc tbody, #pnkofuwxkc tfoot, #pnkofuwxkc tr, #pnkofuwxkc td, #pnkofuwxkc th {\n  border-style: none;\n}\n\n#pnkofuwxkc p {\n  margin: 0;\n  padding: 0;\n}\n\n#pnkofuwxkc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pnkofuwxkc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pnkofuwxkc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pnkofuwxkc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pnkofuwxkc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pnkofuwxkc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pnkofuwxkc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pnkofuwxkc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pnkofuwxkc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pnkofuwxkc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pnkofuwxkc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pnkofuwxkc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pnkofuwxkc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pnkofuwxkc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pnkofuwxkc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnkofuwxkc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pnkofuwxkc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pnkofuwxkc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pnkofuwxkc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnkofuwxkc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pnkofuwxkc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnkofuwxkc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pnkofuwxkc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnkofuwxkc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pnkofuwxkc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnkofuwxkc .gt_left {\n  text-align: left;\n}\n\n#pnkofuwxkc .gt_center {\n  text-align: center;\n}\n\n#pnkofuwxkc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pnkofuwxkc .gt_font_normal {\n  font-weight: normal;\n}\n\n#pnkofuwxkc .gt_font_bold {\n  font-weight: bold;\n}\n\n#pnkofuwxkc .gt_font_italic {\n  font-style: italic;\n}\n\n#pnkofuwxkc .gt_super {\n  font-size: 65%;\n}\n\n#pnkofuwxkc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pnkofuwxkc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pnkofuwxkc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pnkofuwxkc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pnkofuwxkc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pnkofuwxkc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pnkofuwxkc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#pnkofuwxkc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#pnkofuwxkc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"measurement\">measurement</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"subject\">subject</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"control\">control</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"treatment\">treatment</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"measurement\" class=\"gt_row gt_left\">weight</td>\n<td headers=\"subject\" class=\"gt_row gt_left\">A</td>\n<td headers=\"control\" class=\"gt_row gt_right\">70</td>\n<td headers=\"treatment\" class=\"gt_row gt_right\">68</td></tr>\n    <tr><td headers=\"measurement\" class=\"gt_row gt_left\">height</td>\n<td headers=\"subject\" class=\"gt_row gt_left\">A</td>\n<td headers=\"control\" class=\"gt_row gt_right\">170</td>\n<td headers=\"treatment\" class=\"gt_row gt_right\">170</td></tr>\n    <tr><td headers=\"measurement\" class=\"gt_row gt_left\">weight</td>\n<td headers=\"subject\" class=\"gt_row gt_left\">B</td>\n<td headers=\"control\" class=\"gt_row gt_right\">65</td>\n<td headers=\"treatment\" class=\"gt_row gt_right\">64</td></tr>\n    <tr><td headers=\"measurement\" class=\"gt_row gt_left\">height</td>\n<td headers=\"subject\" class=\"gt_row gt_left\">B</td>\n<td headers=\"control\" class=\"gt_row gt_right\">165</td>\n<td headers=\"treatment\" class=\"gt_row gt_right\">166</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nThis requires multiple steps to tidy: pivot longer, then pivot wider.\n\n### Problem 4: Multiple Observational Units\n\nWhen a single table contains data about different types of things:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Messy: patient and hospital info in same table\ncombined_data <- tibble(\n  patient_id = c(\"P001\", \"P002\"),\n  patient_name = c(\"Alice\", \"Bob\"),\n  hospital_id = c(\"H1\", \"H1\"),\n  hospital_name = c(\"General\", \"General\"),\n  hospital_beds = c(500, 500),  # Repeated!\n  diagnosis = c(\"Flu\", \"Cold\")\n)\n\ncombined_data |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ocrxusufzw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ocrxusufzw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ocrxusufzw thead, #ocrxusufzw tbody, #ocrxusufzw tfoot, #ocrxusufzw tr, #ocrxusufzw td, #ocrxusufzw th {\n  border-style: none;\n}\n\n#ocrxusufzw p {\n  margin: 0;\n  padding: 0;\n}\n\n#ocrxusufzw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ocrxusufzw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ocrxusufzw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ocrxusufzw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ocrxusufzw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ocrxusufzw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ocrxusufzw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ocrxusufzw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ocrxusufzw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ocrxusufzw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ocrxusufzw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ocrxusufzw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ocrxusufzw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ocrxusufzw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ocrxusufzw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ocrxusufzw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ocrxusufzw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ocrxusufzw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ocrxusufzw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ocrxusufzw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ocrxusufzw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ocrxusufzw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ocrxusufzw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ocrxusufzw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ocrxusufzw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ocrxusufzw .gt_left {\n  text-align: left;\n}\n\n#ocrxusufzw .gt_center {\n  text-align: center;\n}\n\n#ocrxusufzw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ocrxusufzw .gt_font_normal {\n  font-weight: normal;\n}\n\n#ocrxusufzw .gt_font_bold {\n  font-weight: bold;\n}\n\n#ocrxusufzw .gt_font_italic {\n  font-style: italic;\n}\n\n#ocrxusufzw .gt_super {\n  font-size: 65%;\n}\n\n#ocrxusufzw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ocrxusufzw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ocrxusufzw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ocrxusufzw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ocrxusufzw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ocrxusufzw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ocrxusufzw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ocrxusufzw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ocrxusufzw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"patient_id\">patient_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"patient_name\">patient_name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hospital_id\">hospital_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hospital_name\">hospital_name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hospital_beds\">hospital_beds</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"diagnosis\">diagnosis</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"patient_id\" class=\"gt_row gt_left\">P001</td>\n<td headers=\"patient_name\" class=\"gt_row gt_left\">Alice</td>\n<td headers=\"hospital_id\" class=\"gt_row gt_left\">H1</td>\n<td headers=\"hospital_name\" class=\"gt_row gt_left\">General</td>\n<td headers=\"hospital_beds\" class=\"gt_row gt_right\">500</td>\n<td headers=\"diagnosis\" class=\"gt_row gt_left\">Flu</td></tr>\n    <tr><td headers=\"patient_id\" class=\"gt_row gt_left\">P002</td>\n<td headers=\"patient_name\" class=\"gt_row gt_left\">Bob</td>\n<td headers=\"hospital_id\" class=\"gt_row gt_left\">H1</td>\n<td headers=\"hospital_name\" class=\"gt_row gt_left\">General</td>\n<td headers=\"hospital_beds\" class=\"gt_row gt_right\">500</td>\n<td headers=\"diagnosis\" class=\"gt_row gt_left\">Cold</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nSolution: Normalize into separate tables linked by keys.\n\n## Best Practices for Data Organization {#sec-data-best-practices}\n\n### Naming Conventions\n\n::: {.callout-tip title=\"Data File Naming Rules\"}\n**File names:**\n\n- Use descriptive names: `patient_outcomes_2024.csv`\n- Include dates in ISO format: `YYYY-MM-DD`\n- Avoid spaces (use underscores or hyphens)\n- Keep names concise but informative\n\n**Column names:**\n\n- Use lowercase with underscores: `sample_id`, `gene_expression`\n- Make names meaningful: `treatment_group` not `tg`\n- Avoid special characters and spaces\n- Start with a letter, not a number\n:::\n\n### File Formats\n\n| Format | Extension | Best For |\n|:-------|:----------|:---------|\n| Comma-separated | `.csv` | General tabular data |\n| Tab-separated | `.tsv` | Data containing commas |\n| Plain text | `.txt` | Simple data, scripts |\n| Excel | `.xlsx` | Sharing with non-programmers |\n| RDS | `.rds` | R-specific data with types preserved |\n| Parquet | `.parquet` | Large datasets, fast reading |\n\n: Common data file formats {#tbl-file-formats}\n\nFor long-term storage and sharing, prefer plain text formats (CSV, TSV) over proprietary formats. They're human-readable and don't require specific software.\n\n### Documentation\n\nAlways create a **data dictionary** (also called a codebook) documenting:\n\n- Variable names and descriptions\n- Units of measurement\n- Allowable values or categories\n- Coding of missing values\n- Source of the data\n- Date created/modified\n\n### Preserving Raw Data\n\n::: {.callout-warning title=\"Never Modify Raw Data\"}\nAlways keep an unchanged copy of your original data. Create a separate processed version for analysis. This allows you to:\n\n- Retrace your steps if something goes wrong\n- Rerun analysis with different preprocessing\n- Share the original data with collaborators\n:::\n\n## Data Types {#sec-tidy-data-types}\n\nUnderstanding data types helps you organize and analyze correctly.\n\n### Categorical vs. Quantitative\n\n\n::: {#tbl-data-types-table .cell layout-align=\"center\" tbl-cap='Classification of data types'}\n\n```{.r .cell-code}\ndata_types <- tibble(\n  Category = c(\"Categorical\", \"Categorical\", \"Quantitative\", \"Quantitative\"),\n  Type = c(\"Ordinal\", \"Nominal\", \"Ratio\", \"Interval\"),\n  Description = c(\n    \"Ordered categories\",\n    \"Unordered categories\",\n    \"True zero, ratios meaningful\",\n    \"No true zero\"\n  ),\n  Examples = c(\n    \"small, medium, large\",\n    \"red, blue, green\",\n    \"height, weight, concentration\",\n    \"temperature (°C), calendar year\"\n  )\n)\n\ndata_types |>\n  gt() |>\n  tab_header(title = \"Data Type Classification\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"natfdvdcin\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#natfdvdcin table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#natfdvdcin thead, #natfdvdcin tbody, #natfdvdcin tfoot, #natfdvdcin tr, #natfdvdcin td, #natfdvdcin th {\n  border-style: none;\n}\n\n#natfdvdcin p {\n  margin: 0;\n  padding: 0;\n}\n\n#natfdvdcin .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#natfdvdcin .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#natfdvdcin .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#natfdvdcin .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#natfdvdcin .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#natfdvdcin .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#natfdvdcin .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#natfdvdcin .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#natfdvdcin .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#natfdvdcin .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#natfdvdcin .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#natfdvdcin .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#natfdvdcin .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#natfdvdcin .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#natfdvdcin .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#natfdvdcin .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#natfdvdcin .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#natfdvdcin .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#natfdvdcin .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#natfdvdcin .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#natfdvdcin .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#natfdvdcin .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#natfdvdcin .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#natfdvdcin .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#natfdvdcin .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#natfdvdcin .gt_left {\n  text-align: left;\n}\n\n#natfdvdcin .gt_center {\n  text-align: center;\n}\n\n#natfdvdcin .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#natfdvdcin .gt_font_normal {\n  font-weight: normal;\n}\n\n#natfdvdcin .gt_font_bold {\n  font-weight: bold;\n}\n\n#natfdvdcin .gt_font_italic {\n  font-style: italic;\n}\n\n#natfdvdcin .gt_super {\n  font-size: 65%;\n}\n\n#natfdvdcin .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#natfdvdcin .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#natfdvdcin .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#natfdvdcin .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#natfdvdcin .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#natfdvdcin .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#natfdvdcin .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#natfdvdcin .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#natfdvdcin div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Data Type Classification</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Category\">Category</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Type\">Type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Description\">Description</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Examples\">Examples</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Category\" class=\"gt_row gt_left\">Categorical</td>\n<td headers=\"Type\" class=\"gt_row gt_left\">Ordinal</td>\n<td headers=\"Description\" class=\"gt_row gt_left\">Ordered categories</td>\n<td headers=\"Examples\" class=\"gt_row gt_left\">small, medium, large</td></tr>\n    <tr><td headers=\"Category\" class=\"gt_row gt_left\">Categorical</td>\n<td headers=\"Type\" class=\"gt_row gt_left\">Nominal</td>\n<td headers=\"Description\" class=\"gt_row gt_left\">Unordered categories</td>\n<td headers=\"Examples\" class=\"gt_row gt_left\">red, blue, green</td></tr>\n    <tr><td headers=\"Category\" class=\"gt_row gt_left\">Quantitative</td>\n<td headers=\"Type\" class=\"gt_row gt_left\">Ratio</td>\n<td headers=\"Description\" class=\"gt_row gt_left\">True zero, ratios meaningful</td>\n<td headers=\"Examples\" class=\"gt_row gt_left\">height, weight, concentration</td></tr>\n    <tr><td headers=\"Category\" class=\"gt_row gt_left\">Quantitative</td>\n<td headers=\"Type\" class=\"gt_row gt_left\">Interval</td>\n<td headers=\"Description\" class=\"gt_row gt_left\">No true zero</td>\n<td headers=\"Examples\" class=\"gt_row gt_left\">temperature (°C), calendar year</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n### R Data Types\n\nR has specific data types for these categories:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Numeric (continuous)\ntemperature <- c(37.2, 36.8, 38.1)\nclass(temperature)\n#> [1] \"numeric\"\n\n# Integer\ncounts <- c(1L, 2L, 3L)\nclass(counts)\n#> [1] \"integer\"\n\n# Character\nsample_names <- c(\"control\", \"treatment\", \"treatment\")\nclass(sample_names)\n#> [1] \"character\"\n\n# Factor (categorical)\ntreatment <- factor(c(\"low\", \"medium\", \"high\"), \n                   levels = c(\"low\", \"medium\", \"high\"),\n                   ordered = TRUE)\nclass(treatment)\n#> [1] \"ordered\" \"factor\"\ntreatment\n#> [1] low    medium high  \n#> Levels: low < medium < high\n\n# Logical\npassed_qc <- c(TRUE, TRUE, FALSE)\nclass(passed_qc)\n#> [1] \"logical\"\n```\n:::\n\n\n### When to Use Factors\n\nFactors are R's way of handling categorical variables. Use them when:\n\n- You have a limited set of possible values\n- The order matters (ordinal data)\n- You want specific grouping in analyses and plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Character vector sorts alphabetically\ntreatments <- c(\"High\", \"Low\", \"Medium\", \"Low\", \"High\")\nsort(treatments)\n#> [1] \"High\"   \"High\"   \"Low\"    \"Low\"    \"Medium\"\n\n# Factor maintains meaningful order\ntreatments_factor <- factor(treatments, \n                           levels = c(\"Low\", \"Medium\", \"High\"))\nsort(treatments_factor)\n#> [1] Low    Low    Medium High   High  \n#> Levels: Low Medium High\n```\n:::\n\n\n## Structuring Spreadsheets for Analysis {#sec-spreadsheets}\n\nIf you must use spreadsheets for data entry, follow these guidelines:\n\n::: {.callout-important title=\"Spreadsheet Best Practices\"}\n1. **One header row only** — Put variable names in row 1\n2. **No merged cells** — They break data structure\n3. **No color-coding as data** — Use a column instead\n4. **Consistent missing values** — Use `NA`, not blank, `-`, or `N/A`\n5. **One sheet per dataset** — Don't spread data across tabs\n6. **Export as CSV** — Preserve as plain text\n7. **No calculations in raw data** — Keep raw and calculated data separate\n:::\n\n### Before and After\n\n**Bad spreadsheet practices:**\n\n- Merged cells for visual grouping\n- Color-coded cells indicating categories\n- Multiple header rows\n- Notes in random cells\n- Mixed data types in columns\n- Embedded calculations\n\n**Good spreadsheet practices:**\n\n- Clean rectangular data\n- Single header row\n- Consistent formatting throughout\n- Separate documentation sheet\n- Explicit coding of all information\n\n## The Tidyverse: A Collection of Data Science Packages {#sec-tidyverse}\n\nThe **tidyverse** is a collection of R packages designed for data science that share a common philosophy and work seamlessly together. These packages make data manipulation, visualization, and analysis more intuitive and readable.\n\n### Core Tidyverse Packages\n\n| Package | Purpose |\n|:--------|:--------|\n| **dplyr** | Data manipulation (filter, select, mutate, etc.) |\n| **ggplot2** | Data visualization |\n| **tidyr** | Data tidying (pivot, separate, etc.) |\n| **readr** | Fast data import |\n| **purrr** | Functional programming |\n| **stringr** | String manipulation |\n| **forcats** | Working with factors |\n| **tibble** | Modern data frames |\n\n: Core tidyverse packages {#tbl-tidyverse}\n\nLoad all core packages at once:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n### Data Import with readr\n\nThe **readr** package provides fast, friendly functions for reading rectangular data. It's more consistent and feature-rich than base R's `read.csv()`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Basic CSV import (tidyverse alternative to read.csv)\ndata <- read_csv(\"experiment_results.csv\")\n\n# Tab-separated files\ndata <- read_tsv(\"data.tsv\")\n\n# Semicolon-separated (common in European locales)\ndata <- read_csv2(\"data.csv\")\n\n# Fixed-width files\ndata <- read_fwf(\"data.txt\", fwf_widths(c(10, 5, 8)))\n```\n:::\n\n\n#### Controlling Column Types\n\nBy default, `read_csv()` guesses column types from the first 1000 rows. You can override this with `col_types`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Specify column types explicitly\ndata <- read_csv(\n  \"samples.csv\",\n  col_types = cols(\n    sample_id = col_character(),    # Force as character\n    count = col_integer(),          # Integer values\n    concentration = col_double(),   # Decimal numbers\n    date = col_date(),              # Parse as date\n    treatment = col_factor(levels = c(\"control\", \"drug_A\", \"drug_B\"))\n  )\n)\n\n# Shorthand specification (c = character, i = integer, d = double, D = date)\ndata <- read_csv(\"samples.csv\", col_types = \"ciidD\")\n\n# Only override specific columns, guess the rest\ndata <- read_csv(\n  \"samples.csv\",\n  col_types = cols(\n    sample_id = col_character(),\n    .default = col_guess()\n  )\n)\n```\n:::\n\n\n::: {.callout-tip}\nAlways check `problems(data)` after reading to see if any values couldn't be parsed as expected. This catches data quality issues early!\n:::\n\n#### Handling Messy Column Names\n\nReal-world data often has problematic column names (spaces, special characters, inconsistent capitalization). The **janitor** package provides `clean_names()` to standardize them:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(janitor)\n\n# Before: \"Sample ID\", \"Gene Expression (log2)\", \"P-Value\"\n# After:  \"sample_id\", \"gene_expression_log2\",  \"p_value\"\ndata <- read_csv(\"messy_data.csv\") |>\n  clean_names()\n```\n:::\n\n\nThis converts all names to lowercase snake_case, making them valid R identifiers and consistent to work with.\n\n## The Pipe Operator {#sec-pipe}\n\nOne of the most powerful features of the tidyverse is the **pipe operator**, which allows you to chain operations together in a readable way.\n\n### The Native Pipe: `|>`\n\nR 4.1+ includes a native pipe operator `|>`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Without pipe: nested, hard to read\nsqrt(sum(abs(c(-4, 9, -16))))\n#> [1] 5.385165\n\n# With pipe: reads left to right\nc(-4, 9, -16) |>\n  abs() |>\n  sum() |>\n  sqrt()\n#> [1] 5.385165\n```\n:::\n\n\n### The magrittr Pipe: `%>%`\n\nThe tidyverse also provides `%>%` from the magrittr package, which has additional features:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n# Both work similarly for most cases\nc(1, 2, 3, 4, 5) |> mean()\n#> [1] 3\nc(1, 2, 3, 4, 5) %>% mean()\n#> [1] 3\n```\n:::\n\n\n::: {.callout-tip}\nThe pipe transforms `x |> f(y)` into `f(x, y)`. Think of it as \"take this, then do that.\" This makes code read like a recipe: take data, then filter, then select, then summarize.\n:::\n\n## Data Manipulation with dplyr {#sec-dplyr}\n\nThe **dplyr** package provides a consistent set of \"verbs\" for data manipulation. These functions are designed to be intuitive and compose well together.\n\n### The Five Core dplyr Verbs\n\n| Verb | Action |\n|:-----|:-------|\n| `filter()` | Pick rows based on conditions |\n| `select()` | Pick columns by name |\n| `arrange()` | Reorder rows |\n| `mutate()` | Create or modify columns |\n| `summarize()` | Reduce to summary statistics |\n\n: The five core dplyr verbs {#tbl-dplyr-verbs}\n\nLet's create sample data to demonstrate these:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Sample experimental data\nexperiments <- tibble(\n  sample_id = paste0(\"S\", 1:12),\n  treatment = rep(c(\"control\", \"drug_A\", \"drug_B\"), each = 4),\n  replicate = rep(1:4, 3),\n  expression = c(10.2, 11.1, 9.8, 10.5,   # control\n                 15.3, 14.8, 16.2, 15.0,   # drug_A\n                 18.1, 19.2, 17.5, 18.8),  # drug_B\n  cell_count = c(1000, 1050, 980, 1020,\n                 1100, 1080, 1150, 1090,\n                 1200, 1250, 1180, 1220)\n)\n\nexperiments\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S1        |control   |         1|       10.2|       1000|\n|S2        |control   |         2|       11.1|       1050|\n|S3        |control   |         3|        9.8|        980|\n|S4        |control   |         4|       10.5|       1020|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S6        |drug_A    |         2|       14.8|       1080|\n|S7        |drug_A    |         3|       16.2|       1150|\n|S8        |drug_A    |         4|       15.0|       1090|\n|S9        |drug_B    |         1|       18.1|       1200|\n|S10       |drug_B    |         2|       19.2|       1250|\n|S11       |drug_B    |         3|       17.5|       1180|\n|S12       |drug_B    |         4|       18.8|       1220|\n\n</div>\n:::\n:::\n\n\n### Filtering Rows with `filter()`\n\nSelect rows that meet specific conditions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Single condition\nexperiments |>\n  filter(treatment == \"drug_A\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S6        |drug_A    |         2|       14.8|       1080|\n|S7        |drug_A    |         3|       16.2|       1150|\n|S8        |drug_A    |         4|       15.0|       1090|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Multiple conditions (AND)\nexperiments |>\n  filter(treatment == \"drug_A\", expression > 15)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S7        |drug_A    |         3|       16.2|       1150|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# OR conditions\nexperiments |>\n  filter(treatment == \"drug_A\" | treatment == \"drug_B\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S6        |drug_A    |         2|       14.8|       1080|\n|S7        |drug_A    |         3|       16.2|       1150|\n|S8        |drug_A    |         4|       15.0|       1090|\n|S9        |drug_B    |         1|       18.1|       1200|\n|S10       |drug_B    |         2|       19.2|       1250|\n|S11       |drug_B    |         3|       17.5|       1180|\n|S12       |drug_B    |         4|       18.8|       1220|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Using %in% for multiple values\nexperiments |>\n  filter(treatment %in% c(\"drug_A\", \"drug_B\"))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S6        |drug_A    |         2|       14.8|       1080|\n|S7        |drug_A    |         3|       16.2|       1150|\n|S8        |drug_A    |         4|       15.0|       1090|\n|S9        |drug_B    |         1|       18.1|       1200|\n|S10       |drug_B    |         2|       19.2|       1250|\n|S11       |drug_B    |         3|       17.5|       1180|\n|S12       |drug_B    |         4|       18.8|       1220|\n\n</div>\n:::\n:::\n\n\n### Selecting Columns with `select()`\n\nChoose which columns to keep:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Select specific columns\nexperiments |>\n  select(sample_id, treatment, expression)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | expression|\n|:---------|:---------|----------:|\n|S1        |control   |       10.2|\n|S2        |control   |       11.1|\n|S3        |control   |        9.8|\n|S4        |control   |       10.5|\n|S5        |drug_A    |       15.3|\n|S6        |drug_A    |       14.8|\n|S7        |drug_A    |       16.2|\n|S8        |drug_A    |       15.0|\n|S9        |drug_B    |       18.1|\n|S10       |drug_B    |       19.2|\n|S11       |drug_B    |       17.5|\n|S12       |drug_B    |       18.8|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Select range of columns\nexperiments |>\n  select(sample_id:replicate)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate|\n|:---------|:---------|---------:|\n|S1        |control   |         1|\n|S2        |control   |         2|\n|S3        |control   |         3|\n|S4        |control   |         4|\n|S5        |drug_A    |         1|\n|S6        |drug_A    |         2|\n|S7        |drug_A    |         3|\n|S8        |drug_A    |         4|\n|S9        |drug_B    |         1|\n|S10       |drug_B    |         2|\n|S11       |drug_B    |         3|\n|S12       |drug_B    |         4|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Exclude columns with minus\nexperiments |>\n  select(-cell_count)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression|\n|:---------|:---------|---------:|----------:|\n|S1        |control   |         1|       10.2|\n|S2        |control   |         2|       11.1|\n|S3        |control   |         3|        9.8|\n|S4        |control   |         4|       10.5|\n|S5        |drug_A    |         1|       15.3|\n|S6        |drug_A    |         2|       14.8|\n|S7        |drug_A    |         3|       16.2|\n|S8        |drug_A    |         4|       15.0|\n|S9        |drug_B    |         1|       18.1|\n|S10       |drug_B    |         2|       19.2|\n|S11       |drug_B    |         3|       17.5|\n|S12       |drug_B    |         4|       18.8|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Select using helper functions\nexperiments |>\n  select(starts_with(\"exp\"))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| expression|\n|----------:|\n|       10.2|\n|       11.1|\n|        9.8|\n|       10.5|\n|       15.3|\n|       14.8|\n|       16.2|\n|       15.0|\n|       18.1|\n|       19.2|\n|       17.5|\n|       18.8|\n\n</div>\n:::\n\n```{.r .cell-code}\n\nexperiments |>\n  select(where(is.numeric))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| replicate| expression| cell_count|\n|---------:|----------:|----------:|\n|         1|       10.2|       1000|\n|         2|       11.1|       1050|\n|         3|        9.8|        980|\n|         4|       10.5|       1020|\n|         1|       15.3|       1100|\n|         2|       14.8|       1080|\n|         3|       16.2|       1150|\n|         4|       15.0|       1090|\n|         1|       18.1|       1200|\n|         2|       19.2|       1250|\n|         3|       17.5|       1180|\n|         4|       18.8|       1220|\n\n</div>\n:::\n:::\n\n\n### Arranging Rows with `arrange()`\n\nSort data by one or more columns:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Ascending order (default)\nexperiments |>\n  arrange(expression)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S3        |control   |         3|        9.8|        980|\n|S1        |control   |         1|       10.2|       1000|\n|S4        |control   |         4|       10.5|       1020|\n|S2        |control   |         2|       11.1|       1050|\n|S6        |drug_A    |         2|       14.8|       1080|\n|S8        |drug_A    |         4|       15.0|       1090|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S7        |drug_A    |         3|       16.2|       1150|\n|S11       |drug_B    |         3|       17.5|       1180|\n|S9        |drug_B    |         1|       18.1|       1200|\n|S12       |drug_B    |         4|       18.8|       1220|\n|S10       |drug_B    |         2|       19.2|       1250|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Descending order\nexperiments |>\n  arrange(desc(expression))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S10       |drug_B    |         2|       19.2|       1250|\n|S12       |drug_B    |         4|       18.8|       1220|\n|S9        |drug_B    |         1|       18.1|       1200|\n|S11       |drug_B    |         3|       17.5|       1180|\n|S7        |drug_A    |         3|       16.2|       1150|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S8        |drug_A    |         4|       15.0|       1090|\n|S6        |drug_A    |         2|       14.8|       1080|\n|S2        |control   |         2|       11.1|       1050|\n|S4        |control   |         4|       10.5|       1020|\n|S1        |control   |         1|       10.2|       1000|\n|S3        |control   |         3|        9.8|        980|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Multiple columns\nexperiments |>\n  arrange(treatment, desc(expression))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S2        |control   |         2|       11.1|       1050|\n|S4        |control   |         4|       10.5|       1020|\n|S1        |control   |         1|       10.2|       1000|\n|S3        |control   |         3|        9.8|        980|\n|S7        |drug_A    |         3|       16.2|       1150|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S8        |drug_A    |         4|       15.0|       1090|\n|S6        |drug_A    |         2|       14.8|       1080|\n|S10       |drug_B    |         2|       19.2|       1250|\n|S12       |drug_B    |         4|       18.8|       1220|\n|S9        |drug_B    |         1|       18.1|       1200|\n|S11       |drug_B    |         3|       17.5|       1180|\n\n</div>\n:::\n:::\n\n\n### Creating Columns with `mutate()`\n\nAdd new columns or modify existing ones:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  mutate(\n    # Create new columns\n    log_expression = log2(expression),\n    expression_per_cell = expression / cell_count * 1000,\n    # Modify existing\n    treatment = toupper(treatment)\n  )\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count| log_expression| expression_per_cell|\n|:---------|:---------|---------:|----------:|----------:|--------------:|-------------------:|\n|S1        |CONTROL   |         1|       10.2|       1000|       3.350497|            10.20000|\n|S2        |CONTROL   |         2|       11.1|       1050|       3.472488|            10.57143|\n|S3        |CONTROL   |         3|        9.8|        980|       3.292782|            10.00000|\n|S4        |CONTROL   |         4|       10.5|       1020|       3.392317|            10.29412|\n|S5        |DRUG_A    |         1|       15.3|       1100|       3.935460|            13.90909|\n|S6        |DRUG_A    |         2|       14.8|       1080|       3.887525|            13.70370|\n|S7        |DRUG_A    |         3|       16.2|       1150|       4.017922|            14.08696|\n|S8        |DRUG_A    |         4|       15.0|       1090|       3.906891|            13.76147|\n|S9        |DRUG_B    |         1|       18.1|       1200|       4.177918|            15.08333|\n|S10       |DRUG_B    |         2|       19.2|       1250|       4.263034|            15.36000|\n|S11       |DRUG_B    |         3|       17.5|       1180|       4.129283|            14.83051|\n|S12       |DRUG_B    |         4|       18.8|       1220|       4.232661|            15.40984|\n\n</div>\n:::\n:::\n\n\n### Replacing Columns with `transmute()`\n\nIf you only want to keep the new columns (discarding all others), use `transmute()`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  transmute(\n    sample_id,  # Keep this column\n    log_expression = log2(expression),\n    normalized = expression / cell_count * 1000\n  )\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id | log_expression| normalized|\n|:---------|--------------:|----------:|\n|S1        |       3.350497|   10.20000|\n|S2        |       3.472488|   10.57143|\n|S3        |       3.292782|   10.00000|\n|S4        |       3.392317|   10.29412|\n|S5        |       3.935460|   13.90909|\n|S6        |       3.887525|   13.70370|\n|S7        |       4.017922|   14.08696|\n|S8        |       3.906891|   13.76147|\n|S9        |       4.177918|   15.08333|\n|S10       |       4.263034|   15.36000|\n|S11       |       4.129283|   14.83051|\n|S12       |       4.232661|   15.40984|\n\n</div>\n:::\n:::\n\n\nThis is useful when you're creating a derived dataset and don't need the original columns.\n\n### Summarizing Data with `summarize()`\n\nCollapse multiple rows into summary statistics:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  summarize(\n    mean_expression = mean(expression),\n    sd_expression = sd(expression),\n    n_samples = n()\n  )\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| mean_expression| sd_expression| n_samples|\n|---------------:|-------------:|---------:|\n|        14.70833|      3.490626|        12|\n\n</div>\n:::\n:::\n\n\n### Grouping with `group_by()`\n\nThe real power of `summarize()` comes with `group_by()`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Summary statistics by treatment\nexperiments |>\n  group_by(treatment) |>\n  summarize(\n    mean_expression = mean(expression),\n    sd_expression = sd(expression),\n    n = n()\n  )\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment | mean_expression| sd_expression|  n|\n|:---------|---------------:|-------------:|--:|\n|control   |          10.400|     0.5477226|  4|\n|drug_A    |          15.325|     0.6184658|  4|\n|drug_B    |          18.400|     0.7527727|  4|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Multiple grouping variables\nexperiments |>\n  group_by(treatment) |>\n  summarize(\n    mean_expr = mean(expression),\n    max_expr = max(expression),\n    min_expr = min(expression)\n  ) |>\n  arrange(desc(mean_expr))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment | mean_expr| max_expr| min_expr|\n|:---------|---------:|--------:|--------:|\n|drug_B    |    18.400|     19.2|     17.5|\n|drug_A    |    15.325|     16.2|     14.8|\n|control   |    10.400|     11.1|      9.8|\n\n</div>\n:::\n:::\n\n\n### Chaining Operations Together\n\nThe power of dplyr shines when chaining multiple operations:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  filter(treatment != \"control\") |>           # Remove controls\n  mutate(log_expr = log2(expression)) |>      # Log transform\n  group_by(treatment) |>                       # Group by treatment\n  summarize(\n    mean_log_expr = mean(log_expr),\n    se = sd(log_expr) / sqrt(n())\n  ) |>\n  arrange(desc(mean_log_expr))                 # Sort by mean\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment | mean_log_expr|        se|\n|:---------|-------------:|---------:|\n|drug_B    |      4.200724| 0.0296177|\n|drug_A    |      3.936949| 0.0287301|\n\n</div>\n:::\n:::\n\n\n## Tibbles: Modern Data Frames {#sec-tibbles}\n\n**Tibbles** are the tidyverse's enhanced version of data frames. They have several advantages:\n\n### Creating Tibbles\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create a tibble\nmy_tibble <- tibble(\n  x = 1:5,\n  y = x^2,  # Can reference earlier columns\n  z = c(\"a\", \"b\", \"c\", \"d\", \"e\")\n)\n\nmy_tibble\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|  x|  y|z  |\n|--:|--:|:--|\n|  1|  1|a  |\n|  2|  4|b  |\n|  3|  9|c  |\n|  4| 16|d  |\n|  5| 25|e  |\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Convert data frame to tibble\nas_tibble(mtcars) |> head()\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|  mpg| cyl| disp|  hp| drat|    wt|  qsec| vs| am| gear| carb|\n|----:|---:|----:|---:|----:|-----:|-----:|--:|--:|----:|----:|\n| 21.0|   6|  160| 110| 3.90| 2.620| 16.46|  0|  1|    4|    4|\n| 21.0|   6|  160| 110| 3.90| 2.875| 17.02|  0|  1|    4|    4|\n| 22.8|   4|  108|  93| 3.85| 2.320| 18.61|  1|  1|    4|    1|\n| 21.4|   6|  258| 110| 3.08| 3.215| 19.44|  1|  0|    3|    1|\n| 18.7|   8|  360| 175| 3.15| 3.440| 17.02|  0|  0|    3|    2|\n| 18.1|   6|  225| 105| 2.76| 3.460| 20.22|  1|  0|    3|    1|\n\n</div>\n:::\n:::\n\n\n### Creating Small Tibbles with `tribble()`\n\nFor small datasets (especially examples or test data), `tribble()` provides a row-by-row format that's easier to read:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# tribble uses column headers with ~ and row-by-row values\nsample_data <- tribble(\n  ~sample_id, ~treatment, ~expression,\n  \"S001\",     \"control\",  10.2,\n  \"S002\",     \"drug_A\",   15.3,\n  \"S003\",     \"drug_B\",   18.1\n)\n\nsample_data\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | expression|\n|:---------|:---------|----------:|\n|S001      |control   |       10.2|\n|S002      |drug_A    |       15.3|\n|S003      |drug_B    |       18.1|\n\n</div>\n:::\n:::\n\n\nThis format is particularly useful for:\n\n- Creating examples in documentation\n- Quick test datasets\n- Small lookup tables\n\n### Tibble Advantages\n\n1. **Better printing**: Shows first 10 rows and fits columns to screen\n2. **No partial matching**: `df$col` won't match `df$column`\n3. **No string-to-factor conversion**: Characters stay as characters\n4. **Preserves column types**: Subsetting always returns a tibble\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Data frame subsetting can surprise you\ndf <- data.frame(x = 1:3, y = 4:6)\nclass(df[, 1])  # Returns vector!\n#> [1] \"integer\"\n\n# Tibble subsetting is consistent\ntb <- tibble(x = 1:3, y = 4:6)\nclass(tb[, 1])  # Returns tibble\n#> [1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n```\n:::\n\n\n## Additional dplyr Functions {#sec-dplyr-additional}\n\n### Conditional Logic with `case_when()`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  mutate(\n    expression_level = case_when(\n      expression < 12 ~ \"low\",\n      expression < 17 ~ \"medium\",\n      TRUE ~ \"high\"\n    )\n  )\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|expression_level |\n|:---------|:---------|---------:|----------:|----------:|:----------------|\n|S1        |control   |         1|       10.2|       1000|low              |\n|S2        |control   |         2|       11.1|       1050|low              |\n|S3        |control   |         3|        9.8|        980|low              |\n|S4        |control   |         4|       10.5|       1020|low              |\n|S5        |drug_A    |         1|       15.3|       1100|medium           |\n|S6        |drug_A    |         2|       14.8|       1080|medium           |\n|S7        |drug_A    |         3|       16.2|       1150|medium           |\n|S8        |drug_A    |         4|       15.0|       1090|medium           |\n|S9        |drug_B    |         1|       18.1|       1200|high             |\n|S10       |drug_B    |         2|       19.2|       1250|high             |\n|S11       |drug_B    |         3|       17.5|       1180|high             |\n|S12       |drug_B    |         4|       18.8|       1220|high             |\n\n</div>\n:::\n:::\n\n\n### Counting with `count()`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  count(treatment)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment |  n|\n|:---------|--:|\n|control   |  4|\n|drug_A    |  4|\n|drug_B    |  4|\n\n</div>\n:::\n\n```{.r .cell-code}\n\nexperiments |>\n  count(treatment, sort = TRUE)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment |  n|\n|:---------|--:|\n|control   |  4|\n|drug_A    |  4|\n|drug_B    |  4|\n\n</div>\n:::\n:::\n\n\nYou can also use `n_distinct()` within `summarize()` to count unique values:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Count unique treatments per experiment condition\nexperiments |>\n  summarize(\n    n_samples = n(),\n    n_treatments = n_distinct(treatment),\n    n_replicates = n_distinct(replicate)\n  )\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| n_samples| n_treatments| n_replicates|\n|---------:|------------:|------------:|\n|        12|            3|            4|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# n_distinct() is especially useful with group_by()\nexperiments |>\n  group_by(treatment) |>\n  summarize(\n    samples = n(),\n    unique_replicates = n_distinct(replicate)\n  )\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment | samples| unique_replicates|\n|:---------|-------:|-----------------:|\n|control   |       4|                 4|\n|drug_A    |       4|                 4|\n|drug_B    |       4|                 4|\n\n</div>\n:::\n:::\n\n\n### Distinct Values with `distinct()`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  distinct(treatment)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment |\n|:---------|\n|control   |\n|drug_A    |\n|drug_B    |\n\n</div>\n:::\n:::\n\n\n### Renaming with `rename()`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexperiments |>\n  rename(expr = expression, cells = cell_count)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expr| cells|\n|:---------|:---------|---------:|----:|-----:|\n|S1        |control   |         1| 10.2|  1000|\n|S2        |control   |         2| 11.1|  1050|\n|S3        |control   |         3|  9.8|   980|\n|S4        |control   |         4| 10.5|  1020|\n|S5        |drug_A    |         1| 15.3|  1100|\n|S6        |drug_A    |         2| 14.8|  1080|\n|S7        |drug_A    |         3| 16.2|  1150|\n|S8        |drug_A    |         4| 15.0|  1090|\n|S9        |drug_B    |         1| 18.1|  1200|\n|S10       |drug_B    |         2| 19.2|  1250|\n|S11       |drug_B    |         3| 17.5|  1180|\n|S12       |drug_B    |         4| 18.8|  1220|\n\n</div>\n:::\n:::\n\n\n### Subsetting Rows with `slice()`\n\nWhile `filter()` selects rows based on conditions, `slice()` selects rows by position:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# First 3 rows\nexperiments |>\n  slice(1:3)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S1        |control   |         1|       10.2|       1000|\n|S2        |control   |         2|       11.1|       1050|\n|S3        |control   |         3|        9.8|        980|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Last 2 rows\nexperiments |>\n  slice_tail(n = 2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S11       |drug_B    |         3|       17.5|       1180|\n|S12       |drug_B    |         4|       18.8|       1220|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Random sample\nset.seed(42)\nexperiments |>\n  slice_sample(n = 3)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S1        |control   |         1|       10.2|       1000|\n|S5        |drug_A    |         1|       15.3|       1100|\n|S12       |drug_B    |         4|       18.8|       1220|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Top 3 by expression\nexperiments |>\n  slice_max(expression, n = 3)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |treatment | replicate| expression| cell_count|\n|:---------|:---------|---------:|----------:|----------:|\n|S10       |drug_B    |         2|       19.2|       1250|\n|S12       |drug_B    |         4|       18.8|       1220|\n|S9        |drug_B    |         1|       18.1|       1200|\n\n</div>\n:::\n:::\n\n\n### Extracting Columns with `pull()`\n\nTo extract a single column as a vector (rather than a data frame), use `pull()`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Returns a vector, not a data frame\nexperiments |>\n  filter(treatment == \"drug_A\") |>\n  pull(expression)\n#> [1] 15.3 14.8 16.2 15.0\n\n# Useful for passing to functions that expect vectors\nexperiments |>\n  pull(expression) |>\n  mean()\n#> [1] 14.70833\n```\n:::\n\n\n## Working with Factors {#sec-factors}\n\n**Factors** are R's way of representing categorical data with a fixed set of possible values (called **levels**). The **forcats** package (part of the tidyverse) provides tools for working with factors.\n\n### Creating and Inspecting Factors\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create a factor with explicit levels\ntreatment <- factor(\n  c(\"drug\", \"control\", \"drug\", \"placebo\"),\n  levels = c(\"control\", \"placebo\", \"drug\")  # Explicit order\n)\n\ntreatment\n#> [1] drug    control drug    placebo\n#> Levels: control placebo drug\nlevels(treatment)\n#> [1] \"control\" \"placebo\" \"drug\"\n```\n:::\n\n\n### Reordering Factor Levels\n\nFor visualization, you often want to order factor levels meaningfully:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(forcats)\n\n# Sample data\ngene_data <- tibble(\n  gene = c(\"BRCA1\", \"TP53\", \"EGFR\", \"KRAS\", \"MYC\"),\n  expression = c(5.2, 8.1, 3.4, 6.7, 9.2)\n)\n\n# Reorder gene by expression for better plotting\ngene_data |>\n  mutate(gene = fct_reorder(gene, expression)) |>\n  ggplot(aes(x = expression, y = gene)) +\n  geom_point(size = 3) +\n  labs(title = \"Gene Expression (ordered)\")\n```\n\n::: {.cell-output-display}\n![](08-tidy-data_files/figure-html/fct-reorder-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nOther useful reordering functions:\n\n- `fct_infreq()`: Order by frequency (most common first)\n- `fct_rev()`: Reverse the order\n- `fct_relevel()`: Manually move specific levels to the front\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Order by frequency\nfct_infreq(treatment)\n\n# Move \"control\" to be first\nfct_relevel(treatment, \"control\")\n```\n:::\n\n\n### Recoding Factor Levels\n\nUse `fct_recode()` to change level names:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Original factor\nstatus <- factor(c(\"WT\", \"WT\", \"KO\", \"HET\", \"KO\"))\n\n# Recode to more descriptive names\nfct_recode(status,\n  \"Wild Type\" = \"WT\",\n  \"Knockout\" = \"KO\",\n  \"Heterozygous\" = \"HET\"\n)\n#> [1] Wild Type    Wild Type    Knockout     Heterozygous Knockout    \n#> Levels: Heterozygous Knockout Wild Type\n```\n:::\n\n\n### Collapsing Factor Levels\n\nUse `fct_collapse()` to combine multiple levels into one:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Combine related categories\ntissue <- factor(c(\"brain\", \"liver\", \"heart\", \"kidney\", \"lung\", \"spleen\"))\n\nfct_collapse(tissue,\n  neural = \"brain\",\n  digestive = \"liver\",\n  circulatory = c(\"heart\", \"lung\"),\n  other = c(\"kidney\", \"spleen\")\n)\n#> [1] neural      digestive   circulatory other       circulatory other      \n#> Levels: neural circulatory other digestive\n```\n:::\n\n\n### Lumping Rare Levels\n\nUse `fct_lump_*()` functions to combine rare categories into \"Other\":\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Sample with many categories\nsamples <- factor(rep(c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), c(50, 30, 10, 5, 3, 2)))\n\n# Keep only the top 3 most common\nfct_lump_n(samples, n = 3)\n#>   [1] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [13] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [25] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [37] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [49] A     A     B     B     B     B     B     B     B     B     B     B    \n#>  [61] B     B     B     B     B     B     B     B     B     B     B     B    \n#>  [73] B     B     B     B     B     B     B     B     C     C     C     C    \n#>  [85] C     C     C     C     C     C     Other Other Other Other Other Other\n#>  [97] Other Other Other Other\n#> Levels: A B C Other\n\n# Keep levels that appear at least 10 times\nfct_lump_min(samples, min = 10)\n#>   [1] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [13] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [25] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [37] A     A     A     A     A     A     A     A     A     A     A     A    \n#>  [49] A     A     B     B     B     B     B     B     B     B     B     B    \n#>  [61] B     B     B     B     B     B     B     B     B     B     B     B    \n#>  [73] B     B     B     B     B     B     B     B     C     C     C     C    \n#>  [85] C     C     C     C     C     C     Other Other Other Other Other Other\n#>  [97] Other Other Other Other\n#> Levels: A B C Other\n```\n:::\n\n\n::: {.callout-tip}\nWhen plotting categorical data, proper factor ordering makes visualizations much easier to read. Always consider whether alphabetical order (the default) or a data-driven order (by value, frequency) is more meaningful.\n:::\n\n## Joining Data Frames {#sec-joins}\n\nIn real-world analysis, data often lives in multiple tables. **Joins** combine tables based on matching values in key columns.\n\n### Types of Joins\n\n| Join Type | Result |\n|:----------|:-------|\n| `inner_join()` | Keep only rows with matches in both tables |\n| `left_join()` | Keep all rows from left table, add matching data from right |\n| `right_join()` | Keep all rows from right table, add matching data from left |\n| `full_join()` | Keep all rows from both tables |\n| `semi_join()` | Keep rows from left table that have matches in right |\n| `anti_join()` | Keep rows from left table that have NO matches in right |\n\n: Types of joins in dplyr {#tbl-join-types}\n\n### Join Example\n\nLet's create two related tables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Sample information\nsamples <- tibble(\n  sample_id = c(\"S1\", \"S2\", \"S3\", \"S4\"),\n  patient = c(\"Patient_A\", \"Patient_B\", \"Patient_A\", \"Patient_C\"),\n  timepoint = c(\"baseline\", \"baseline\", \"week4\", \"baseline\")\n)\n\n# Expression measurements (note: S3 is missing, S5 is extra)\nexpression_data <- tibble(\n  sample_id = c(\"S1\", \"S2\", \"S4\", \"S5\"),\n  gene_A = c(5.2, 3.1, 4.8, 6.0),\n  gene_B = c(2.1, 1.8, 2.5, 3.2)\n)\n\nsamples\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |patient   |timepoint |\n|:---------|:---------|:---------|\n|S1        |Patient_A |baseline  |\n|S2        |Patient_B |baseline  |\n|S3        |Patient_A |week4     |\n|S4        |Patient_C |baseline  |\n\n</div>\n:::\n\n```{.r .cell-code}\nexpression_data\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id | gene_A| gene_B|\n|:---------|------:|------:|\n|S1        |    5.2|    2.1|\n|S2        |    3.1|    1.8|\n|S4        |    4.8|    2.5|\n|S5        |    6.0|    3.2|\n\n</div>\n:::\n:::\n\n\n### Left Join (Most Common)\n\nKeep all rows from the left table, add matching data from right:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nleft_join(samples, expression_data, by = \"sample_id\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |patient   |timepoint | gene_A| gene_B|\n|:---------|:---------|:---------|------:|------:|\n|S1        |Patient_A |baseline  |    5.2|    2.1|\n|S2        |Patient_B |baseline  |    3.1|    1.8|\n|S3        |Patient_A |week4     |     NA|     NA|\n|S4        |Patient_C |baseline  |    4.8|    2.5|\n\n</div>\n:::\n:::\n\n\nNote that S3 has `NA` values for the expression columns (no match in right table), and S5 is not included (not in left table).\n\n### Inner Join\n\nKeep only rows with matches in both tables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ninner_join(samples, expression_data, by = \"sample_id\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |patient   |timepoint | gene_A| gene_B|\n|:---------|:---------|:---------|------:|------:|\n|S1        |Patient_A |baseline  |    5.2|    2.1|\n|S2        |Patient_B |baseline  |    3.1|    1.8|\n|S4        |Patient_C |baseline  |    4.8|    2.5|\n\n</div>\n:::\n:::\n\n\n### Anti Join\n\nFind rows in the left table with no match in the right:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Which samples are missing expression data?\nanti_join(samples, expression_data, by = \"sample_id\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample_id |patient   |timepoint |\n|:---------|:---------|:---------|\n|S3        |Patient_A |week4     |\n\n</div>\n:::\n:::\n\n\n### Joining on Multiple Columns\n\nWhen tables share multiple key columns, specify them all:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Join on multiple columns\nleft_join(df1, df2, by = c(\"patient_id\", \"visit_date\"))\n\n# When column names differ between tables\nleft_join(df1, df2, by = c(\"id\" = \"patient_id\"))\n```\n:::\n\n\n::: {.callout-warning}\nWhen joining, watch for columns with the same name but different meanings (e.g., \"year\" in both tables meaning different things). dplyr will automatically suffix them with `.x` and `.y`, but it's better to rename ambiguous columns before joining.\n:::\n\n## Reshaping Data with tidyr {#sec-tidyr}\n\nWe've already seen `pivot_longer()` and `separate()`. Let's complete the picture with their counterparts.\n\n### Pivot Wider\n\nConvert long data back to wide format with `pivot_wider()`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Long format data\ngene_expression_long <- tibble(\n  sample = c(\"S1\", \"S1\", \"S2\", \"S2\", \"S3\", \"S3\"),\n  gene = c(\"BRCA1\", \"TP53\", \"BRCA1\", \"TP53\", \"BRCA1\", \"TP53\"),\n  expression = c(5.2, 3.1, 4.8, 2.9, 6.1, 3.5)\n)\n\ngene_expression_long\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample |gene  | expression|\n|:------|:-----|----------:|\n|S1     |BRCA1 |        5.2|\n|S1     |TP53  |        3.1|\n|S2     |BRCA1 |        4.8|\n|S2     |TP53  |        2.9|\n|S3     |BRCA1 |        6.1|\n|S3     |TP53  |        3.5|\n\n</div>\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Spread genes into columns\ngene_expression_long |>\n  pivot_wider(names_from = gene, values_from = expression)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|sample | BRCA1| TP53|\n|:------|-----:|----:|\n|S1     |   5.2|  3.1|\n|S2     |   4.8|  2.9|\n|S3     |   6.1|  3.5|\n\n</div>\n:::\n:::\n\n\n### When to Use Wide vs. Long\n\n- **Long format**: Better for analysis and plotting with ggplot2\n- **Wide format**: Better for certain statistical tests, viewing many variables at once, or sharing with collaborators expecting a spreadsheet layout\n\nYou can easily convert between formats as needed:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Round trip: long -> wide -> long\nstocks <- tibble(\n  date = as.Date('2024-01-01') + 0:2,\n  AAPL = c(185, 187, 184),\n  GOOGL = c(140, 142, 141),\n  MSFT = c(375, 378, 376)\n)\n\nstocks |>\n  pivot_longer(-date, names_to = \"ticker\", values_to = \"price\") |>\n  pivot_wider(names_from = ticker, values_from = price)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|date       | AAPL| GOOGL| MSFT|\n|:----------|----:|-----:|----:|\n|2024-01-01 |  185|   140|  375|\n|2024-01-02 |  187|   142|  378|\n|2024-01-03 |  184|   141|  376|\n\n</div>\n:::\n:::\n\n\n### Unite: Combining Columns\n\nThe `unite()` function is the opposite of `separate()`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Data with separate date components\ndate_parts <- tibble(\n  year = c(2024, 2024, 2024),\n  month = c(1, 2, 3),\n  day = c(15, 20, 25),\n  value = c(100, 150, 200)\n)\n\ndate_parts\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| year| month| day| value|\n|----:|-----:|---:|-----:|\n| 2024|     1|  15|   100|\n| 2024|     2|  20|   150|\n| 2024|     3|  25|   200|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Combine into a single date column\ndate_parts |>\n  unite(date, year, month, day, sep = \"-\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|date      | value|\n|:---------|-----:|\n|2024-1-15 |   100|\n|2024-2-20 |   150|\n|2024-3-25 |   200|\n\n</div>\n:::\n:::\n\n\nYou can convert the united column to a proper date type:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(lubridate)\n\ndate_parts |>\n  unite(date, year, month, day, sep = \"-\") |>\n  mutate(date = ymd(date))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|date       | value|\n|:----------|-----:|\n|2024-01-15 |   100|\n|2024-02-20 |   150|\n|2024-03-25 |   200|\n\n</div>\n:::\n:::\n\n\n### Separate Rows\n\nSometimes cells contain multiple values. Use `separate_rows()` to split them into separate rows:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Common in survey data: multiple selections in one cell\nsurvey <- tibble(\n  respondent = c(\"Alice\", \"Bob\"),\n  favorite_foods = c(\"pizza, tacos, sushi\", \"burgers, fries\")\n)\n\nsurvey\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|respondent |favorite_foods      |\n|:----------|:-------------------|\n|Alice      |pizza, tacos, sushi |\n|Bob        |burgers, fries      |\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Split into separate rows\nsurvey |>\n  separate_rows(favorite_foods, sep = \", \")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|respondent |favorite_foods |\n|:----------|:--------------|\n|Alice      |pizza          |\n|Alice      |tacos          |\n|Alice      |sushi          |\n|Bob        |burgers        |\n|Bob        |fries          |\n\n</div>\n:::\n:::\n\n\n### Complete and Expand\n\nWhen data has implicit missing values, use `complete()` to make them explicit:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Data with missing combinations\nobservations <- tibble(\n  site = c(\"A\", \"A\", \"B\"),\n  year = c(2020, 2021, 2020),\n  count = c(10, 15, 8)\n)\n\nobservations\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|site | year| count|\n|:----|----:|-----:|\n|A    | 2020|    10|\n|A    | 2021|    15|\n|B    | 2020|     8|\n\n</div>\n:::\n\n```{.r .cell-code}\n\n# Make all combinations explicit\nobservations |>\n  complete(site, year, fill = list(count = 0))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|site | year| count|\n|:----|----:|-----:|\n|A    | 2020|    10|\n|A    | 2021|    15|\n|B    | 2020|     8|\n|B    | 2021|     0|\n\n</div>\n:::\n:::\n\n\nUse `crossing()` to generate all combinations of values:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncrossing(\n  treatment = c(\"control\", \"drug_A\", \"drug_B\"),\n  timepoint = c(0, 24, 48),\n  replicate = 1:3\n)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|treatment | timepoint| replicate|\n|:---------|---------:|---------:|\n|control   |         0|         1|\n|control   |         0|         2|\n|control   |         0|         3|\n|control   |        24|         1|\n|control   |        24|         2|\n|control   |        24|         3|\n|control   |        48|         1|\n|control   |        48|         2|\n|control   |        48|         3|\n|drug_A    |         0|         1|\n|drug_A    |         0|         2|\n|drug_A    |         0|         3|\n|drug_A    |        24|         1|\n|drug_A    |        24|         2|\n|drug_A    |        24|         3|\n|drug_A    |        48|         1|\n|drug_A    |        48|         2|\n|drug_A    |        48|         3|\n|drug_B    |         0|         1|\n|drug_B    |         0|         2|\n|drug_B    |         0|         3|\n|drug_B    |        24|         1|\n|drug_B    |        24|         2|\n|drug_B    |        24|         3|\n|drug_B    |        48|         1|\n|drug_B    |        48|         2|\n|drug_B    |        48|         3|\n\n</div>\n:::\n:::\n\n\n## High-Performance Data Wrangling with data.table {#sec-data-table}\n\nWhile the tidyverse is excellent for learning and most data analysis tasks, the **data.table** package offers substantial performance advantages for large datasets. It's worth knowing about, especially if you work with big data.\n\n### Why data.table?\n\ndata.table excels in several areas:\n\n1. **Speed**: Often 10-100x faster than dplyr for large datasets\n2. **Memory efficiency**: Modifies data in place rather than making copies\n3. **Concise syntax**: Complex operations in a single expression\n4. **No dependencies**: Minimal external package requirements\n\n### Basic data.table Syntax\n\ndata.table uses a compact `DT[i, j, by]` syntax:\n\n- **i**: Which rows? (like `filter`)\n- **j**: What to do? (like `select`, `mutate`, `summarize`)\n- **by**: Grouped by what? (like `group_by`)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(data.table)\n\n# Convert to data.table\ndt <- as.data.table(experiments)\n\n# Filter and summarize in one expression\ndt[treatment == \"drug_A\",\n   .(mean_expr = mean(expression)),\n   by = treatment]\n\n# Equivalent dplyr:\n# experiments |>\n#   filter(treatment == \"drug_A\") |>\n#   group_by(treatment) |>\n#   summarize(mean_expr = mean(expression))\n```\n:::\n\n\n### When to Use data.table\n\nConsider data.table when:\n\n- Your dataset has millions of rows\n- You're doing repetitive operations on large data\n- Memory is constrained\n- Speed is critical (e.g., real-time analysis)\n\nFor learning and most everyday work, stick with dplyr—it's more readable and has excellent documentation.\n\n### dtplyr: Best of Both Worlds\n\nThe **dtplyr** package lets you write dplyr code that runs on data.table:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dtplyr)\n\n# Create a lazy data.table\nlazy_dt <- lazy_dt(experiments)\n\n# Use dplyr syntax, get data.table speed\nlazy_dt |>\n  filter(treatment != \"control\") |>\n  group_by(treatment) |>\n  summarize(mean_expr = mean(expression)) |>\n  as_tibble()  # Convert back to tibble\n```\n:::\n\n\nThis gives you dplyr's readable syntax with much of data.table's performance.\n\n## Summary {#sec-tidy-summary}\n\nTidy data provides a consistent structure that simplifies analysis:\n\n- Each variable is a column\n- Each observation is a row\n- Each value occupies one cell\n\nKey principles for data organization:\n\n- Use descriptive, consistent naming conventions\n- Document your data with a data dictionary\n- Preserve raw data separately from processed data\n- Choose appropriate file formats for your needs\n- Understand the difference between data types\n\nThe tidyverse provides powerful tools for working with tidy data:\n\n- The **pipe operator** (`|>` or `%>%`) chains operations for readable code\n- **dplyr verbs** provide intuitive data manipulation:\n  - `filter()` selects rows by condition\n  - `select()` picks columns by name\n  - `mutate()` creates or modifies columns\n  - `arrange()` sorts rows\n  - `summarize()` computes summary statistics\n  - `group_by()` enables grouped operations\n  - `slice()` and `pull()` provide positional subsetting and column extraction\n- **Joins** (`left_join()`, `inner_join()`, `anti_join()`, etc.) combine data from multiple tables\n- **Tibbles** are enhanced data frames with consistent behavior\n- Functions like `case_when()`, `count()`, and `distinct()` handle common tasks\n\nThe **tidyr** package provides tools for reshaping data:\n\n- `pivot_longer()` converts wide data to long format\n- `pivot_wider()` converts long data to wide format\n- `separate()` splits one column into multiple columns\n- `unite()` combines multiple columns into one\n- `separate_rows()` splits cells with multiple values into rows\n- `complete()` and `crossing()` handle missing combinations\n\nFor high-performance needs, **data.table** offers:\n\n- Concise `DT[i, j, by]` syntax\n- 10-100x speed improvements on large datasets\n- Memory efficiency through modification by reference\n- **dtplyr** as a bridge for those who prefer dplyr syntax\n\nThese practices and tools apply across data science workflows. Well-organized data combined with tidyverse tools makes analysis efficient, reproducible, and shareable.\n\n## Additional Reading {.unnumbered}\n\nTo deepen your understanding of tidy data and the tidyverse:\n\n- **[R for Data Science](https://r4ds.hadley.nz/)** by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund — The definitive guide to the tidyverse\n- **[Tidy Data (Original Paper)](https://vita.had.co.nz/papers/tidy-data.pdf)** by Hadley Wickham — The foundational paper on tidy data principles\n- **[dplyr Documentation](https://dplyr.tidyverse.org/)** — Official documentation with examples and vignettes\n- **[tidyr Documentation](https://tidyr.tidyverse.org/)** — Guide to reshaping data\n- **[forcats Documentation](https://forcats.tidyverse.org/)** — Working with categorical data\n- **[janitor Package](https://sfirke.github.io/janitor/)** — Tools for cleaning messy data\n\nFor high-performance data manipulation:\n\n- **[data.table Documentation](https://rdatatable.gitlab.io/data.table/)** — The authoritative guide to data.table\n- **[dtplyr Package](https://dtplyr.tidyverse.org/)** — Using dplyr syntax with data.table speed\n\n## Exercises {.unnumbered}\n\n::: {.callout-tip title=\"Practice Exercises\"}\n**Exercise 1: Identify Tidy Data**\n\nFor each dataset description, determine if it's tidy. If not, explain what violates tidy principles:\n\n1. Patient data with columns: patient_id, age, blood_pressure_systolic, blood_pressure_diastolic\n2. Gene expression with columns: gene_name, sample_1, sample_2, sample_3\n3. Survey data with columns: respondent_id, question, response\n4. Weather data with columns: city, 2023_temp, 2024_temp, 2023_precip, 2024_precip\n\n**Exercise 2: Reshape Data**\n\nGiven this messy dataset:\n```\nCountry   1990   2000   2010\nUSA       250    280    310  \nCanada    27     31     35\nMexico    86     100    120\n```\n\nWrite R code using `pivot_longer()` to convert it to tidy format.\n\n**Exercise 3: Data Dictionary**\n\nCreate a data dictionary for an experiment tracking:\n- Gene expression levels measured at 0, 12, and 24 hours\n- Three treatment groups (control, low dose, high dose)\n- Twenty biological replicates per group\n- Quality control pass/fail flags\n\n**Exercise 4: Spot the Problems**\n\nReview a dataset you've worked with (or your lab's data). Identify any violations of tidy data principles and propose solutions.\n\n**Exercise 5: dplyr Practice**\n\nUsing the built-in `mtcars` dataset:\n1. Filter to only cars with 6 or 8 cylinders\n2. Select only the columns `mpg`, `cyl`, `hp`, and `wt`\n3. Create a new column `hp_per_cyl` (horsepower per cylinder)\n4. Arrange by `mpg` in descending order\n\n**Exercise 6: Grouped Summaries**\n\nUsing the `iris` dataset:\n1. Calculate the mean and standard deviation of `Sepal.Length` for each `Species`\n2. Find the maximum `Petal.Width` for each species\n3. Count the number of observations per species\n4. Chain all these operations using the pipe operator\n\n**Exercise 7: Data Transformation Pipeline**\n\nCreate a complete analysis pipeline that:\n1. Starts with the `mtcars` dataset\n2. Filters to automatic transmission cars (`am == 0`)\n3. Groups by number of cylinders\n4. Calculates mean mpg, mean horsepower, and count per group\n5. Creates a new column classifying fuel efficiency as \"good\" (mpg >= 20) or \"poor\"\n6. Arranges by mean mpg descending\n\n**Exercise 8: Tibble Exploration**\n\n1. Convert `mtcars` to a tibble\n2. Compare how the data frame and tibble display when printed\n3. Test subsetting behavior: what class does `mtcars[, 1]` return vs `as_tibble(mtcars)[, 1]`?\n\n**Exercise 9: Joining Tables**\n\nCreate two tibbles:\n```r\npatients <- tibble(\n  patient_id = c(\"P001\", \"P002\", \"P003\", \"P004\"),\n  name = c(\"Alice\", \"Bob\", \"Carol\", \"David\"),\n  age = c(45, 52, 38, 61)\n)\n\nlab_results <- tibble(\n  patient_id = c(\"P001\", \"P002\", \"P002\", \"P005\"),\n  test = c(\"glucose\", \"glucose\", \"cholesterol\", \"glucose\"),\n  result = c(95, 110, 185, 88)\n)\n```\n\n1. Perform a left join to add lab results to patient information\n2. Use an anti-join to find patients with no lab results\n3. Use an inner join to keep only patients who have lab results\n4. Explain why P005 appears or doesn't appear in each result\n\n**Exercise 10: Reshaping Practice**\n\nGiven this long-format data:\n```r\nmeasurements <- tibble(\n  sample = rep(c(\"A\", \"B\", \"C\"), each = 2),\n  metric = rep(c(\"weight\", \"height\"), 3),\n  value = c(70, 175, 65, 168, 80, 182)\n)\n```\n\n1. Use `pivot_wider()` to create columns for weight and height\n2. Calculate BMI (weight / (height/100)^2) on the wide data\n3. Convert back to long format with `pivot_longer()`\n\n**Exercise 11: Separate and Unite**\n\n1. Given data with a combined column `\"2024-01-15\"`, use `separate()` to split it into year, month, and day columns\n2. Use `unite()` to combine them back, but with slashes as separators (`\"2024/01/15\"`)\n3. When might you prefer `separate_rows()` over `separate()`?\n:::\n",
    "supporting": [
      "08-tidy-data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}