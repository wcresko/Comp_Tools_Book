<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="A comprehensive guide to essential computational tools for graduate students in bioengineering and life sciences, covering Unix/Linux, R programming, version control with Git/GitHub, and high-performance computing.">
<title>7&nbsp; R Programming Fundamentals – Foundational Computational Tools for Bioengineers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/08-tidy-data.html" rel="next">
<link href="../chapters/06-shell-scripting.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-d447b626f1df67f6a2368ec23f4c5255.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-c7529a8313f81663d953c47b1ab362ff.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-d447b626f1df67f6a2368ec23f4c5255.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0dd4bede59fce912683c1f38b3836bca.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-eb3cfb2dc3b1d18999aa5075de07535d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-0dd4bede59fce912683c1f38b3836bca.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/07-r-programming.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R Programming Fundamentals</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/uo_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Foundational Computational Tools for Bioengineers</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/wcresko/BioE_Comp_Tools_Book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Computational Tools</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-computer-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Computer Systems Architecture</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-unix-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Unix Fundamentals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-files-pipes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Files, Pipes, and Redirection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-grep-regex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">GREP and Regular Expressions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-shell-scripting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Shell Scripting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-r-programming.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R Programming Fundamentals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-tidy-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tidy Data Principles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Visualization with ggplot2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-git-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Version Control with Git and GitHub</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-hpc-talapas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">High-Performance Computing with Talapas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12-quarto-documents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reproducible Documents with Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13-writing-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Writing Functions in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14-parallel-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Parallel Computing in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/15-databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with Databases</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/appendix-commands.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Command Reference</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-why-r" id="toc-sec-why-r" class="nav-link active" data-scroll-target="#sec-why-r"><span class="header-section-number">7.1</span> Why R for Scientific Computing?</a></li>
  <li>
<a href="#sec-rstudio" id="toc-sec-rstudio" class="nav-link" data-scroll-target="#sec-rstudio"><span class="header-section-number">7.2</span> RStudio: Your R Environment</a>
  <ul class="collapse">
<li><a href="#the-rstudio-interface" id="toc-the-rstudio-interface" class="nav-link" data-scroll-target="#the-rstudio-interface"><span class="header-section-number">7.2.1</span> The RStudio Interface</a></li>
  <li><a href="#rstudio-projects" id="toc-rstudio-projects" class="nav-link" data-scroll-target="#rstudio-projects"><span class="header-section-number">7.2.2</span> RStudio Projects</a></li>
  </ul>
</li>
  <li><a href="#sec-r-objects" id="toc-sec-r-objects" class="nav-link" data-scroll-target="#sec-r-objects"><span class="header-section-number">7.3</span> Understanding R: Everything is an Object</a></li>
  <li>
<a href="#sec-r-basics" id="toc-sec-r-basics" class="nav-link" data-scroll-target="#sec-r-basics"><span class="header-section-number">7.4</span> R Basics: Arithmetic and Variables</a>
  <ul class="collapse">
<li><a href="#r-as-a-calculator" id="toc-r-as-a-calculator" class="nav-link" data-scroll-target="#r-as-a-calculator"><span class="header-section-number">7.4.1</span> R as a Calculator</a></li>
  <li><a href="#creating-variables" id="toc-creating-variables" class="nav-link" data-scroll-target="#creating-variables"><span class="header-section-number">7.4.2</span> Creating Variables</a></li>
  <li><a href="#variable-naming-rules" id="toc-variable-naming-rules" class="nav-link" data-scroll-target="#variable-naming-rules"><span class="header-section-number">7.4.3</span> Variable Naming Rules</a></li>
  <li><a href="#reserved-words" id="toc-reserved-words" class="nav-link" data-scroll-target="#reserved-words"><span class="header-section-number">7.4.4</span> Reserved Words</a></li>
  </ul>
</li>
  <li><a href="#sec-r-terminology" id="toc-sec-r-terminology" class="nav-link" data-scroll-target="#sec-r-terminology"><span class="header-section-number">7.5</span> Key R Terminology</a></li>
  <li>
<a href="#sec-vectors" id="toc-sec-vectors" class="nav-link" data-scroll-target="#sec-vectors"><span class="header-section-number">7.6</span> Vectors: R’s Fundamental Data Structure</a>
  <ul class="collapse">
<li><a href="#creating-vectors" id="toc-creating-vectors" class="nav-link" data-scroll-target="#creating-vectors"><span class="header-section-number">7.6.1</span> Creating Vectors</a></li>
  <li><a href="#sequence-generation" id="toc-sequence-generation" class="nav-link" data-scroll-target="#sequence-generation"><span class="header-section-number">7.6.2</span> Sequence Generation</a></li>
  <li><a href="#sorting-vectors" id="toc-sorting-vectors" class="nav-link" data-scroll-target="#sorting-vectors"><span class="header-section-number">7.6.3</span> Sorting Vectors</a></li>
  <li><a href="#vectorized-operations" id="toc-vectorized-operations" class="nav-link" data-scroll-target="#vectorized-operations"><span class="header-section-number">7.6.4</span> Vectorized Operations</a></li>
  <li><a href="#vector-indexing" id="toc-vector-indexing" class="nav-link" data-scroll-target="#vector-indexing"><span class="header-section-number">7.6.5</span> Vector Indexing</a></li>
  </ul>
</li>
  <li>
<a href="#sec-data-types" id="toc-sec-data-types" class="nav-link" data-scroll-target="#sec-data-types"><span class="header-section-number">7.7</span> Data Types in R</a>
  <ul class="collapse">
<li><a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors"><span class="header-section-number">7.7.1</span> Factors</a></li>
  <li><a href="#special-values" id="toc-special-values" class="nav-link" data-scroll-target="#special-values"><span class="header-section-number">7.7.2</span> Special Values</a></li>
  <li><a href="#logical-operators-and-comparisons" id="toc-logical-operators-and-comparisons" class="nav-link" data-scroll-target="#logical-operators-and-comparisons"><span class="header-section-number">7.7.3</span> Logical Operators and Comparisons</a></li>
  <li><a href="#finding-indices-with-which" id="toc-finding-indices-with-which" class="nav-link" data-scroll-target="#finding-indices-with-which"><span class="header-section-number">7.7.4</span> Finding Indices with <code>which()</code></a></li>
  <li><a href="#floating-point-precision" id="toc-floating-point-precision" class="nav-link" data-scroll-target="#floating-point-precision"><span class="header-section-number">7.7.5</span> Floating-Point Precision</a></li>
  <li><a href="#using-dplyrnear-for-comparisons" id="toc-using-dplyrnear-for-comparisons" class="nav-link" data-scroll-target="#using-dplyrnear-for-comparisons"><span class="header-section-number">7.7.6</span> Using <code>dplyr::near()</code> for Comparisons</a></li>
  </ul>
</li>
  <li>
<a href="#sec-r-functions" id="toc-sec-r-functions" class="nav-link" data-scroll-target="#sec-r-functions"><span class="header-section-number">7.8</span> Functions</a>
  <ul class="collapse">
<li><a href="#using-functions" id="toc-using-functions" class="nav-link" data-scroll-target="#using-functions"><span class="header-section-number">7.8.1</span> Using Functions</a></li>
  <li><a href="#function-arguments" id="toc-function-arguments" class="nav-link" data-scroll-target="#function-arguments"><span class="header-section-number">7.8.2</span> Function Arguments</a></li>
  <li><a href="#nesting-functions" id="toc-nesting-functions" class="nav-link" data-scroll-target="#nesting-functions"><span class="header-section-number">7.8.3</span> Nesting Functions</a></li>
  <li><a href="#getting-help" id="toc-getting-help" class="nav-link" data-scroll-target="#getting-help"><span class="header-section-number">7.8.4</span> Getting Help</a></li>
  </ul>
</li>
  <li>
<a href="#sec-packages" id="toc-sec-packages" class="nav-link" data-scroll-target="#sec-packages"><span class="header-section-number">7.9</span> Installing and Loading Packages</a>
  <ul class="collapse">
<li><a href="#installing-packages" id="toc-installing-packages" class="nav-link" data-scroll-target="#installing-packages"><span class="header-section-number">7.9.1</span> Installing Packages</a></li>
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages"><span class="header-section-number">7.9.2</span> Loading Packages</a></li>
  <li><a href="#namespace-conflicts" id="toc-namespace-conflicts" class="nav-link" data-scroll-target="#namespace-conflicts"><span class="header-section-number">7.9.3</span> Namespace Conflicts</a></li>
  </ul>
</li>
  <li>
<a href="#sec-data-frames" id="toc-sec-data-frames" class="nav-link" data-scroll-target="#sec-data-frames"><span class="header-section-number">7.10</span> Data Frames</a>
  <ul class="collapse">
<li><a href="#creating-data-frames" id="toc-creating-data-frames" class="nav-link" data-scroll-target="#creating-data-frames"><span class="header-section-number">7.10.1</span> Creating Data Frames</a></li>
  <li><a href="#examining-data-frames" id="toc-examining-data-frames" class="nav-link" data-scroll-target="#examining-data-frames"><span class="header-section-number">7.10.2</span> Examining Data Frames</a></li>
  <li><a href="#accessing-data-frame-elements" id="toc-accessing-data-frame-elements" class="nav-link" data-scroll-target="#accessing-data-frame-elements"><span class="header-section-number">7.10.3</span> Accessing Data Frame Elements</a></li>
  <li><a href="#adding-and-modifying-columns" id="toc-adding-and-modifying-columns" class="nav-link" data-scroll-target="#adding-and-modifying-columns"><span class="header-section-number">7.10.4</span> Adding and Modifying Columns</a></li>
  </ul>
</li>
  <li>
<a href="#sec-lists" id="toc-sec-lists" class="nav-link" data-scroll-target="#sec-lists"><span class="header-section-number">7.11</span> Lists</a>
  <ul class="collapse">
<li><a href="#creating-lists" id="toc-creating-lists" class="nav-link" data-scroll-target="#creating-lists"><span class="header-section-number">7.11.1</span> Creating Lists</a></li>
  <li><a href="#indexing-lists" id="toc-indexing-lists" class="nav-link" data-scroll-target="#indexing-lists"><span class="header-section-number">7.11.2</span> Indexing Lists</a></li>
  </ul>
</li>
  <li>
<a href="#sec-matrices" id="toc-sec-matrices" class="nav-link" data-scroll-target="#sec-matrices"><span class="header-section-number">7.12</span> Matrices</a>
  <ul class="collapse">
<li><a href="#creating-matrices" id="toc-creating-matrices" class="nav-link" data-scroll-target="#creating-matrices"><span class="header-section-number">7.12.1</span> Creating Matrices</a></li>
  <li><a href="#matrix-operations" id="toc-matrix-operations" class="nav-link" data-scroll-target="#matrix-operations"><span class="header-section-number">7.12.2</span> Matrix Operations</a></li>
  </ul>
</li>
  <li>
<a href="#sec-reading-writing" id="toc-sec-reading-writing" class="nav-link" data-scroll-target="#sec-reading-writing"><span class="header-section-number">7.13</span> Reading and Writing Data</a>
  <ul class="collapse">
<li><a href="#reading-files" id="toc-reading-files" class="nav-link" data-scroll-target="#reading-files"><span class="header-section-number">7.13.1</span> Reading Files</a></li>
  <li><a href="#writing-files" id="toc-writing-files" class="nav-link" data-scroll-target="#writing-files"><span class="header-section-number">7.13.2</span> Writing Files</a></li>
  </ul>
</li>
  <li>
<a href="#sec-basic-viz" id="toc-sec-basic-viz" class="nav-link" data-scroll-target="#sec-basic-viz"><span class="header-section-number">7.14</span> Basic Visualization</a>
  <ul class="collapse">
<li><a href="#scatter-plots" id="toc-scatter-plots" class="nav-link" data-scroll-target="#scatter-plots"><span class="header-section-number">7.14.1</span> Scatter Plots</a></li>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms"><span class="header-section-number">7.14.2</span> Histograms</a></li>
  <li><a href="#box-plots" id="toc-box-plots" class="nav-link" data-scroll-target="#box-plots"><span class="header-section-number">7.14.3</span> Box Plots</a></li>
  <li><a href="#multiple-plots" id="toc-multiple-plots" class="nav-link" data-scroll-target="#multiple-plots"><span class="header-section-number">7.14.4</span> Multiple Plots</a></li>
  </ul>
</li>
  <li>
<a href="#sec-split-apply-combine" id="toc-sec-split-apply-combine" class="nav-link" data-scroll-target="#sec-split-apply-combine"><span class="header-section-number">7.15</span> The Split-Apply-Combine Approach</a>
  <ul class="collapse">
<li><a href="#using-tapply-for-grouped-operations" id="toc-using-tapply-for-grouped-operations" class="nav-link" data-scroll-target="#using-tapply-for-grouped-operations"><span class="header-section-number">7.15.1</span> Using <code>tapply()</code> for Grouped Operations</a></li>
  <li><a href="#using-aggregate-for-data-frames" id="toc-using-aggregate-for-data-frames" class="nav-link" data-scroll-target="#using-aggregate-for-data-frames"><span class="header-section-number">7.15.2</span> Using <code>aggregate()</code> for Data Frames</a></li>
  <li><a href="#the-apply-family" id="toc-the-apply-family" class="nav-link" data-scroll-target="#the-apply-family"><span class="header-section-number">7.15.3</span> The <code>apply()</code> Family</a></li>
  </ul>
</li>
  <li>
<a href="#sec-programming-constructs" id="toc-sec-programming-constructs" class="nav-link" data-scroll-target="#sec-programming-constructs"><span class="header-section-number">7.16</span> Basic Programming Constructs</a>
  <ul class="collapse">
<li><a href="#conditional-statements-with-ifelse" id="toc-conditional-statements-with-ifelse" class="nav-link" data-scroll-target="#conditional-statements-with-ifelse"><span class="header-section-number">7.16.1</span> Conditional Statements with <code>ifelse()</code></a></li>
  <li><a href="#type-safe-conditionals-with-if_else" id="toc-type-safe-conditionals-with-if_else" class="nav-link" data-scroll-target="#type-safe-conditionals-with-if_else"><span class="header-section-number">7.16.2</span> Type-Safe Conditionals with <code>if_else()</code></a></li>
  <li><a href="#for-loops" id="toc-for-loops" class="nav-link" data-scroll-target="#for-loops"><span class="header-section-number">7.16.3</span> For Loops</a></li>
  <li><a href="#writing-simple-functions" id="toc-writing-simple-functions" class="nav-link" data-scroll-target="#writing-simple-functions"><span class="header-section-number">7.16.4</span> Writing Simple Functions</a></li>
  </ul>
</li>
  <li>
<a href="#sec-random-sampling" id="toc-sec-random-sampling" class="nav-link" data-scroll-target="#sec-random-sampling"><span class="header-section-number">7.17</span> Random Sampling and Simulation</a>
  <ul class="collapse">
<li><a href="#common-distribution-functions" id="toc-common-distribution-functions" class="nav-link" data-scroll-target="#common-distribution-functions"><span class="header-section-number">7.17.1</span> Common Distribution Functions</a></li>
  <li><a href="#repeated-simulations-with-replicate" id="toc-repeated-simulations-with-replicate" class="nav-link" data-scroll-target="#repeated-simulations-with-replicate"><span class="header-section-number">7.17.2</span> Repeated Simulations with <code>replicate()</code></a></li>
  </ul>
</li>
  <li>
<a href="#sec-numeric-transformations" id="toc-sec-numeric-transformations" class="nav-link" data-scroll-target="#sec-numeric-transformations"><span class="header-section-number">7.18</span> Useful Numeric Transformations</a>
  <ul class="collapse">
<li><a href="#cumulative-and-running-aggregates" id="toc-cumulative-and-running-aggregates" class="nav-link" data-scroll-target="#cumulative-and-running-aggregates"><span class="header-section-number">7.18.1</span> Cumulative and Running Aggregates</a></li>
  <li><a href="#offsets-with-lead-and-lag" id="toc-offsets-with-lead-and-lag" class="nav-link" data-scroll-target="#offsets-with-lead-and-lag"><span class="header-section-number">7.18.2</span> Offsets with <code>lead()</code> and <code>lag()</code></a></li>
  <li><a href="#ranking-values" id="toc-ranking-values" class="nav-link" data-scroll-target="#ranking-values"><span class="header-section-number">7.18.3</span> Ranking Values</a></li>
  <li><a href="#binning-numbers-with-cut" id="toc-binning-numbers-with-cut" class="nav-link" data-scroll-target="#binning-numbers-with-cut"><span class="header-section-number">7.18.4</span> Binning Numbers with <code>cut()</code></a></li>
  </ul>
</li>
  <li>
<a href="#sec-cleanup" id="toc-sec-cleanup" class="nav-link" data-scroll-target="#sec-cleanup"><span class="header-section-number">7.19</span> Cleaning Up Your Environment</a>
  <ul class="collapse">
<li><a href="#removing-objects" id="toc-removing-objects" class="nav-link" data-scroll-target="#removing-objects"><span class="header-section-number">7.19.1</span> Removing Objects</a></li>
  <li><a href="#closing-graphics-devices" id="toc-closing-graphics-devices" class="nav-link" data-scroll-target="#closing-graphics-devices"><span class="header-section-number">7.19.2</span> Closing Graphics Devices</a></li>
  <li><a href="#checking-your-environment" id="toc-checking-your-environment" class="nav-link" data-scroll-target="#checking-your-environment"><span class="header-section-number">7.19.3</span> Checking Your Environment</a></li>
  </ul>
</li>
  <li><a href="#sec-r-summary" id="toc-sec-r-summary" class="nav-link" data-scroll-target="#sec-r-summary"><span class="header-section-number">7.20</span> Summary</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional Resources</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/wcresko/BioE_Comp_Tools_Book/edit/main/chapters/07-r-programming.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/wcresko/BioE_Comp_Tools_Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-r-programming" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R Programming Fundamentals</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-default callout-note callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>After completing this chapter, you will be able to:</p>
<ul>
<li>Explain why R is well-suited for scientific computing</li>
<li>Understand R’s object-oriented nature and examine objects with <code><a href="https://rdrr.io/r/base/class.html">class()</a></code>, <code><a href="https://rdrr.io/r/base/typeof.html">typeof()</a></code>, and <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>
</li>
<li>Use RStudio as an integrated development environment</li>
<li>Perform basic arithmetic and variable assignment in R</li>
<li>Work with vectors and understand vectorized operations</li>
<li>Use logical operators and handle floating-point comparisons correctly</li>
<li>Create and manipulate data frames, lists, and matrices</li>
<li>Use built-in functions and access help documentation including vignettes</li>
<li>Install packages and resolve namespace conflicts</li>
<li>Create basic visualizations</li>
<li>Read and write data files</li>
<li>Clean up your R environment and graphics devices</li>
</ul>
</div>
</div>
<section id="sec-why-r" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="sec-why-r">
<span class="header-section-number">7.1</span> Why R for Scientific Computing?</h2>
<p>R is a programming language designed specifically for statistical computing and graphics <span class="citation" data-cites="rproject2024">(<a href="../references.html#ref-rproject2024" role="doc-biblioref">R Core Team, 2024</a>)</span>. It is an offshoot of a language called <strong>S</strong>, developed in 1976 at Bell Laboratories by John Chambers and colleagues. R was created in 1991 by Ross Ihaka and Robert Gentleman at the University of Auckland, New Zealand (hence the name “R”), and has since become one of the most widely used tools in data science, statistics, and bioinformatics.</p>
<p>As an <strong>interpreted language</strong>, R code is translated to machine language by the R interpreter each time it runs, as opposed to being compiled beforehand. This makes R highly interactive and excellent for exploratory data analysis.</p>
<p>R offers several advantages for researchers:</p>
<dl>
<dt><strong>Statistical Power</strong></dt>
<dd>
R was built by statisticians for statistics. It includes comprehensive implementations of classical and modern statistical methods.
</dd>
<dt><strong>Graphics Excellence</strong></dt>
<dd>
R produces publication-quality graphics with fine-grained control over every aspect of visualization.
</dd>
<dt><strong>Package Ecosystem</strong></dt>
<dd>
Over 20,000 packages extend R’s capabilities for virtually every analytical need, from genomics to machine learning.
</dd>
<dt><strong>Reproducibility</strong></dt>
<dd>
R scripts document your analysis completely. Combined with Quarto (which produced this book!), you can create reproducible documents that integrate code, results, and narrative.
</dd>
<dt><strong>Active Community</strong></dt>
<dd>
A large, welcoming community provides abundant resources, tutorials, and support.
</dd>
<dt><strong>Cost</strong></dt>
<dd>
R is free and open-source, removing financial barriers to sophisticated analysis.
</dd>
</dl></section><section id="sec-rstudio" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="sec-rstudio">
<span class="header-section-number">7.2</span> RStudio: Your R Environment</h2>
<p>While R can run from the command line, most users work in <strong>RStudio</strong>, an integrated development environment (IDE) that makes R more accessible and productive.</p>
<section id="the-rstudio-interface" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="the-rstudio-interface">
<span class="header-section-number">7.2.1</span> The RStudio Interface</h3>
<p>RStudio organizes your workspace into four panes:</p>
<dl>
<dt><strong>Source (top-left)</strong></dt>
<dd>
Where you write and edit scripts. Code here isn’t executed until you explicitly run it.
</dd>
<dt><strong>Console (bottom-left)</strong></dt>
<dd>
The interactive R session. Commands typed here execute immediately. Output appears here.
</dd>
<dt><strong>Environment/History (top-right)</strong></dt>
<dd>
Shows variables you’ve created (Environment tab) and commands you’ve run (History tab).
</dd>
<dt><strong>Files/Plots/Help (bottom-right)</strong></dt>
<dd>
File browser, plot viewer, and help documentation.
</dd>
</dl>
<div id="fig-rstudio-interface" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-rstudio-interface-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/RStudio_Screenshot.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rstudio-interface-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: The RStudio interface showing all four panes: Source (top-left) with R code, Console (bottom-left) showing command output, Environment/Workspace (top-right) displaying variables and data, and Plots (bottom-right) showing a visualization.
</figcaption></figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Learn keyboard shortcuts! <code>Ctrl+Enter</code> (Windows/Linux) or <code>Cmd+Enter</code> (Mac) runs the current line or selection. <code>Ctrl+Shift+S</code> runs the entire script.</p>
</div>
</div>
</section><section id="rstudio-projects" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="rstudio-projects">
<span class="header-section-number">7.2.2</span> RStudio Projects</h3>
<p>RStudio Projects organize your work with self-contained directories:</p>
<ol type="1">
<li>Go to File → New Project</li>
<li>Choose New Directory → New Project</li>
<li>Name your project and select a location</li>
<li>RStudio creates a <code>.Rproj</code> file</li>
</ol>
<p>Projects set your working directory automatically and keep related files together—essential for reproducible research.</p>
</section></section><section id="sec-r-objects" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="sec-r-objects">
<span class="header-section-number">7.3</span> Understanding R: Everything is an Object</h2>
<p>Before diving into R syntax, it helps to understand R’s fundamental design philosophy: <strong>everything in R is an object</strong>. This object-oriented approach means that every piece of data you work with—numbers, text, datasets, even functions themselves—is stored as an object with specific properties.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Numbers are objects</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>x <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">class</span>(x)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; [1] "numeric"</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">typeof</span>(x)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; [1] "double"</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># Text strings are objects</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>name <span class="ot">&lt;-</span> <span class="st">"Gene Expression"</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">class</span>(name)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; [1] "character"</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">typeof</span>(name)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt; [1] "character"</span></span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co"># Even functions are objects!</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">class</span>(mean)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt; [1] "function"</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="fu">typeof</span>(mean)</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">#&gt; [1] "closure"</span></span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co"># And data frames are objects</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">b =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>))</span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="fu">class</span>(df)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">#&gt; [1] "data.frame"</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu">typeof</span>(df)</span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">#&gt; [1] "list"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Every object has:</p>
<ul>
<li>
<strong>A class</strong>: Determines how the object behaves with functions (what <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> returns)</li>
<li>
<strong>A type</strong>: The underlying storage mode (what <code><a href="https://rdrr.io/r/base/typeof.html">typeof()</a></code> returns)</li>
<li>
<strong>Attributes</strong>: Optional metadata like names, dimensions, or custom properties</li>
</ul>
<p>The <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function provides a compact display of an object’s structure:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Examine structure of different objects</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">str</span>(x)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt;  num 42</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">str</span>(name)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;  chr "Gene Expression"</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">str</span>(df)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; 'data.frame':    3 obs. of  2 variables:</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt;  $ a: int  1 2 3</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt;  $ b: chr  "x" "y" "z"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Understanding this object-oriented nature helps you:</p>
<ol type="1">
<li>
<strong>Debug errors</strong>: When functions fail, check what class of object you’re passing</li>
<li>
<strong>Use generic functions</strong>: Functions like <code><a href="https://rdrr.io/r/base/print.html">print()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, and <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> behave differently based on object class</li>
<li>
<strong>Extend R</strong>: You can create custom classes with specialized behaviors</li>
</ol></section><section id="sec-r-basics" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="sec-r-basics">
<span class="header-section-number">7.4</span> R Basics: Arithmetic and Variables</h2>
<section id="r-as-a-calculator" class="level3" data-number="7.4.1"><h3 data-number="7.4.1" class="anchored" data-anchor-id="r-as-a-calculator">
<span class="header-section-number">7.4.1</span> R as a Calculator</h3>
<p>The simplest use of R is arithmetic:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Basic operations</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; [1] 16</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># Order of operations applies</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>(<span class="dv">4</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; [1] 16</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># More complex expressions</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">sqrt</span>(<span class="dv">144</span>) <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">100</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; [1] 16.60517</span></span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co"># Integer division and modulo</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="dv">17</span> <span class="sc">%/%</span> <span class="dv">5</span>    <span class="co"># Integer division: how many times 5 goes into 17</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="dv">17</span> <span class="sc">%%</span> <span class="dv">5</span>     <span class="co"># Modulo: remainder after division</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt; [1] 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>R follows standard mathematical order of operations (PEMDAS). The modulo operator (<code>%%</code>) is particularly useful for tasks like determining if a number is even or odd, cycling through indices, or extracting digits from numbers:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Check if numbers are even (remainder 0 when divided by 2)</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>numbers <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>numbers <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt;  [1] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># Extract the last digit of a number</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="dv">12345</span> <span class="sc">%%</span> <span class="dv">10</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; [1] 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="creating-variables" class="level3" data-number="7.4.2"><h3 data-number="7.4.2" class="anchored" data-anchor-id="creating-variables">
<span class="header-section-number">7.4.2</span> Creating Variables</h3>
<p>Variables store values for later use. In R, the assignment operator is <code>&lt;-</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Assign values to variables</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Use variables in calculations</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>x <span class="sc">*</span> <span class="dv">3</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>y <span class="sc">+</span> x</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co"># Store results in new variables</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>z <span class="ot">&lt;-</span> x <span class="sc">*</span> y</span>
<span id="cb5-13"><a href="#cb5-13"></a>z</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; [1] 10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can also use <code>=</code> for assignment in R, but <code>&lt;-</code> is the traditional and preferred style. It makes assignment visually distinct from function arguments, which use <code>=</code>.</p>
</div>
</div>
</section><section id="variable-naming-rules" class="level3" data-number="7.4.3"><h3 data-number="7.4.3" class="anchored" data-anchor-id="variable-naming-rules">
<span class="header-section-number">7.4.3</span> Variable Naming Rules</h3>
<ul>
<li>Names must start with a letter</li>
<li>Can contain letters, numbers, periods, and underscores</li>
<li>R is case-sensitive: <code>Gene</code> and <code>gene</code> are different variables</li>
<li>Use descriptive names: <code>sample_count</code> is better than <code>sc</code>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Valid names</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>gene_count <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>Sample<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="st">"control"</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>myData2 <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># Invalid (would cause errors)</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co"># 2samples &lt;- 5      # Can't start with number</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># my-data &lt;- 10      # Hyphens not allowed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="reserved-words" class="level3" data-number="7.4.4"><h3 data-number="7.4.4" class="anchored" data-anchor-id="reserved-words">
<span class="header-section-number">7.4.4</span> Reserved Words</h3>
<p>R has <strong>reserved words</strong> that cannot be used as variable names because they have special meaning in the language:</p>
<div id="tbl-reserved-words" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-reserved-words-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.1: R reserved words
</figcaption><div aria-describedby="tbl-reserved-words-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">Reserved Words</th>
<th style="text-align: left;">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<code>if</code>, <code>else</code>
</td>
<td style="text-align: left;">Conditional statements</td>
</tr>
<tr class="even">
<td style="text-align: left;">
<code>for</code>, <code>while</code>, <code>repeat</code>
</td>
<td style="text-align: left;">Loop constructs</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>function</code></td>
<td style="text-align: left;">Function definition</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>in</code></td>
<td style="text-align: left;">Used in for loops</td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<code><a href="https://rdrr.io/r/base/Control.html">next</a></code>, <code><a href="https://rdrr.io/r/base/Control.html">break</a></code>
</td>
<td style="text-align: left;">Loop control</td>
</tr>
<tr class="even">
<td style="text-align: left;">
<code>TRUE</code>, <code>FALSE</code>
</td>
<td style="text-align: left;">Logical constants</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>NULL</code></td>
<td style="text-align: left;">Null object</td>
</tr>
<tr class="even">
<td style="text-align: left;">
<code>Inf</code>, <code>NaN</code>, <code>NA</code>
</td>
<td style="text-align: left;">Special numeric values</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>R also has <strong>semi-reserved words</strong>—names of built-in constants and functions that you <em>can</em> overwrite but generally shouldn’t:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># These work but are dangerous:</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>T <span class="ot">&lt;-</span> <span class="dv">5</span>       <span class="co"># Overwrites TRUE abbreviation</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>F <span class="ot">&lt;-</span> <span class="dv">10</span>      <span class="co"># Overwrites FALSE abbreviation</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>c <span class="ot">&lt;-</span> <span class="st">"text"</span>  <span class="co"># Shadows the c() function</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>mean <span class="ot">&lt;-</span> <span class="dv">42</span>   <span class="co"># Shadows the mean() function</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># If you accidentally overwrite something, use rm() to remove it</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="fu">rm</span>(c)        <span class="co"># Removes your 'c' variable, restoring access to c()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Avoid using <code>T</code> and <code>F</code> as variable names—they are common abbreviations for <code>TRUE</code> and <code>FALSE</code>. Similarly, never name variables <code>c</code>, <code>t</code>, <code>mean</code>, <code>sum</code>, or other common function names.</p>
</div>
</div>
</section></section><section id="sec-r-terminology" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="sec-r-terminology">
<span class="header-section-number">7.5</span> Key R Terminology</h2>
<p>Before diving deeper into R, let’s establish some fundamental terminology that you’ll encounter throughout your R programming journey:</p>
<div id="fig-r-terminology" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-r-terminology-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/R_definitions_Logan.001.jpeg" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-terminology-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: Core R concepts: Objects, Vectors, Functions, Parameters, and Arguments are the building blocks of R programming.
</figcaption></figure>
</div>
<p>Understanding R’s operators is equally important. The table below shows the main operators you’ll use, listed in order of precedence (operations higher in the table are evaluated first):</p>
<div id="fig-r-operators" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-r-operators-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/R_definitions_Logan.002.jpeg" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-operators-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: R operators reference: This table shows common R operators for indexing, arithmetic, comparison, logical operations, and assignment.
</figcaption></figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that R uses <code>&lt;-</code> for assignment (right to left), while <code>=</code> is typically used for argument assignment within function calls. Both work for variable assignment, but <code>&lt;-</code> is the conventional R style.</p>
</div>
</div>
</section><section id="sec-vectors" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="sec-vectors">
<span class="header-section-number">7.6</span> Vectors: R’s Fundamental Data Structure</h2>
<p>R thinks in terms of <strong>vectors</strong>—ordered collections of values of the same type. Even a single number is a vector of length 1.</p>
<section id="creating-vectors" class="level3" data-number="7.6.1"><h3 data-number="7.6.1" class="anchored" data-anchor-id="creating-vectors">
<span class="header-section-number">7.6.1</span> Creating Vectors</h3>
<p>The <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function (for “combine” or “concatenate”) creates vectors:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Numeric vector</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>measurements <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>measurements</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;  [1]  2  3  4  2  1  2  4  5 10  8  9</span></span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># Character vector</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"treatment_A"</span>, <span class="st">"treatment_B"</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>samples</span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; [1] "control"     "treatment_A" "treatment_B"</span></span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co"># Logical vector</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>passed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a>passed</span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; [1]  TRUE FALSE  TRUE  TRUE FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sequence-generation" class="level3" data-number="7.6.2"><h3 data-number="7.6.2" class="anchored" data-anchor-id="sequence-generation">
<span class="header-section-number">7.6.2</span> Sequence Generation</h3>
<p>For regular sequences, use shortcuts:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Integer sequence</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Sequence with step</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;  [1]  0.0  0.5  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; [16]  7.5  8.0  8.5  9.0  9.5 10.0</span></span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># Specified length</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; [1] 0.00 0.25 0.50 0.75 1.00</span></span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># Repeated values</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="fu">rep</span>(<span class="st">"A"</span>, <span class="dv">5</span>)</span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; [1] "A" "A" "A" "A" "A"</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; [1] 1 2 1 2 1 2</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt; [1] 1 1 1 2 2 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sorting-vectors" class="level3" data-number="7.6.3"><h3 data-number="7.6.3" class="anchored" data-anchor-id="sorting-vectors">
<span class="header-section-number">7.6.3</span> Sorting Vectors</h3>
<p>The <code><a href="https://rdrr.io/r/base/sort.html">sort()</a></code> function returns a sorted vector:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Sort in ascending order (default)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">3</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">sort</span>(x)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt; [1] 1 2 3 5 8 9</span></span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co"># Sort in descending order</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="fu">sort</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; [1] 9 8 5 3 2 1</span></span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># Sorting character vectors (alphabetical)</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>)</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="fu">sort</span>(genes)</span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; [1] "BRCA1" "EGFR"  "KRAS"  "TP53"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get the indices that would sort a vector (useful for reordering related data), use <code><a href="https://rdrr.io/r/base/order.html">order()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">3</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">order</span>(x)  <span class="co"># Indices: 4th element is smallest, 2nd is next, etc.</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; [1] 4 2 6 1 3 5</span></span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># Use order() to sort one vector by another</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sample_A"</span>, <span class="st">"Sample_B"</span>, <span class="st">"Sample_C"</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a>names[<span class="fu">order</span>(values)]  <span class="co"># Names sorted by values</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; [1] "Sample_B" "Sample_C" "Sample_A"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="vectorized-operations" class="level3" data-number="7.6.4"><h3 data-number="7.6.4" class="anchored" data-anchor-id="vectorized-operations">
<span class="header-section-number">7.6.4</span> Vectorized Operations</h3>
<p>R’s power comes from <strong>vectorized operations</strong>—operations that apply to entire vectors at once:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># Operations apply to each element</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>x <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt;  [1]  4  6  8  4  2  4  8 10 20 16 18</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt;  [1]   4   9  16   4   1   4  16  25 100  64  81</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="fu">log</span>(x)</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt;  [1] 0.6931472 1.0986123 1.3862944 0.6931472 0.0000000 0.6931472 1.3862944</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt;  [8] 1.6094379 2.3025851 2.0794415 2.1972246</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="fu">sqrt</span>(x)</span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;  [1] 1.414214 1.732051 2.000000 1.414214 1.000000 1.414214 2.000000 2.236068</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt;  [9] 3.162278 2.828427 3.000000</span></span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co"># Operations between vectors (element-wise)</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>x <span class="sc">+</span> y</span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt;  [1]  3  5  7  6  6  8 11 13 19 18 20</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>x <span class="sc">*</span> y</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt;  [1]  2  6 12  8  5 12 28 40 90 80 99</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is much faster and cleaner than writing loops!</p>
</section><section id="vector-indexing" class="level3" data-number="7.6.5"><h3 data-number="7.6.5" class="anchored" data-anchor-id="vector-indexing">
<span class="header-section-number">7.6.5</span> Vector Indexing</h3>
<p>Access specific elements using square brackets:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>measurements <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># Single element (1-indexed!)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>measurements[<span class="dv">1</span>]</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>measurements[<span class="dv">5</span>]</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co"># Multiple elements</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>measurements[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)]</span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; [1] 2 4 1</span></span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co"># Range</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>measurements[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; [1] 3 4 2 1</span></span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co"># Negative indices exclude</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>measurements[<span class="sc">-</span><span class="dv">1</span>]          <span class="co"># All but first</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt;  [1]  3  4  2  1  2  4  5 10  8  9</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>measurements[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)]      <span class="co"># All but first three</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; [1]  2  1  2  4  5 10  8  9</span></span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co"># Logical indexing</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>measurements[measurements <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt; [1] 10  8  9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>R uses 1-based indexing! The first element is <code>[1]</code>, not <code>[0]</code> as in Python and most other languages.</p>
</div>
</div>
</section></section><section id="sec-data-types" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="sec-data-types">
<span class="header-section-number">7.7</span> Data Types in R</h2>
<p>R has several fundamental data types:</p>
<div id="tbl-data-types" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.2: R data types
</figcaption><div aria-describedby="tbl-data-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>numeric</code></td>
<td style="text-align: left;">Real numbers (default)</td>
<td style="text-align: left;">
<code>3.14</code>, <code>42</code>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>integer</code></td>
<td style="text-align: left;">Whole numbers</td>
<td style="text-align: left;">
<code>1L</code>, <code>100L</code>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>character</code></td>
<td style="text-align: left;">Text strings</td>
<td style="text-align: left;">
<code>"hello"</code>, <code>"gene1"</code>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logical</code></td>
<td style="text-align: left;">Boolean values</td>
<td style="text-align: left;">
<code>TRUE</code>, <code>FALSE</code>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>factor</code></td>
<td style="text-align: left;">Categorical variables</td>
<td style="text-align: left;">Treatment levels</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Check types with class()</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">class</span>(<span class="fl">3.14</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; [1] "numeric"</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="fu">class</span>(<span class="st">"hello"</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; [1] "character"</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="fu">class</span>(<span class="cn">TRUE</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; [1] "logical"</span></span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co"># Type coercion</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="fu">as.numeric</span>(<span class="st">"42"</span>)</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; [1] 42</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="fu">as.character</span>(<span class="dv">123</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt; [1] "123"</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="fu">as.logical</span>(<span class="dv">0</span>)    <span class="co"># FALSE</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="fu">as.logical</span>(<span class="dv">1</span>)    <span class="co"># TRUE</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="factors" class="level3" data-number="7.7.1"><h3 data-number="7.7.1" class="anchored" data-anchor-id="factors">
<span class="header-section-number">7.7.1</span> Factors</h3>
<p><strong>Factors</strong> are special vectors for representing categorical data with a fixed set of possible values called <strong>levels</strong>. They’re essential for statistical modeling and data analysis in R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Create a factor from a character vector</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"drug_A"</span>, <span class="st">"drug_A"</span>, <span class="st">"control"</span>, <span class="st">"drug_B"</span>, <span class="st">"drug_B"</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>treatment_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(treatment)</span>
<span id="cb15-4"><a href="#cb15-4"></a>treatment_factor</span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; [1] control drug_A  drug_A  control drug_B  drug_B </span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; Levels: control drug_A drug_B</span></span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co"># Check the levels</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="fu">levels</span>(treatment_factor)</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; [1] "control" "drug_A"  "drug_B"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Factor levels are stored <strong>alphabetically</strong> by default, regardless of the order they appear in your data. This affects how results are displayed and can impact statistical analyses (e.g., the reference level in regression models).</p>
</div>
</div>
<p>To specify a custom level order, use the <code>levels</code> argument:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Custom level order</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>treatment_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb16-3"><a href="#cb16-3"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"drug_A"</span>, <span class="st">"drug_B"</span>))</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="fu">levels</span>(treatment_ordered)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; [1] "control" "drug_A"  "drug_B"</span></span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co"># This matters for plotting and statistical models</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co"># where "control" should be the reference level</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Factors are memory-efficient because they store unique levels once and use integer indices to reference them. Use <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> to see this internal representation:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">str</span>(treatment_factor)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt;  Factor w/ 3 levels "control","drug_A",..: 1 2 2 1 3 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="special-values" class="level3" data-number="7.7.2"><h3 data-number="7.7.2" class="anchored" data-anchor-id="special-values">
<span class="header-section-number">7.7.2</span> Special Values</h3>
<p>R has special values for missing data and undefined results:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Missing value</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="cn">NA</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co"># Not a number (undefined)</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="dv">0</span><span class="sc">/</span><span class="dv">0</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt; [1] NaN</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="fu">log</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; [1] NaN</span></span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co"># Infinity</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt; [1] Inf</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt; [1] -Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Handling <code>NA</code> values is a common task in data analysis.</p>
</section><section id="logical-operators-and-comparisons" class="level3" data-number="7.7.3"><h3 data-number="7.7.3" class="anchored" data-anchor-id="logical-operators-and-comparisons">
<span class="header-section-number">7.7.3</span> Logical Operators and Comparisons</h3>
<p>R provides a rich set of operators for logical comparisons and Boolean operations:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Comparison operators</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="dv">5</span> <span class="sc">&gt;</span> <span class="dv">3</span>     <span class="co"># Greater than</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="dv">5</span> <span class="sc">&lt;</span> <span class="dv">3</span>     <span class="co"># Less than</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="dv">5</span> <span class="sc">&gt;=</span> <span class="dv">5</span>    <span class="co"># Greater than or equal</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="dv">5</span> <span class="sc">&lt;=</span> <span class="dv">5</span>    <span class="co"># Less than or equal</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="dv">5</span> <span class="sc">==</span> <span class="dv">5</span>    <span class="co"># Equal (note: two equals signs!)</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="dv">5</span> <span class="sc">!=</span> <span class="dv">3</span>    <span class="co"># Not equal</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb19-14"><a href="#cb19-14"></a></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co"># Logical operators</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">FALSE</span>   <span class="co"># AND</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="cn">TRUE</span> <span class="sc">|</span> <span class="cn">FALSE</span>   <span class="co"># OR</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="sc">!</span><span class="cn">TRUE</span>          <span class="co"># NOT</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb19-22"><a href="#cb19-22"></a></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co"># Vectorized logical operations</span></span>
<span id="cb19-24"><a href="#cb19-24"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)</span>
<span id="cb19-25"><a href="#cb19-25"></a>x <span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">18</span>   <span class="co"># Both conditions must be true</span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co">#&gt; [1] FALSE FALSE  TRUE  TRUE FALSE</span></span>
<span id="cb19-27"><a href="#cb19-27"></a>x <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">15</span>   <span class="co"># Either condition can be true</span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co">#&gt; [1]  TRUE FALSE FALSE FALSE  TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>%in%</code> operator is particularly useful for checking membership in a set:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Check if values are in a set</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>target_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TP53"</span>, <span class="st">"EGFR"</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a>genes <span class="sc">%in%</span> target_genes</span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt; [1] FALSE  TRUE  TRUE FALSE</span></span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co"># Useful for subsetting</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>genes[genes <span class="sc">%in%</span> target_genes]</span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#&gt; [1] "TP53" "EGFR"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="finding-indices-with-which" class="level3" data-number="7.7.4"><h3 data-number="7.7.4" class="anchored" data-anchor-id="finding-indices-with-which">
<span class="header-section-number">7.7.4</span> Finding Indices with <code>which()</code>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/which.html">which()</a></code> function returns the indices where a logical condition is TRUE—useful when you need positions rather than values:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">25</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co"># Find indices where condition is TRUE</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="fu">which</span>(x <span class="sc">&gt;</span> <span class="dv">12</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">#&gt; [1] 3 4 6</span></span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co"># Get the values at those positions</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>x[<span class="fu">which</span>(x <span class="sc">&gt;</span> <span class="dv">12</span>)]</span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co">#&gt; [1] 20 15 25</span></span>
<span id="cb21-10"><a href="#cb21-10"></a></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co"># Find the index of the maximum value</span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="fu">which.max</span>(x)</span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb21-14"><a href="#cb21-14"></a></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="co"># Find the index of the minimum value</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="fu">which.min</span>(x)</span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="co"># Find indices of specific values</span></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="fu">which</span>(x <span class="sc">==</span> <span class="dv">15</span>)</span>
<span id="cb21-21"><a href="#cb21-21"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb21-22"><a href="#cb21-22"></a></span>
<span id="cb21-23"><a href="#cb21-23"></a><span class="co"># Practical example: find which samples exceed a threshold</span></span>
<span id="cb21-24"><a href="#cb21-24"></a>expression_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">8.1</span>, <span class="fl">4.2</span>, <span class="fl">12.3</span>, <span class="fl">6.7</span>, <span class="fl">15.2</span>)</span>
<span id="cb21-25"><a href="#cb21-25"></a>high_expression <span class="ot">&lt;-</span> <span class="fu">which</span>(expression_levels <span class="sc">&gt;</span> <span class="dv">10</span>)</span>
<span id="cb21-26"><a href="#cb21-26"></a>high_expression  <span class="co"># Indices 4 and 6</span></span>
<span id="cb21-27"><a href="#cb21-27"></a><span class="co">#&gt; [1] 4 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>While <code><a href="https://rdrr.io/r/base/which.html">which()</a></code> is useful, you often don’t need it—logical vectors work directly for subsetting:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># These are equivalent:</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>x[<span class="fu">which</span>(x <span class="sc">&gt;</span> <span class="dv">12</span>)]</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt; [1] 20 15 25</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>x[x <span class="sc">&gt;</span> <span class="dv">12</span>]</span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; [1] 20 15 25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code><a href="https://rdrr.io/r/base/which.html">which()</a></code> when you specifically need the index positions (e.g., to report which samples, to use in loops, or for <code><a href="https://rdrr.io/r/base/which.min.html">which.max()</a></code>/<code><a href="https://rdrr.io/r/base/which.min.html">which.min()</a></code>).</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Operator Precedence">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Operator Precedence
</div>
</div>
<div class="callout-body-container callout-body">
<p>R evaluates operators in a specific order. From highest to lowest precedence:</p>
<ol type="1">
<li>
<code>^</code> (exponentiation)</li>
<li>
<code>-</code> (unary minus, for negation)</li>
<li>
<code>:</code> (sequence)</li>
<li>
<code>%any%</code> (special operators like <code>%%</code>, <code>%/%</code>, <code>%in%</code>)</li>
<li>
<code>*</code>, <code>/</code> (multiplication, division)</li>
<li>
<code>+</code>, <code>-</code> (addition, subtraction)</li>
<li>
<code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code> (comparisons)</li>
<li>
<code>!</code> (logical NOT)</li>
<li>
<code>&amp;</code>, <code>&amp;&amp;</code> (logical AND)</li>
<li>
<code>|</code>, <code>||</code> (logical OR)</li>
<li>
<code>&lt;-</code>, <code>=</code> (assignment)</li>
</ol>
<p>Use parentheses to make your intentions clear and avoid unexpected results.</p>
</div>
</div>
</section><section id="floating-point-precision" class="level3" data-number="7.7.5"><h3 data-number="7.7.5" class="anchored" data-anchor-id="floating-point-precision">
<span class="header-section-number">7.7.5</span> Floating-Point Precision</h3>
<p>A common source of confusion involves floating-point arithmetic. Computers represent decimal numbers with limited precision, which can lead to unexpected results:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># This seems wrong, but is due to floating-point representation</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">==</span> <span class="fl">0.3</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co"># See the actual values</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="fu">print</span>(<span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">digits =</span> <span class="dv">20</span>)</span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt; [1] 0.30000000000000004441</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="fu">print</span>(<span class="fl">0.3</span>, <span class="at">digits =</span> <span class="dv">20</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#&gt; [1] 0.2999999999999999889</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Instead of using <code>==</code> for floating-point comparisons, use <code><a href="https://rdrr.io/r/base/all.equal.html">all.equal()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Safe comparison for floating-point numbers</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">all.equal</span>(<span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># Returns TRUE if values are nearly equal (within tolerance)</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="fu">isTRUE</span>(<span class="fu">all.equal</span>(<span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="fl">0.3</span>))</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co"># You can also specify a tolerance</span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="fu">all.equal</span>(<span class="fl">1.0</span>, <span class="fl">1.0001</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Always use <code><a href="https://rdrr.io/r/base/all.equal.html">all.equal()</a></code> or check if the difference is within an acceptable tolerance when comparing floating-point numbers. Never rely on <code>==</code> for exact equality of decimal calculations.</p>
</div>
</div>
</section><section id="using-dplyrnear-for-comparisons" class="level3" data-number="7.7.6"><h3 data-number="7.7.6" class="anchored" data-anchor-id="using-dplyrnear-for-comparisons">
<span class="header-section-number">7.7.6</span> Using <code>dplyr::near()</code> for Comparisons</h3>
<p>The tidyverse provides <code><a href="https://dplyr.tidyverse.org/reference/near.html">dplyr::near()</a></code> as a convenient alternative for checking near-equality, especially when working with data frames:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co"># near() returns TRUE for values within a small tolerance</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="fu">near</span>(<span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="co"># Works well in filter() and mutate()</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>))</span>
<span id="cb25-9"><a href="#cb25-9"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">near</span>(x, <span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.3</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co"># You can specify a custom tolerance</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="fu">near</span>(<span class="fl">1.0</span>, <span class="fl">1.001</span>, <span class="at">tol =</span> <span class="fl">0.01</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>near()</code> when filtering or comparing numeric columns in data frames, and <code><a href="https://rdrr.io/r/base/all.equal.html">all.equal()</a></code> when you need detailed comparison information.</p>
</section></section><section id="sec-r-functions" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="sec-r-functions">
<span class="header-section-number">7.8</span> Functions</h2>
<p>Functions perform operations on inputs and return outputs. R has thousands of built-in functions.</p>
<section id="using-functions" class="level3" data-number="7.8.1"><h3 data-number="7.8.1" class="anchored" data-anchor-id="using-functions">
<span class="header-section-number">7.8.1</span> Using Functions</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co"># Basic statistical functions</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="fu">mean</span>(x)</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co">#&gt; [1] 5.5</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="fu">median</span>(x)</span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co">#&gt; [1] 5.5</span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="fu">sd</span>(x)        <span class="co"># Standard deviation</span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co">#&gt; [1] 3.02765</span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="fu">var</span>(x)       <span class="co"># Variance</span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">#&gt; [1] 9.166667</span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="fu">sum</span>(x)</span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">#&gt; [1] 55</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="fu">length</span>(x)</span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="co">#&gt; [1] 10</span></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="fu">min</span>(x)</span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="fu">max</span>(x)</span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="co">#&gt; [1] 10</span></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="fu">range</span>(x)     <span class="co"># Returns min and max</span></span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="co">#&gt; [1]  1 10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="function-arguments" class="level3" data-number="7.8.2"><h3 data-number="7.8.2" class="anchored" data-anchor-id="function-arguments">
<span class="header-section-number">7.8.2</span> Function Arguments</h3>
<p>Functions take arguments that modify their behavior:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Round to 2 decimal places</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">round</span>(<span class="fl">3.14159</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt; [1] 3.14</span></span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co"># Sample with replacement</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">#&gt; [1] 10  5  4  4 10</span></span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co"># Mean with NA handling</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="fu">mean</span>(values)              <span class="co"># Returns NA</span></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="fu">mean</span>(values, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Removes NA first</span></span>
<span id="cb28-14"><a href="#cb28-14"></a><span class="co">#&gt; [1] 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="argument-order-and-naming" class="level4"><h4 class="anchored" data-anchor-id="argument-order-and-naming">Argument Order and Naming</h4>
<p>R functions expect arguments in a specific order. When you don’t name arguments, R matches them by position:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># These are equivalent - arguments matched by position</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">10</span>)  <span class="co"># n, mean, sd</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>x1</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co">#&gt; [1] 13.709584 -5.646982  3.631284  6.328626  4.042683</span></span>
<span id="cb29-6"><a href="#cb29-6"></a></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="co"># Named arguments can be in any order</span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb29-9"><a href="#cb29-9"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">sd =</span> <span class="dv">10</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a>x2</span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="co">#&gt; [1] 13.709584 -5.646982  3.631284  6.328626  4.042683</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Relying on position order can lead to subtle bugs. If you accidentally swap arguments, you may get unexpected results without any error message:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Oops! We meant 1000 samples with mean=0 and sd=10</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co"># But we got 10 samples with mean=1000 and sd=0</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>wrong <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">1000</span>, <span class="dv">0</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>wrong  <span class="co"># All identical values!</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co">#&gt;  [1] 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When in doubt, name your arguments explicitly for clarity and safety.</p>
</div>
</div>
</section></section><section id="nesting-functions" class="level3" data-number="7.8.3"><h3 data-number="7.8.3" class="anchored" data-anchor-id="nesting-functions">
<span class="header-section-number">7.8.3</span> Nesting Functions</h3>
<p>One powerful feature of R is the ability to <strong>nest</strong> function calls—using the output of one function as the input to another without creating intermediate variables:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Without nesting: create intermediate objects</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a>result1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(z)</span>
<span id="cb31-4"><a href="#cb31-4"></a>result1</span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">#&gt; [1] 20</span></span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co"># With nesting: more concise</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>result2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>))</span>
<span id="cb31-9"><a href="#cb31-9"></a>result2</span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co">#&gt; [1] 20</span></span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="co"># More complex nesting</span></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="co"># Calculate the mean of the square roots of 1 through 10</span></span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="fu">mean</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="co">#&gt; [1] 2.246828</span></span>
<span id="cb31-16"><a href="#cb31-16"></a></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="co"># Nested functions are evaluated from inside out</span></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">sqrt</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">25</span>))), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="co">#&gt; [1] 3.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nesting makes code more compact, but deeply nested expressions can become hard to read. As a rule of thumb, if you find yourself nesting more than 2-3 functions, consider breaking the expression into steps or using the pipe operator (covered in the tidyverse chapter).</p>
</section><section id="getting-help" class="level3" data-number="7.8.4"><h3 data-number="7.8.4" class="anchored" data-anchor-id="getting-help">
<span class="header-section-number">7.8.4</span> Getting Help</h3>
<p>R has excellent built-in documentation:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Get help on a function</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>?mean</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="fu">help</span>(mean)</span>
<span id="cb32-4"><a href="#cb32-4"></a></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co"># Search help</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="fu">help.search</span>(<span class="st">"correlation"</span>)</span>
<span id="cb32-7"><a href="#cb32-7"></a>??correlation</span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="co"># See function arguments</span></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="fu">args</span>(mean)</span>
<span id="cb32-11"><a href="#cb32-11"></a></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="co"># See examples</span></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="fu">example</span>(mean)</span>
<span id="cb32-14"><a href="#cb32-14"></a></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="co"># Find functions containing a string in their name</span></span>
<span id="cb32-16"><a href="#cb32-16"></a><span class="fu">apropos</span>(<span class="st">"mean"</span>)  <span class="co"># Returns: "colMeans", "mean", "mean.Date", etc.</span></span>
<span id="cb32-17"><a href="#cb32-17"></a></span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="co"># Find functions by partial name matching</span></span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="fu">apropos</span>(<span class="st">"cor"</span>)   <span class="co"># Returns all functions containing "cor"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="vignettes-and-demos" class="level4"><h4 class="anchored" data-anchor-id="vignettes-and-demos">Vignettes and Demos</h4>
<p>Beyond function-level help, packages often include <strong>vignettes</strong>—comprehensive tutorials that demonstrate how to use the package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># List all available vignettes</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="fu">vignette</span>()</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># List vignettes for a specific package</span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="fu">vignette</span>(<span class="at">package =</span> <span class="st">"dplyr"</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co"># Open a specific vignette</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="fu">vignette</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb33-9"><a href="#cb33-9"></a></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co"># Browse vignettes in your browser</span></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="fu">browseVignettes</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some packages also include <strong>demos</strong>—interactive demonstrations of functionality:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># List all available demos</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">demo</span>()</span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co"># Run a specific demo</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="fu">demo</span>(graphics)    <span class="co"># Base R graphics demonstration</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Vignettes are often the best place to start when learning a new package. They provide context and workflows that function documentation alone cannot convey.</p>
</div>
</div>
<p>The help page structure:</p>
<ul>
<li>
<strong>Description</strong>: What the function does</li>
<li>
<strong>Usage</strong>: Function syntax</li>
<li>
<strong>Arguments</strong>: What inputs it accepts</li>
<li>
<strong>Value</strong>: What it returns</li>
<li>
<strong>Examples</strong>: Working code examples</li>
</ul></section></section></section><section id="sec-packages" class="level2" data-number="7.9"><h2 data-number="7.9" class="anchored" data-anchor-id="sec-packages">
<span class="header-section-number">7.9</span> Installing and Loading Packages</h2>
<p>Base R includes dozens of useful functions, but as you become a more advanced R user, you’ll need functions for specialized analyses. Fortunately, thousands of additional functions are distributed in the form of R <strong>packages</strong>.</p>
<section id="installing-packages" class="level3" data-number="7.9.1"><h3 data-number="7.9.1" class="anchored" data-anchor-id="installing-packages">
<span class="header-section-number">7.9.1</span> Installing Packages</h3>
<p>Packages from the Comprehensive R Archive Network (CRAN) are easy to install:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Install a package from CRAN</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co"># Install multiple packages at once</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"ggplot2"</span>, <span class="st">"readr"</span>, <span class="st">"tidyr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Package names are case-sensitive and must be in quotation marks when installing. You only need to install a package once on your system.</p>
</div>
</div>
</section><section id="loading-packages" class="level3" data-number="7.9.2"><h3 data-number="7.9.2" class="anchored" data-anchor-id="loading-packages">
<span class="header-section-number">7.9.2</span> Loading Packages</h3>
<p>To use functions from an installed package, you must load it into your current session:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Load a package</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co"># Check if a package is installed</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="fu">installed.packages</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Unlike installation, you need to call <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> every time you start a new R session. Note that you don’t need quotation marks with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s good practice to load all required packages at the beginning of your script. This makes dependencies clear and helps others reproduce your work.</p>
</div>
</div>
</section><section id="namespace-conflicts" class="level3" data-number="7.9.3"><h3 data-number="7.9.3" class="anchored" data-anchor-id="namespace-conflicts">
<span class="header-section-number">7.9.3</span> Namespace Conflicts</h3>
<p>When you load multiple packages, function names can collide. The most recently loaded package “wins,” masking functions from earlier packages:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># Loading dplyr after another package</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="fu">library</span>(MASS)</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co"># Warning: The following object is masked from 'package:MASS': select</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When conflicts occur, you have several options:</p>
<p><strong>1. Use the package prefix (recommended)</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># Explicitly specify which package's function to use</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(data, column1, column2)</span>
<span id="cb38-3"><a href="#cb38-3"></a>MASS<span class="sc">::</span><span class="fu">select</span>(object)</span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co"># This works even without loading the package</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>stats<span class="sc">::</span><span class="fu">filter</span>(x, <span class="at">method =</span> <span class="st">"convolution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>2. Control loading order</strong></p>
<p>Load packages with conflicting names in the order that gives you the default behavior you want.</p>
<p><strong>3. Use the <code>conflicted</code> package</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Install and load conflicted</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">install.packages</span>(<span class="st">"conflicted"</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb39-4"><a href="#cb39-4"></a></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co"># Now conflicts cause errors instead of silent masking</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="co"># You must explicitly choose which function to use:</span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="fu">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="fu">conflict_prefer</span>(<span class="st">"select"</span>, <span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> and <code><a href="https://rdrr.io/r/stats/lag.html">lag()</a></code> functions from dplyr commonly conflict with base R’s <code><a href="https://rdrr.io/r/stats/filter.html">stats::filter()</a></code> and <code><a href="https://rdrr.io/r/stats/lag.html">stats::lag()</a></code>. If your filtering code suddenly stops working, namespace conflicts are often the culprit.</p>
</div>
</div>
</section></section><section id="sec-data-frames" class="level2" data-number="7.10"><h2 data-number="7.10" class="anchored" data-anchor-id="sec-data-frames">
<span class="header-section-number">7.10</span> Data Frames</h2>
<p><strong>Data frames</strong> are R’s workhorse for tabular data—think spreadsheets or database tables. Each column is a vector, and columns can have different types.</p>
<section id="creating-data-frames" class="level3" data-number="7.10.1"><h3 data-number="7.10.1" class="anchored" data-anchor-id="creating-data-frames">
<span class="header-section-number">7.10.1</span> Creating Data Frames</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Create vectors</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>sample_id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span>, <span class="st">"S5"</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"drug_A"</span>, <span class="st">"drug_A"</span>, <span class="st">"drug_B"</span>, <span class="st">"drug_B"</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a>concentration <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb40-5"><a href="#cb40-5"></a>response <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">5.6</span>, <span class="fl">2.8</span>, <span class="fl">4.1</span>)</span>
<span id="cb40-6"><a href="#cb40-6"></a></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="co"># Combine into data frame</span></span>
<span id="cb40-8"><a href="#cb40-8"></a>experiment <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-9"><a href="#cb40-9"></a>  <span class="at">sample_id =</span> sample_id,</span>
<span id="cb40-10"><a href="#cb40-10"></a>  <span class="at">treatment =</span> treatment,</span>
<span id="cb40-11"><a href="#cb40-11"></a>  <span class="at">concentration =</span> concentration,</span>
<span id="cb40-12"><a href="#cb40-12"></a>  <span class="at">response =</span> response</span>
<span id="cb40-13"><a href="#cb40-13"></a>)</span>
<span id="cb40-14"><a href="#cb40-14"></a></span>
<span id="cb40-15"><a href="#cb40-15"></a>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">control</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">5.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">S4</td>
<td style="text-align: left;">drug_B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5</td>
<td style="text-align: left;">drug_B</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="examining-data-frames" class="level3" data-number="7.10.2"><h3 data-number="7.10.2" class="anchored" data-anchor-id="examining-data-frames">
<span class="header-section-number">7.10.2</span> Examining Data Frames</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Structure</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="fu">str</span>(experiment)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">#&gt; 'data.frame':    5 obs. of  4 variables:</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="co">#&gt;  $ sample_id    : chr  "S1" "S2" "S3" "S4" ...</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co">#&gt;  $ treatment    : chr  "control" "drug_A" "drug_A" "drug_B" ...</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="co">#&gt;  $ concentration: num  0 10 20 10 20</span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co">#&gt;  $ response     : num  1.2 3.4 5.6 2.8 4.1</span></span>
<span id="cb41-8"><a href="#cb41-8"></a></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="co"># Dimensions</span></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="fu">dim</span>(experiment)</span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="co">#&gt; [1] 5 4</span></span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="fu">nrow</span>(experiment)</span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="fu">ncol</span>(experiment)</span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb41-16"><a href="#cb41-16"></a></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="co"># Preview</span></span>
<span id="cb41-18"><a href="#cb41-18"></a><span class="fu">head</span>(experiment, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">control</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">5.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">tail</span>(experiment, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">S4</td>
<td style="text-align: left;">drug_B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">S5</td>
<td style="text-align: left;">drug_B</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co"># Summary statistics</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="fu">summary</span>(experiment)</span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="co">#&gt;   sample_id          treatment         concentration    response   </span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co">#&gt;  Length:5           Length:5           Min.   : 0    Min.   :1.20  </span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="co">#&gt;  Class :character   Class :character   1st Qu.:10    1st Qu.:2.80  </span></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co">#&gt;  Mode  :character   Mode  :character   Median :10    Median :3.40  </span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co">#&gt;                                        Mean   :12    Mean   :3.42  </span></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">#&gt;                                        3rd Qu.:20    3rd Qu.:4.10  </span></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co">#&gt;                                        Max.   :20    Max.   :5.60</span></span>
<span id="cb43-11"><a href="#cb43-11"></a></span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="co"># Column names</span></span>
<span id="cb43-13"><a href="#cb43-13"></a><span class="fu">names</span>(experiment)</span>
<span id="cb43-14"><a href="#cb43-14"></a><span class="co">#&gt; [1] "sample_id"     "treatment"     "concentration" "response"</span></span>
<span id="cb43-15"><a href="#cb43-15"></a><span class="fu">colnames</span>(experiment)</span>
<span id="cb43-16"><a href="#cb43-16"></a><span class="co">#&gt; [1] "sample_id"     "treatment"     "concentration" "response"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In RStudio, you can also use <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> to open a spreadsheet-like viewer for interactive exploration:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># Opens data in a viewer pane (RStudio only)</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">View</span>(experiment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> is useful for quick inspection, but avoid using it in scripts meant for non-interactive execution. For large datasets, <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> can be slow—use <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> instead.</p>
</div>
</div>
</section><section id="accessing-data-frame-elements" class="level3" data-number="7.10.3"><h3 data-number="7.10.3" class="anchored" data-anchor-id="accessing-data-frame-elements">
<span class="header-section-number">7.10.3</span> Accessing Data Frame Elements</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Single column (returns vector)</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>experiment<span class="sc">$</span>response</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co">#&gt; [1] 1.2 3.4 5.6 2.8 4.1</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>experiment[[<span class="st">"response"</span>]]</span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="co">#&gt; [1] 1.2 3.4 5.6 2.8 4.1</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>experiment[, <span class="st">"response"</span>]</span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="co">#&gt; [1] 1.2 3.4 5.6 2.8 4.1</span></span>
<span id="cb45-8"><a href="#cb45-8"></a></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="co"># Multiple columns</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>experiment[, <span class="fu">c</span>(<span class="st">"sample_id"</span>, <span class="st">"response"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">sample_id</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: right;">3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: right;">5.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">S4</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5</td>
<td style="text-align: right;">4.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="co"># Rows by index</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>experiment[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">control</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.2</td>
</tr></tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>experiment[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">control</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">5.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="co"># Combination</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>experiment[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">"treatment"</span>, <span class="st">"response"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">control</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">5.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="co"># Conditional selection</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>experiment[experiment<span class="sc">$</span>treatment <span class="sc">==</span> <span class="st">"drug_A"</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">S2</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">S3</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">5.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>experiment[experiment<span class="sc">$</span>response <span class="sc">&gt;</span> <span class="dv">3</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">S2</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">S3</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">S5</td>
<td style="text-align: left;">drug_B</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="adding-and-modifying-columns" class="level3" data-number="7.10.4"><h3 data-number="7.10.4" class="anchored" data-anchor-id="adding-and-modifying-columns">
<span class="header-section-number">7.10.4</span> Adding and Modifying Columns</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Add a new column</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>experiment<span class="sc">$</span>replicate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a></span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="co"># Calculated column</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>experiment<span class="sc">$</span>log_response <span class="ot">&lt;-</span> <span class="fu">log</span>(experiment<span class="sc">$</span>response)</span>
<span id="cb51-6"><a href="#cb51-6"></a></span>
<span id="cb51-7"><a href="#cb51-7"></a>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 21%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 19%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">concentration</th>
<th style="text-align: right;">response</th>
<th style="text-align: right;">replicate</th>
<th style="text-align: right;">log_response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">control</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.1823216</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.2237754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">drug_A</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.7227666</td>
</tr>
<tr class="even">
<td style="text-align: left;">S4</td>
<td style="text-align: left;">drug_B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0296194</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5</td>
<td style="text-align: left;">drug_B</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.4109870</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section></section><section id="sec-lists" class="level2" data-number="7.11"><h2 data-number="7.11" class="anchored" data-anchor-id="sec-lists">
<span class="header-section-number">7.11</span> Lists</h2>
<p><strong>Lists</strong> are flexible containers that can hold objects of different types and lengths. Unlike vectors, which require all elements to be the same type, lists can contain a mix of vectors, data frames, or even other lists.</p>
<section id="creating-lists" class="level3" data-number="7.11.1"><h3 data-number="7.11.1" class="anchored" data-anchor-id="creating-lists">
<span class="header-section-number">7.11.1</span> Creating Lists</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># Create individual vectors</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>measurements <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>)</span>
<span id="cb52-3"><a href="#cb52-3"></a>categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"low"</span>)</span>
<span id="cb52-4"><a href="#cb52-4"></a>status <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"active"</span>, <span class="st">"inactive"</span>))</span>
<span id="cb52-5"><a href="#cb52-5"></a></span>
<span id="cb52-6"><a href="#cb52-6"></a><span class="co"># Combine into a list</span></span>
<span id="cb52-7"><a href="#cb52-7"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb52-8"><a href="#cb52-8"></a>  <span class="at">values =</span> measurements,</span>
<span id="cb52-9"><a href="#cb52-9"></a>  <span class="at">labels =</span> categories,</span>
<span id="cb52-10"><a href="#cb52-10"></a>  <span class="at">status =</span> status</span>
<span id="cb52-11"><a href="#cb52-11"></a>)</span>
<span id="cb52-12"><a href="#cb52-12"></a></span>
<span id="cb52-13"><a href="#cb52-13"></a>my_list</span>
<span id="cb52-14"><a href="#cb52-14"></a><span class="co">#&gt; $values</span></span>
<span id="cb52-15"><a href="#cb52-15"></a><span class="co">#&gt; [1] 10 20 30 40 50</span></span>
<span id="cb52-16"><a href="#cb52-16"></a><span class="co">#&gt; </span></span>
<span id="cb52-17"><a href="#cb52-17"></a><span class="co">#&gt; $labels</span></span>
<span id="cb52-18"><a href="#cb52-18"></a><span class="co">#&gt; [1] "high"   "medium" "low"   </span></span>
<span id="cb52-19"><a href="#cb52-19"></a><span class="co">#&gt; </span></span>
<span id="cb52-20"><a href="#cb52-20"></a><span class="co">#&gt; $status</span></span>
<span id="cb52-21"><a href="#cb52-21"></a><span class="co">#&gt; [1] active   inactive</span></span>
<span id="cb52-22"><a href="#cb52-22"></a><span class="co">#&gt; Levels: active inactive</span></span>
<span id="cb52-23"><a href="#cb52-23"></a></span>
<span id="cb52-24"><a href="#cb52-24"></a><span class="co"># Check the structure</span></span>
<span id="cb52-25"><a href="#cb52-25"></a><span class="fu">str</span>(my_list)</span>
<span id="cb52-26"><a href="#cb52-26"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb52-27"><a href="#cb52-27"></a><span class="co">#&gt;  $ values: num [1:5] 10 20 30 40 50</span></span>
<span id="cb52-28"><a href="#cb52-28"></a><span class="co">#&gt;  $ labels: chr [1:3] "high" "medium" "low"</span></span>
<span id="cb52-29"><a href="#cb52-29"></a><span class="co">#&gt;  $ status: Factor w/ 2 levels "active","inactive": 1 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="indexing-lists" class="level3" data-number="7.11.2"><h3 data-number="7.11.2" class="anchored" data-anchor-id="indexing-lists">
<span class="header-section-number">7.11.2</span> Indexing Lists</h3>
<p>Lists use double square brackets <code>[[]]</code> to access individual elements:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># Access by position</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>my_list[[<span class="dv">1</span>]]</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="co">#&gt; [1] 10 20 30 40 50</span></span>
<span id="cb53-4"><a href="#cb53-4"></a></span>
<span id="cb53-5"><a href="#cb53-5"></a><span class="co"># Access by name</span></span>
<span id="cb53-6"><a href="#cb53-6"></a>my_list[[<span class="st">"labels"</span>]]</span>
<span id="cb53-7"><a href="#cb53-7"></a><span class="co">#&gt; [1] "high"   "medium" "low"</span></span>
<span id="cb53-8"><a href="#cb53-8"></a></span>
<span id="cb53-9"><a href="#cb53-9"></a><span class="co"># Access using $ notation</span></span>
<span id="cb53-10"><a href="#cb53-10"></a>my_list<span class="sc">$</span>values</span>
<span id="cb53-11"><a href="#cb53-11"></a><span class="co">#&gt; [1] 10 20 30 40 50</span></span>
<span id="cb53-12"><a href="#cb53-12"></a></span>
<span id="cb53-13"><a href="#cb53-13"></a><span class="co"># Access element within a list component</span></span>
<span id="cb53-14"><a href="#cb53-14"></a>my_list[[<span class="dv">1</span>]][<span class="dv">3</span>]  <span class="co"># Third element of first component</span></span>
<span id="cb53-15"><a href="#cb53-15"></a><span class="co">#&gt; [1] 30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Single brackets <code>[]</code> return a sublist, while double brackets <code>[[]]</code> extract the actual element. This distinction matters when working with list components.</p>
</div>
</div>
</section></section><section id="sec-matrices" class="level2" data-number="7.12"><h2 data-number="7.12" class="anchored" data-anchor-id="sec-matrices">
<span class="header-section-number">7.12</span> Matrices</h2>
<p><strong>Matrices</strong> are two-dimensional arrays where all elements must be the same type. Unlike data frames, matrices don’t have named columns by default and are optimized for mathematical operations.</p>
<section id="creating-matrices" class="level3" data-number="7.12.1"><h3 data-number="7.12.1" class="anchored" data-anchor-id="creating-matrices">
<span class="header-section-number">7.12.1</span> Creating Matrices</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># Create a matrix from a vector</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a>mat</span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb54-5"><a href="#cb54-5"></a><span class="co">#&gt; [1,]    1    4    7   10</span></span>
<span id="cb54-6"><a href="#cb54-6"></a><span class="co">#&gt; [2,]    2    5    8   11</span></span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="co">#&gt; [3,]    3    6    9   12</span></span>
<span id="cb54-8"><a href="#cb54-8"></a></span>
<span id="cb54-9"><a href="#cb54-9"></a><span class="co"># Create with row-wise filling</span></span>
<span id="cb54-10"><a href="#cb54-10"></a><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-11"><a href="#cb54-11"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb54-12"><a href="#cb54-12"></a><span class="co">#&gt; [1,]    1    2    3    4</span></span>
<span id="cb54-13"><a href="#cb54-13"></a><span class="co">#&gt; [2,]    5    6    7    8</span></span>
<span id="cb54-14"><a href="#cb54-14"></a><span class="co">#&gt; [3,]    9   10   11   12</span></span>
<span id="cb54-15"><a href="#cb54-15"></a></span>
<span id="cb54-16"><a href="#cb54-16"></a><span class="co"># From vectors using cbind (column bind) or rbind (row bind)</span></span>
<span id="cb54-17"><a href="#cb54-17"></a>col1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb54-18"><a href="#cb54-18"></a>col2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb54-19"><a href="#cb54-19"></a><span class="fu">cbind</span>(col1, col2)</span>
<span id="cb54-20"><a href="#cb54-20"></a><span class="co">#&gt;      col1 col2</span></span>
<span id="cb54-21"><a href="#cb54-21"></a><span class="co">#&gt; [1,]    1    4</span></span>
<span id="cb54-22"><a href="#cb54-22"></a><span class="co">#&gt; [2,]    2    5</span></span>
<span id="cb54-23"><a href="#cb54-23"></a><span class="co">#&gt; [3,]    3    6</span></span>
<span id="cb54-24"><a href="#cb54-24"></a></span>
<span id="cb54-25"><a href="#cb54-25"></a><span class="fu">rbind</span>(col1, col2)</span>
<span id="cb54-26"><a href="#cb54-26"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb54-27"><a href="#cb54-27"></a><span class="co">#&gt; col1    1    2    3</span></span>
<span id="cb54-28"><a href="#cb54-28"></a><span class="co">#&gt; col2    4    5    6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="matrix-operations" class="level3" data-number="7.12.2"><h3 data-number="7.12.2" class="anchored" data-anchor-id="matrix-operations">
<span class="header-section-number">7.12.2</span> Matrix Operations</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># Dimensions</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="fu">dim</span>(mat)</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="co">#&gt; [1] 3 4</span></span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="fu">nrow</span>(mat)</span>
<span id="cb55-5"><a href="#cb55-5"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="fu">ncol</span>(mat)</span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb55-8"><a href="#cb55-8"></a></span>
<span id="cb55-9"><a href="#cb55-9"></a><span class="co"># Transpose (swap rows and columns)</span></span>
<span id="cb55-10"><a href="#cb55-10"></a><span class="fu">t</span>(mat)</span>
<span id="cb55-11"><a href="#cb55-11"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb55-12"><a href="#cb55-12"></a><span class="co">#&gt; [1,]    1    2    3</span></span>
<span id="cb55-13"><a href="#cb55-13"></a><span class="co">#&gt; [2,]    4    5    6</span></span>
<span id="cb55-14"><a href="#cb55-14"></a><span class="co">#&gt; [3,]    7    8    9</span></span>
<span id="cb55-15"><a href="#cb55-15"></a><span class="co">#&gt; [4,]   10   11   12</span></span>
<span id="cb55-16"><a href="#cb55-16"></a></span>
<span id="cb55-17"><a href="#cb55-17"></a><span class="co"># Indexing: [row, column]</span></span>
<span id="cb55-18"><a href="#cb55-18"></a>mat[<span class="dv">1</span>, <span class="dv">2</span>]      <span class="co"># First row, second column</span></span>
<span id="cb55-19"><a href="#cb55-19"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb55-20"><a href="#cb55-20"></a>mat[<span class="dv">1</span>, ]       <span class="co"># Entire first row</span></span>
<span id="cb55-21"><a href="#cb55-21"></a><span class="co">#&gt; [1]  1  4  7 10</span></span>
<span id="cb55-22"><a href="#cb55-22"></a>mat[, <span class="dv">2</span>]       <span class="co"># Entire second column</span></span>
<span id="cb55-23"><a href="#cb55-23"></a><span class="co">#&gt; [1] 4 5 6</span></span>
<span id="cb55-24"><a href="#cb55-24"></a>mat[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]  <span class="co"># Submatrix</span></span>
<span id="cb55-25"><a href="#cb55-25"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb55-26"><a href="#cb55-26"></a><span class="co">#&gt; [1,]    4    7</span></span>
<span id="cb55-27"><a href="#cb55-27"></a><span class="co">#&gt; [2,]    5    8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Matrices are particularly useful for linear algebra operations and when you need efficient numerical computations.</p>
</section></section><section id="sec-reading-writing" class="level2" data-number="7.13"><h2 data-number="7.13" class="anchored" data-anchor-id="sec-reading-writing">
<span class="header-section-number">7.13</span> Reading and Writing Data</h2>
<section id="reading-files" class="level3" data-number="7.13.1"><h3 data-number="7.13.1" class="anchored" data-anchor-id="reading-files">
<span class="header-section-number">7.13.1</span> Reading Files</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># CSV files (comma-separated)</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data.csv"</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="co"># Tab-separated files</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data.tsv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="co"># Excel files (requires readxl package)</span></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="fu">library</span>(readxl)</span>
<span id="cb56-9"><a href="#cb56-9"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data.xlsx"</span>)</span>
<span id="cb56-10"><a href="#cb56-10"></a></span>
<span id="cb56-11"><a href="#cb56-11"></a><span class="co"># Specify options</span></span>
<span id="cb56-12"><a href="#cb56-12"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data.csv"</span>,</span>
<span id="cb56-13"><a href="#cb56-13"></a>                 <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-14"><a href="#cb56-14"></a>                 <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb56-15"><a href="#cb56-15"></a>                 <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"N/A"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="writing-files" class="level3" data-number="7.13.2"><h3 data-number="7.13.2" class="anchored" data-anchor-id="writing-files">
<span class="header-section-number">7.13.2</span> Writing Files</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># CSV output</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="fu">write.csv</span>(experiment, <span class="st">"experiment_results.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a></span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="co"># Tab-separated</span></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="fu">write.table</span>(experiment, <span class="st">"results.tsv"</span>, </span>
<span id="cb57-6"><a href="#cb57-6"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, </span>
<span id="cb57-7"><a href="#cb57-7"></a>            <span class="at">quote =</span> <span class="cn">FALSE</span>, </span>
<span id="cb57-8"><a href="#cb57-8"></a>            <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-basic-viz" class="level2" data-number="7.14"><h2 data-number="7.14" class="anchored" data-anchor-id="sec-basic-viz">
<span class="header-section-number">7.14</span> Basic Visualization</h2>
<p>R excels at creating graphics. Here’s a quick introduction to base R plotting:</p>
<section id="scatter-plots" class="level3" data-number="7.14.1"><h3 data-number="7.14.1" class="anchored" data-anchor-id="scatter-plots">
<span class="header-section-number">7.14.1</span> Scatter Plots</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb58-3"><a href="#cb58-3"></a></span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="fu">plot</span>(x, y, </span>
<span id="cb58-5"><a href="#cb58-5"></a>     <span class="at">main =</span> <span class="st">"Quadratic Relationship"</span>,</span>
<span id="cb58-6"><a href="#cb58-6"></a>     <span class="at">xlab =</span> <span class="st">"X values"</span>,</span>
<span id="cb58-7"><a href="#cb58-7"></a>     <span class="at">ylab =</span> <span class="st">"Y values"</span>,</span>
<span id="cb58-8"><a href="#cb58-8"></a>     <span class="at">col =</span> <span class="st">"darkblue"</span>,</span>
<span id="cb58-9"><a href="#cb58-9"></a>     <span class="at">pch =</span> <span class="dv">16</span>)  <span class="co"># Filled circles</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-r-programming_files/figure-html/fig-scatter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.4: Basic scatter plot showing quadratic relationship
</figcaption></figure>
</div>
</div>
</div>
</section><section id="histograms" class="level3" data-number="7.14.2"><h3 data-number="7.14.2" class="anchored" data-anchor-id="histograms">
<span class="header-section-number">7.14.2</span> Histograms</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Generate random data</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb59-3"><a href="#cb59-3"></a></span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="fu">hist</span>(data,</span>
<span id="cb59-5"><a href="#cb59-5"></a>     <span class="at">main =</span> <span class="st">"Distribution of Values"</span>,</span>
<span id="cb59-6"><a href="#cb59-6"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>,</span>
<span id="cb59-7"><a href="#cb59-7"></a>     <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb59-8"><a href="#cb59-8"></a>     <span class="at">breaks =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-histogram" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-r-programming_files/figure-html/fig-histogram-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.5: Histogram of normally distributed data
</figcaption></figure>
</div>
</div>
</div>
</section><section id="box-plots" class="level3" data-number="7.14.3"><h3 data-number="7.14.3" class="anchored" data-anchor-id="box-plots">
<span class="header-section-number">7.14.3</span> Box Plots</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Create sample data</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb60-3"><a href="#cb60-3"></a>control <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb60-4"><a href="#cb60-4"></a>treatment <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb60-5"><a href="#cb60-5"></a></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="fu">boxplot</span>(control, treatment,</span>
<span id="cb60-7"><a href="#cb60-7"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>),</span>
<span id="cb60-8"><a href="#cb60-8"></a>        <span class="at">main =</span> <span class="st">"Treatment Effect"</span>,</span>
<span id="cb60-9"><a href="#cb60-9"></a>        <span class="at">ylab =</span> <span class="st">"Response"</span>,</span>
<span id="cb60-10"><a href="#cb60-10"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"lightcoral"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-r-programming_files/figure-html/fig-boxplot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.6: Box plot comparing treatment groups
</figcaption></figure>
</div>
</div>
</div>
</section><section id="multiple-plots" class="level3" data-number="7.14.4"><h3 data-number="7.14.4" class="anchored" data-anchor-id="multiple-plots">
<span class="header-section-number">7.14.4</span> Multiple Plots</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># Create 2x2 layout</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb61-3"><a href="#cb61-3"></a></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="co"># Four different plots</span></span>
<span id="cb61-5"><a href="#cb61-5"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Line Plot"</span>)</span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">main =</span> <span class="st">"Histogram"</span>)</span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="fu">boxplot</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>), <span class="at">main =</span> <span class="st">"Box Plot"</span>)</span>
<span id="cb61-8"><a href="#cb61-8"></a><span class="fu">barplot</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">7</span>), <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>), <span class="at">main =</span> <span class="st">"Bar Plot"</span>)</span>
<span id="cb61-9"><a href="#cb61-9"></a></span>
<span id="cb61-10"><a href="#cb61-10"></a><span class="co"># Reset to single plot</span></span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-multipanel" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-multipanel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-r-programming_files/figure-html/fig-multipanel-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multipanel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.7: Multiple plots in a single figure
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For publication-quality graphics, explore the <strong>ggplot2</strong> package <span class="citation" data-cites="wickham2023r">(<a href="../references.html#ref-wickham2023r" role="doc-biblioref">Wickham et al., 2023</a>)</span>, which provides a powerful and consistent grammar of graphics.</p>
</div>
</div>
</section></section><section id="sec-split-apply-combine" class="level2" data-number="7.15"><h2 data-number="7.15" class="anchored" data-anchor-id="sec-split-apply-combine">
<span class="header-section-number">7.15</span> The Split-Apply-Combine Approach</h2>
<p>A common pattern in data analysis is to split data by groups, apply a function to each group, and combine the results. This <strong>split-apply-combine</strong> workflow appears repeatedly in scientific computing.</p>
<section id="using-tapply-for-grouped-operations" class="level3" data-number="7.15.1"><h3 data-number="7.15.1" class="anchored" data-anchor-id="using-tapply-for-grouped-operations">
<span class="header-section-number">7.15.1</span> Using <code>tapply()</code> for Grouped Operations</h3>
<p>The <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> function applies a function to subsets of a vector, split by a factor:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Sample data</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">45</span>, <span class="dv">67</span>, <span class="dv">34</span>, <span class="dv">56</span>, <span class="dv">78</span>, <span class="dv">12</span>, <span class="dv">89</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>groups <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>))</span>
<span id="cb62-4"><a href="#cb62-4"></a></span>
<span id="cb62-5"><a href="#cb62-5"></a><span class="co"># Mean by group</span></span>
<span id="cb62-6"><a href="#cb62-6"></a><span class="fu">tapply</span>(values, groups, mean)</span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="co">#&gt;    A    B    C </span></span>
<span id="cb62-8"><a href="#cb62-8"></a><span class="co">#&gt; 45.0 56.0 50.5</span></span>
<span id="cb62-9"><a href="#cb62-9"></a></span>
<span id="cb62-10"><a href="#cb62-10"></a><span class="co"># Standard deviation by group</span></span>
<span id="cb62-11"><a href="#cb62-11"></a><span class="fu">tapply</span>(values, groups, sd)</span>
<span id="cb62-12"><a href="#cb62-12"></a><span class="co">#&gt;        A        B        C </span></span>
<span id="cb62-13"><a href="#cb62-13"></a><span class="co">#&gt; 22.00000 22.00000 54.44722</span></span>
<span id="cb62-14"><a href="#cb62-14"></a></span>
<span id="cb62-15"><a href="#cb62-15"></a><span class="co"># Custom summary: range</span></span>
<span id="cb62-16"><a href="#cb62-16"></a><span class="fu">tapply</span>(values, groups, <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb62-17"><a href="#cb62-17"></a><span class="co">#&gt;  A  B  C </span></span>
<span id="cb62-18"><a href="#cb62-18"></a><span class="co">#&gt; 44 44 77</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="using-aggregate-for-data-frames" class="level3" data-number="7.15.2"><h3 data-number="7.15.2" class="anchored" data-anchor-id="using-aggregate-for-data-frames">
<span class="header-section-number">7.15.2</span> Using <code>aggregate()</code> for Data Frames</h3>
<p>For data frames, <code><a href="https://rdrr.io/r/stats/aggregate.html">aggregate()</a></code> summarizes multiple columns at once:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Using built-in iris data</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Sepal.Length</th>
<th style="text-align: right;">Sepal.Width</th>
<th style="text-align: right;">Petal.Length</th>
<th style="text-align: right;">Petal.Width</th>
<th style="text-align: left;">Species</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="co"># Mean of all numeric columns by Species</span></span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="fu">aggregate</span>(. <span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: right;">Sepal.Length</th>
<th style="text-align: right;">Sepal.Width</th>
<th style="text-align: right;">Petal.Length</th>
<th style="text-align: right;">Petal.Width</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5.006</td>
<td style="text-align: right;">3.428</td>
<td style="text-align: right;">1.462</td>
<td style="text-align: right;">0.246</td>
</tr>
<tr class="even">
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5.936</td>
<td style="text-align: right;">2.770</td>
<td style="text-align: right;">4.260</td>
<td style="text-align: right;">1.326</td>
</tr>
<tr class="odd">
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6.588</td>
<td style="text-align: right;">2.974</td>
<td style="text-align: right;">5.552</td>
<td style="text-align: right;">2.026</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co"># Multiple statistics (result contains a matrix column)</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>agg_result <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Sepal.Length <span class="sc">~</span> Species, <span class="at">data =</span> iris,</span>
<span id="cb65-4"><a href="#cb65-4"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">sd =</span> <span class="fu">sd</span>(x)))</span>
<span id="cb65-5"><a href="#cb65-5"></a></span>
<span id="cb65-6"><a href="#cb65-6"></a><span class="co"># Convert to a regular data frame for display</span></span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="fu">do.call</span>(data.frame, agg_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: right;">Sepal.Length.mean</th>
<th style="text-align: right;">Sepal.Length.sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5.006</td>
<td style="text-align: right;">0.3524897</td>
</tr>
<tr class="even">
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5.936</td>
<td style="text-align: right;">0.5161711</td>
</tr>
<tr class="odd">
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6.588</td>
<td style="text-align: right;">0.6358796</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="the-apply-family" class="level3" data-number="7.15.3"><h3 data-number="7.15.3" class="anchored" data-anchor-id="the-apply-family">
<span class="header-section-number">7.15.3</span> The <code>apply()</code> Family</h3>
<p>R provides several related functions for different data structures:</p>
<div id="tbl-apply-family" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-apply-family-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.3: The apply family of functions
</figcaption><div aria-describedby="tbl-apply-family-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Input</th>
<th style="text-align: left;">Applies Over</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code></td>
<td style="text-align: left;">Matrix/data frame</td>
<td style="text-align: left;">Rows or columns</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code></td>
<td style="text-align: left;">List</td>
<td style="text-align: left;">Each element, returns list</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code></td>
<td style="text-align: left;">List</td>
<td style="text-align: left;">Each element, returns vector</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code></td>
<td style="text-align: left;">Vector + factor</td>
<td style="text-align: left;">Groups defined by factor</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/base/mapply.html">mapply()</a></code></td>
<td style="text-align: left;">Multiple vectors</td>
<td style="text-align: left;">Corresponding elements</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># Apply to matrix columns</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="fu">apply</span>(mat, <span class="dv">2</span>, sum)  <span class="co"># Column sums (MARGIN = 2)</span></span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="co">#&gt; [1]  6 15 24 33</span></span>
<span id="cb66-5"><a href="#cb66-5"></a><span class="fu">apply</span>(mat, <span class="dv">1</span>, sum)  <span class="co"># Row sums (MARGIN = 1)</span></span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="co">#&gt; [1] 22 26 30</span></span>
<span id="cb66-7"><a href="#cb66-7"></a></span>
<span id="cb66-8"><a href="#cb66-8"></a><span class="co"># Apply to each element of a list</span></span>
<span id="cb66-9"><a href="#cb66-9"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">b =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">c =</span> <span class="dv">100</span><span class="sc">:</span><span class="dv">110</span>)</span>
<span id="cb66-10"><a href="#cb66-10"></a><span class="fu">lapply</span>(my_list, mean)</span>
<span id="cb66-11"><a href="#cb66-11"></a><span class="co">#&gt; $a</span></span>
<span id="cb66-12"><a href="#cb66-12"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb66-13"><a href="#cb66-13"></a><span class="co">#&gt; </span></span>
<span id="cb66-14"><a href="#cb66-14"></a><span class="co">#&gt; $b</span></span>
<span id="cb66-15"><a href="#cb66-15"></a><span class="co">#&gt; [1] 12.5</span></span>
<span id="cb66-16"><a href="#cb66-16"></a><span class="co">#&gt; </span></span>
<span id="cb66-17"><a href="#cb66-17"></a><span class="co">#&gt; $c</span></span>
<span id="cb66-18"><a href="#cb66-18"></a><span class="co">#&gt; [1] 105</span></span>
<span id="cb66-19"><a href="#cb66-19"></a><span class="fu">sapply</span>(my_list, mean)  <span class="co"># Simplified output</span></span>
<span id="cb66-20"><a href="#cb66-20"></a><span class="co">#&gt;     a     b     c </span></span>
<span id="cb66-21"><a href="#cb66-21"></a><span class="co">#&gt;   3.0  12.5 105.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The tidyverse packages (covered in the next chapter) provide more intuitive alternatives like <code>group_by()</code> and <code>summarize()</code> for this workflow.</p>
</div>
</div>
</section></section><section id="sec-programming-constructs" class="level2" data-number="7.16"><h2 data-number="7.16" class="anchored" data-anchor-id="sec-programming-constructs">
<span class="header-section-number">7.16</span> Basic Programming Constructs</h2>
<p>As you develop your R skills, you’ll encounter situations requiring conditional logic and iteration.</p>
<section id="conditional-statements-with-ifelse" class="level3" data-number="7.16.1"><h3 data-number="7.16.1" class="anchored" data-anchor-id="conditional-statements-with-ifelse">
<span class="header-section-number">7.16.1</span> Conditional Statements with <code>ifelse()</code>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> function provides vectorized conditional logic:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># Basic ifelse</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">72</span>, <span class="dv">91</span>, <span class="dv">68</span>, <span class="dv">79</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="fu">ifelse</span>(scores <span class="sc">&gt;=</span> <span class="dv">80</span>, <span class="st">"Pass"</span>, <span class="st">"Fail"</span>)</span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="co">#&gt; [1] "Pass" "Fail" "Pass" "Fail" "Fail"</span></span>
<span id="cb67-5"><a href="#cb67-5"></a></span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="co"># Nested conditions</span></span>
<span id="cb67-7"><a href="#cb67-7"></a>grades <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(scores <span class="sc">&gt;=</span> <span class="dv">90</span>, <span class="st">"A"</span>,</span>
<span id="cb67-8"><a href="#cb67-8"></a>           <span class="fu">ifelse</span>(scores <span class="sc">&gt;=</span> <span class="dv">80</span>, <span class="st">"B"</span>,</span>
<span id="cb67-9"><a href="#cb67-9"></a>             <span class="fu">ifelse</span>(scores <span class="sc">&gt;=</span> <span class="dv">70</span>, <span class="st">"C"</span>, <span class="st">"F"</span>)))</span>
<span id="cb67-10"><a href="#cb67-10"></a>grades</span>
<span id="cb67-11"><a href="#cb67-11"></a><span class="co">#&gt; [1] "B" "C" "A" "F" "C"</span></span>
<span id="cb67-12"><a href="#cb67-12"></a></span>
<span id="cb67-13"><a href="#cb67-13"></a><span class="co"># Useful for creating indicator variables</span></span>
<span id="cb67-14"><a href="#cb67-14"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"drug"</span>, <span class="st">"drug"</span>, <span class="st">"control"</span>, <span class="st">"drug"</span>)</span>
<span id="cb67-15"><a href="#cb67-15"></a>colors <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"drug"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="type-safe-conditionals-with-if_else" class="level3" data-number="7.16.2"><h3 data-number="7.16.2" class="anchored" data-anchor-id="type-safe-conditionals-with-if_else">
<span class="header-section-number">7.16.2</span> Type-Safe Conditionals with <code>if_else()</code>
</h3>
<p>The tidyverse provides <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">dplyr::if_else()</a></code>, which is stricter than base R’s <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb68-2"><a href="#cb68-2"></a></span>
<span id="cb68-3"><a href="#cb68-3"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb68-4"><a href="#cb68-4"></a></span>
<span id="cb68-5"><a href="#cb68-5"></a><span class="co"># if_else() requires matching types for true/false</span></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"positive"</span>, <span class="st">"non-positive"</span>)</span>
<span id="cb68-7"><a href="#cb68-7"></a><span class="co">#&gt; [1] "non-positive" "non-positive" "non-positive" "positive"     "positive"</span></span>
<span id="cb68-8"><a href="#cb68-8"></a></span>
<span id="cb68-9"><a href="#cb68-9"></a><span class="co"># Handles NA explicitly with the 'missing' argument</span></span>
<span id="cb68-10"><a href="#cb68-10"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="dv">5</span>)</span>
<span id="cb68-11"><a href="#cb68-11"></a><span class="fu">if_else</span>(y <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="st">"high"</span>, <span class="st">"low"</span>, <span class="at">missing =</span> <span class="st">"unknown"</span>)</span>
<span id="cb68-12"><a href="#cb68-12"></a><span class="co">#&gt; [1] "low"     "unknown" "high"    "unknown" "high"</span></span>
<span id="cb68-13"><a href="#cb68-13"></a></span>
<span id="cb68-14"><a href="#cb68-14"></a><span class="co"># Creates a simple absolute value implementation</span></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="fu">if_else</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="sc">-</span>x, x)</span>
<span id="cb68-16"><a href="#cb68-16"></a><span class="co">#&gt; [1] 2 1 0 1 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">dplyr::if_else()</a></code> over base <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> when:</p>
<ul>
<li>You want type checking (prevents accidentally mixing numbers and strings)</li>
<li>You need explicit control over NA handling</li>
<li>You’re already using tidyverse functions</li>
</ul>
</div>
</div>
</section><section id="for-loops" class="level3" data-number="7.16.3"><h3 data-number="7.16.3" class="anchored" data-anchor-id="for-loops">
<span class="header-section-number">7.16.3</span> For Loops</h3>
<p>While R is optimized for vectorized operations, loops are sometimes necessary:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># Simple loop</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-4"><a href="#cb69-4"></a>}</span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb69-7"><a href="#cb69-7"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb69-8"><a href="#cb69-8"></a><span class="co">#&gt; [1] 16</span></span>
<span id="cb69-9"><a href="#cb69-9"></a><span class="co">#&gt; [1] 25</span></span>
<span id="cb69-10"><a href="#cb69-10"></a></span>
<span id="cb69-11"><a href="#cb69-11"></a><span class="co"># Loop with pre-allocated output (recommended for efficiency)</span></span>
<span id="cb69-12"><a href="#cb69-12"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb69-13"><a href="#cb69-13"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  <span class="co"># Pre-allocate</span></span>
<span id="cb69-14"><a href="#cb69-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb69-15"><a href="#cb69-15"></a>  results[i] <span class="ot">&lt;-</span> i <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb69-16"><a href="#cb69-16"></a>}</span>
<span id="cb69-17"><a href="#cb69-17"></a>results</span>
<span id="cb69-18"><a href="#cb69-18"></a><span class="co">#&gt;  [1]  2  4  6  8 10 12 14 16 18 20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>In R, loops are often slower than vectorized alternatives. Before writing a loop, consider whether a vectorized function (<code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code>, <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code>, etc.) or built-in operation would work instead.</p>
</div>
</div>
</section><section id="writing-simple-functions" class="level3" data-number="7.16.4"><h3 data-number="7.16.4" class="anchored" data-anchor-id="writing-simple-functions">
<span class="header-section-number">7.16.4</span> Writing Simple Functions</h3>
<p>You can create your own functions for repeated tasks:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># Define a function</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>calculate_cv <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="co"># Coefficient of variation: SD / mean * 100</span></span>
<span id="cb70-4"><a href="#cb70-4"></a>  cv <span class="ot">&lt;-</span> <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">mean</span>(x) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="fu">return</span>(cv)</span>
<span id="cb70-6"><a href="#cb70-6"></a>}</span>
<span id="cb70-7"><a href="#cb70-7"></a></span>
<span id="cb70-8"><a href="#cb70-8"></a><span class="co"># Use the function</span></span>
<span id="cb70-9"><a href="#cb70-9"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">9</span>, <span class="dv">14</span>)</span>
<span id="cb70-10"><a href="#cb70-10"></a><span class="fu">calculate_cv</span>(data)</span>
<span id="cb70-11"><a href="#cb70-11"></a><span class="co">#&gt; [1] 16.26808</span></span>
<span id="cb70-12"><a href="#cb70-12"></a></span>
<span id="cb70-13"><a href="#cb70-13"></a><span class="co"># Function with multiple arguments and default values</span></span>
<span id="cb70-14"><a href="#cb70-14"></a>summarize_data <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">digits =</span> <span class="dv">2</span>) {</span>
<span id="cb70-15"><a href="#cb70-15"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb70-16"><a href="#cb70-16"></a>    <span class="at">mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(x), digits),</span>
<span id="cb70-17"><a href="#cb70-17"></a>    <span class="at">sd =</span> <span class="fu">round</span>(<span class="fu">sd</span>(x), digits),</span>
<span id="cb70-18"><a href="#cb70-18"></a>    <span class="at">n =</span> <span class="fu">length</span>(x)</span>
<span id="cb70-19"><a href="#cb70-19"></a>  )</span>
<span id="cb70-20"><a href="#cb70-20"></a>  <span class="fu">return</span>(result)</span>
<span id="cb70-21"><a href="#cb70-21"></a>}</span>
<span id="cb70-22"><a href="#cb70-22"></a></span>
<span id="cb70-23"><a href="#cb70-23"></a><span class="fu">summarize_data</span>(data)</span>
<span id="cb70-24"><a href="#cb70-24"></a><span class="co">#&gt;  mean    sd     n </span></span>
<span id="cb70-25"><a href="#cb70-25"></a><span class="co">#&gt; 11.50  1.87  6.00</span></span>
<span id="cb70-26"><a href="#cb70-26"></a><span class="fu">summarize_data</span>(data, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb70-27"><a href="#cb70-27"></a><span class="co">#&gt;   mean     sd      n </span></span>
<span id="cb70-28"><a href="#cb70-28"></a><span class="co">#&gt; 11.500  1.871  6.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-random-sampling" class="level2" data-number="7.17"><h2 data-number="7.17" class="anchored" data-anchor-id="sec-random-sampling">
<span class="header-section-number">7.17</span> Random Sampling and Simulation</h2>
<p>R makes it easy to generate random data and run simulations:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb71-3"><a href="#cb71-3"></a></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="co"># Random samples from distributions</span></span>
<span id="cb71-5"><a href="#cb71-5"></a>uniform_sample <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb71-6"><a href="#cb71-6"></a>normal_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb71-7"><a href="#cb71-7"></a>poisson_sample <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">100</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb71-8"><a href="#cb71-8"></a></span>
<span id="cb71-9"><a href="#cb71-9"></a><span class="co"># Visualize normal distribution</span></span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="fu">hist</span>(normal_sample, </span>
<span id="cb71-11"><a href="#cb71-11"></a>     <span class="at">probability =</span> <span class="cn">TRUE</span>,  <span class="co"># Density instead of counts</span></span>
<span id="cb71-12"><a href="#cb71-12"></a>     <span class="at">main =</span> <span class="st">"Sample vs. Theoretical Distribution"</span>,</span>
<span id="cb71-13"><a href="#cb71-13"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>)</span>
<span id="cb71-14"><a href="#cb71-14"></a></span>
<span id="cb71-15"><a href="#cb71-15"></a><span class="co"># Add theoretical curve</span></span>
<span id="cb71-16"><a href="#cb71-16"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb71-17"><a href="#cb71-17"></a>      <span class="at">add =</span> <span class="cn">TRUE</span>, </span>
<span id="cb71-18"><a href="#cb71-18"></a>      <span class="at">col =</span> <span class="st">"red"</span>, </span>
<span id="cb71-19"><a href="#cb71-19"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-simulation" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-simulation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-r-programming_files/figure-html/fig-simulation-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simulation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.8: Simulated data from a normal distribution with theoretical curve overlay
</figcaption></figure>
</div>
</div>
</div>
<section id="common-distribution-functions" class="level3" data-number="7.17.1"><h3 data-number="7.17.1" class="anchored" data-anchor-id="common-distribution-functions">
<span class="header-section-number">7.17.1</span> Common Distribution Functions</h3>
<p>For distribution <code>xxx</code> (e.g., <code>norm</code>, <code>unif</code>, <code>pois</code>, <code>binom</code>):</p>
<ul>
<li>
<code>rxxx()</code> — Random samples</li>
<li>
<code>dxxx()</code> — Density/probability</li>
<li>
<code>pxxx()</code> — Cumulative distribution function</li>
<li>
<code>qxxx()</code> — Quantile function</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co"># Normal distribution</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="fu">rnorm</span>(<span class="dv">5</span>)        <span class="co"># 5 random values</span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="co">#&gt; [1]  0.9159921  0.8006224 -0.9365690 -1.4007874  0.1602775</span></span>
<span id="cb72-4"><a href="#cb72-4"></a><span class="fu">dnorm</span>(<span class="dv">0</span>)        <span class="co"># Density at x=0</span></span>
<span id="cb72-5"><a href="#cb72-5"></a><span class="co">#&gt; [1] 0.3989423</span></span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="fu">pnorm</span>(<span class="fl">1.96</span>)     <span class="co"># P(X ≤ 1.96)</span></span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="co">#&gt; [1] 0.9750021</span></span>
<span id="cb72-8"><a href="#cb72-8"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>)    <span class="co"># Value where P(X ≤ x) = 0.975</span></span>
<span id="cb72-9"><a href="#cb72-9"></a><span class="co">#&gt; [1] 1.959964</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="repeated-simulations-with-replicate" class="level3" data-number="7.17.2"><h3 data-number="7.17.2" class="anchored" data-anchor-id="repeated-simulations-with-replicate">
<span class="header-section-number">7.17.2</span> Repeated Simulations with <code>replicate()</code>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/lapply.html">replicate()</a></code> function repeats an expression multiple times and collects the results—perfect for simulations:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># Shuffle integers 1-10 five times</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="fu">replicate</span>(<span class="dv">5</span>, <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb73-4"><a href="#cb73-4"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="co">#&gt;  [1,]    1    8    9    3    5</span></span>
<span id="cb73-6"><a href="#cb73-6"></a><span class="co">#&gt;  [2,]    5    7   10    1    4</span></span>
<span id="cb73-7"><a href="#cb73-7"></a><span class="co">#&gt;  [3,]   10    4    3    2    2</span></span>
<span id="cb73-8"><a href="#cb73-8"></a><span class="co">#&gt;  [4,]    8    1    4    6    8</span></span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="co">#&gt;  [5,]    2    5    5   10    3</span></span>
<span id="cb73-10"><a href="#cb73-10"></a><span class="co">#&gt;  [6,]    4   10    6    8    1</span></span>
<span id="cb73-11"><a href="#cb73-11"></a><span class="co">#&gt;  [7,]    6    2    1    4   10</span></span>
<span id="cb73-12"><a href="#cb73-12"></a><span class="co">#&gt;  [8,]    9    6    2    5    7</span></span>
<span id="cb73-13"><a href="#cb73-13"></a><span class="co">#&gt;  [9,]    7    9    8    7    6</span></span>
<span id="cb73-14"><a href="#cb73-14"></a><span class="co">#&gt; [10,]    3    3    7    9    9</span></span>
<span id="cb73-15"><a href="#cb73-15"></a></span>
<span id="cb73-16"><a href="#cb73-16"></a><span class="co"># Simulate sampling distributions</span></span>
<span id="cb73-17"><a href="#cb73-17"></a><span class="co"># Take 1000 samples of size 30 and calculate mean of each</span></span>
<span id="cb73-18"><a href="#cb73-18"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb73-19"><a href="#cb73-19"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)))</span>
<span id="cb73-20"><a href="#cb73-20"></a><span class="fu">hist</span>(sample_means, <span class="at">main =</span> <span class="st">"Distribution of Sample Means"</span>,</span>
<span id="cb73-21"><a href="#cb73-21"></a>     <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07-r-programming_files/figure-html/replicate-examples-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The <code><a href="https://rdrr.io/r/base/lapply.html">replicate()</a></code> function belongs to the “apply” family and returns a matrix (if results are vectors of equal length) or a list (if results vary in length).</p>
</section></section><section id="sec-numeric-transformations" class="level2" data-number="7.18"><h2 data-number="7.18" class="anchored" data-anchor-id="sec-numeric-transformations">
<span class="header-section-number">7.18</span> Useful Numeric Transformations</h2>
<p>R and the tidyverse provide many functions for transforming numeric data. These are particularly useful within <code>mutate()</code> operations.</p>
<section id="cumulative-and-running-aggregates" class="level3" data-number="7.18.1"><h3 data-number="7.18.1" class="anchored" data-anchor-id="cumulative-and-running-aggregates">
<span class="header-section-number">7.18.1</span> Cumulative and Running Aggregates</h3>
<p>Base R provides functions for running (cumulative) calculations:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a></span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="fu">cumsum</span>(x)   <span class="co"># Running sum: 1, 3, 6, 10, 15</span></span>
<span id="cb74-4"><a href="#cb74-4"></a><span class="co">#&gt; [1]  1  3  6 10 15</span></span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="fu">cumprod</span>(x)  <span class="co"># Running product: 1, 2, 6, 24, 120</span></span>
<span id="cb74-6"><a href="#cb74-6"></a><span class="co">#&gt; [1]   1   2   6  24 120</span></span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="fu">cummax</span>(x)   <span class="co"># Running maximum</span></span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span id="cb74-9"><a href="#cb74-9"></a><span class="fu">cummin</span>(x)   <span class="co"># Running minimum</span></span>
<span id="cb74-10"><a href="#cb74-10"></a><span class="co">#&gt; [1] 1 1 1 1 1</span></span>
<span id="cb74-11"><a href="#cb74-11"></a></span>
<span id="cb74-12"><a href="#cb74-12"></a><span class="co"># Useful for time series data</span></span>
<span id="cb74-13"><a href="#cb74-13"></a>daily_cases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">22</span>, <span class="dv">18</span>)</span>
<span id="cb74-14"><a href="#cb74-14"></a><span class="fu">cumsum</span>(daily_cases)  <span class="co"># Total cases over time</span></span>
<span id="cb74-15"><a href="#cb74-15"></a><span class="co">#&gt; [1] 10 25 33 55 73</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="offsets-with-lead-and-lag" class="level3" data-number="7.18.2"><h3 data-number="7.18.2" class="anchored" data-anchor-id="offsets-with-lead-and-lag">
<span class="header-section-number">7.18.2</span> Offsets with <code>lead()</code> and <code>lag()</code>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">dplyr::lead()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">dplyr::lag()</a></code> functions let you reference values before or after the current position:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb75-2"><a href="#cb75-2"></a></span>
<span id="cb75-3"><a href="#cb75-3"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>)</span>
<span id="cb75-4"><a href="#cb75-4"></a></span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="fu">lag</span>(x)   <span class="co"># Previous value: NA, 10, 20, 30, 40</span></span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="co">#&gt; [1] NA 10 20 30 40</span></span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="fu">lead</span>(x)  <span class="co"># Next value: 20, 30, 40, 50, NA</span></span>
<span id="cb75-8"><a href="#cb75-8"></a><span class="co">#&gt; [1] 20 30 40 50 NA</span></span>
<span id="cb75-9"><a href="#cb75-9"></a></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="co"># Calculate differences from previous value</span></span>
<span id="cb75-11"><a href="#cb75-11"></a>x <span class="sc">-</span> <span class="fu">lag</span>(x)</span>
<span id="cb75-12"><a href="#cb75-12"></a><span class="co">#&gt; [1] NA 10 10 10 10</span></span>
<span id="cb75-13"><a href="#cb75-13"></a></span>
<span id="cb75-14"><a href="#cb75-14"></a><span class="co"># Detect changes</span></span>
<span id="cb75-15"><a href="#cb75-15"></a>x <span class="sc">!=</span> <span class="fu">lag</span>(x)</span>
<span id="cb75-16"><a href="#cb75-16"></a><span class="co">#&gt; [1]   NA TRUE TRUE TRUE TRUE</span></span>
<span id="cb75-17"><a href="#cb75-17"></a></span>
<span id="cb75-18"><a href="#cb75-18"></a><span class="co"># Lag by more than one position</span></span>
<span id="cb75-19"><a href="#cb75-19"></a><span class="fu">lag</span>(x, <span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb75-20"><a href="#cb75-20"></a><span class="co">#&gt; [1] NA NA 10 20 30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is invaluable for time series analysis, detecting changes, and calculating growth rates.</p>
</section><section id="ranking-values" class="level3" data-number="7.18.3"><h3 data-number="7.18.3" class="anchored" data-anchor-id="ranking-values">
<span class="header-section-number">7.18.3</span> Ranking Values</h3>
<p>dplyr provides several ranking functions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="cn">NA</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="fu">min_rank</span>(x)      <span class="co"># Standard competition ranking (1, 2, 2, 4)</span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="co">#&gt; [1]  5  1  4  2  2 NA</span></span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="fu">dense_rank</span>(x)    <span class="co"># No gaps after ties (1, 2, 2, 3)</span></span>
<span id="cb76-6"><a href="#cb76-6"></a><span class="co">#&gt; [1]  4  1  3  2  2 NA</span></span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="fu">row_number</span>(x)    <span class="co"># Unique ranks (ties broken by position)</span></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="co">#&gt; [1]  5  1  4  2  3 NA</span></span>
<span id="cb76-9"><a href="#cb76-9"></a></span>
<span id="cb76-10"><a href="#cb76-10"></a><span class="co"># Rank in descending order</span></span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="fu">min_rank</span>(<span class="fu">desc</span>(x))</span>
<span id="cb76-12"><a href="#cb76-12"></a><span class="co">#&gt; [1]  1  5  2  3  3 NA</span></span>
<span id="cb76-13"><a href="#cb76-13"></a></span>
<span id="cb76-14"><a href="#cb76-14"></a><span class="co"># Practical example: find top 3 values</span></span>
<span id="cb76-15"><a href="#cb76-15"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">gene =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>),</span>
<span id="cb76-16"><a href="#cb76-16"></a>             <span class="at">expression =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">8.1</span>, <span class="fl">3.4</span>, <span class="fl">9.7</span>, <span class="fl">6.5</span>))</span>
<span id="cb76-17"><a href="#cb76-17"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">min_rank</span>(<span class="fu">desc</span>(expression)) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">gene</th>
<th style="text-align: right;">expression</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">8.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">9.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">6.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="binning-numbers-with-cut" class="level3" data-number="7.18.4"><h3 data-number="7.18.4" class="anchored" data-anchor-id="binning-numbers-with-cut">
<span class="header-section-number">7.18.4</span> Binning Numbers with <code>cut()</code>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> function divides continuous data into discrete bins:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">75</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="co"># Create age groups</span></span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="fu">cut</span>(ages, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">100</span>))</span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="co">#&gt; [1] (0,18]   (18,35]  (18,35]  (35,55]  (35,55]  (55,100] (55,100]</span></span>
<span id="cb77-6"><a href="#cb77-6"></a><span class="co">#&gt; Levels: (0,18] (18,35] (35,55] (55,100]</span></span>
<span id="cb77-7"><a href="#cb77-7"></a></span>
<span id="cb77-8"><a href="#cb77-8"></a><span class="co"># Custom labels</span></span>
<span id="cb77-9"><a href="#cb77-9"></a><span class="fu">cut</span>(ages,</span>
<span id="cb77-10"><a href="#cb77-10"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">100</span>),</span>
<span id="cb77-11"><a href="#cb77-11"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"minor"</span>, <span class="st">"young_adult"</span>, <span class="st">"middle_aged"</span>, <span class="st">"senior"</span>))</span>
<span id="cb77-12"><a href="#cb77-12"></a><span class="co">#&gt; [1] minor       young_adult young_adult middle_aged middle_aged senior     </span></span>
<span id="cb77-13"><a href="#cb77-13"></a><span class="co">#&gt; [7] senior     </span></span>
<span id="cb77-14"><a href="#cb77-14"></a><span class="co">#&gt; Levels: minor young_adult middle_aged senior</span></span>
<span id="cb77-15"><a href="#cb77-15"></a></span>
<span id="cb77-16"><a href="#cb77-16"></a><span class="co"># Include lowest value and control interval direction</span></span>
<span id="cb77-17"><a href="#cb77-17"></a><span class="fu">cut</span>(ages, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">100</span>),</span>
<span id="cb77-18"><a href="#cb77-18"></a>    <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, <span class="at">right =</span> <span class="cn">FALSE</span>)</span>
<span id="cb77-19"><a href="#cb77-19"></a><span class="co">#&gt; [1] [0,18)   [18,35)  [35,55)  [35,55)  [55,100] [55,100] [55,100]</span></span>
<span id="cb77-20"><a href="#cb77-20"></a><span class="co">#&gt; Levels: [0,18) [18,35) [35,55) [55,100]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is particularly useful for creating categorical variables from continuous measurements for analysis or visualization.</p>
</section></section><section id="sec-cleanup" class="level2" data-number="7.19"><h2 data-number="7.19" class="anchored" data-anchor-id="sec-cleanup">
<span class="header-section-number">7.19</span> Cleaning Up Your Environment</h2>
<p>As you work in R, your environment accumulates objects. Periodically cleaning up helps manage memory and avoid confusion.</p>
<section id="removing-objects" class="level3" data-number="7.19.1"><h3 data-number="7.19.1" class="anchored" data-anchor-id="removing-objects">
<span class="header-section-number">7.19.1</span> Removing Objects</h3>
<p>Use <code><a href="https://rdrr.io/r/base/rm.html">rm()</a></code> to remove objects from your environment:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># Remove a single object</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="fu">rm</span>(x)</span>
<span id="cb78-3"><a href="#cb78-3"></a></span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="co"># Remove multiple objects</span></span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="fu">rm</span>(x, y, z)</span>
<span id="cb78-6"><a href="#cb78-6"></a></span>
<span id="cb78-7"><a href="#cb78-7"></a><span class="co"># Remove all objects (use with caution!)</span></span>
<span id="cb78-8"><a href="#cb78-8"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>rm(list = ls())</code> removes everything in your environment. Use it intentionally, typically at the start of a script to ensure a clean slate, but never in a shared function or package.</p>
</div>
</div>
</section><section id="closing-graphics-devices" class="level3" data-number="7.19.2"><h3 data-number="7.19.2" class="anchored" data-anchor-id="closing-graphics-devices">
<span class="header-section-number">7.19.2</span> Closing Graphics Devices</h3>
<p>When working with plots, graphics devices can accumulate. Use <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.off()</a></code> to close them:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># Close the current graphics device</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="fu">dev.off</span>()</span>
<span id="cb79-3"><a href="#cb79-3"></a></span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="co"># Close all graphics devices</span></span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="fu">graphics.off</span>()</span>
<span id="cb79-6"><a href="#cb79-6"></a></span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="co"># List open devices</span></span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="fu">dev.list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is especially important when saving plots to files—if you don’t close the device, the file may not be properly saved:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># Save a plot to PDF</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="fu">pdf</span>(<span class="st">"my_plot.pdf"</span>)</span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="fu">dev.off</span>()  <span class="co"># Essential! Closes the file and finalizes it</span></span>
<span id="cb80-5"><a href="#cb80-5"></a></span>
<span id="cb80-6"><a href="#cb80-6"></a><span class="co"># Similarly for PNG</span></span>
<span id="cb80-7"><a href="#cb80-7"></a><span class="fu">png</span>(<span class="st">"my_plot.png"</span>, <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">600</span>)</span>
<span id="cb80-8"><a href="#cb80-8"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb80-9"><a href="#cb80-9"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="checking-your-environment" class="level3" data-number="7.19.3"><h3 data-number="7.19.3" class="anchored" data-anchor-id="checking-your-environment">
<span class="header-section-number">7.19.3</span> Checking Your Environment</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># List all objects in the environment</span></span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="fu">ls</span>()</span>
<span id="cb81-3"><a href="#cb81-3"></a></span>
<span id="cb81-4"><a href="#cb81-4"></a><span class="co"># List objects matching a pattern</span></span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"data"</span>)</span>
<span id="cb81-6"><a href="#cb81-6"></a></span>
<span id="cb81-7"><a href="#cb81-7"></a><span class="co"># Check if an object exists</span></span>
<span id="cb81-8"><a href="#cb81-8"></a><span class="fu">exists</span>(<span class="st">"my_variable"</span>)</span>
<span id="cb81-9"><a href="#cb81-9"></a></span>
<span id="cb81-10"><a href="#cb81-10"></a><span class="co"># See environment size</span></span>
<span id="cb81-11"><a href="#cb81-11"></a><span class="fu">object.size</span>(x)  <span class="co"># Size of one object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-r-summary" class="level2" data-number="7.20"><h2 data-number="7.20" class="anchored" data-anchor-id="sec-r-summary">
<span class="header-section-number">7.20</span> Summary</h2>
<p>This chapter introduced R programming fundamentals:</p>
<ul>
<li>R is designed for statistical computing with excellent graphics</li>
<li>Everything in R is an object with a class and type; use <code><a href="https://rdrr.io/r/base/class.html">class()</a></code>, <code><a href="https://rdrr.io/r/base/typeof.html">typeof()</a></code>, and <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> to explore objects</li>
<li>RStudio provides an integrated development environment</li>
<li>Variables are assigned with <code>&lt;-</code>; R is case-sensitive; avoid reserved words and shadowing built-in functions</li>
<li>Vectors are the fundamental data structure; operations are vectorized</li>
<li>Logical operators (<code>&amp;</code>, <code>|</code>, <code>!</code>, <code>%in%</code>) and comparison operators enable conditional logic</li>
<li>Floating-point comparisons require <code><a href="https://rdrr.io/r/base/all.equal.html">all.equal()</a></code> instead of <code>==</code>
</li>
<li>Data frames hold tabular data with columns of different types</li>
<li>Lists can contain elements of different types and lengths</li>
<li>Matrices are optimized for numerical computations</li>
<li>Functions perform operations; use <code>?function</code>, vignettes, and demos for help</li>
<li>Packages extend R’s capabilities; watch for namespace conflicts when loading multiple packages</li>
<li>The split-apply-combine pattern (<code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code>, <code><a href="https://rdrr.io/r/stats/aggregate.html">aggregate()</a></code>, <code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code>) is fundamental to data analysis</li>
<li>Conditional logic (<code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>) and loops enable programmatic control</li>
<li>Writing custom functions allows you to encapsulate repeated operations</li>
<li>R reads/writes CSV, TSV, and Excel files easily</li>
<li>Basic plotting is built-in; ggplot2 offers advanced graphics</li>
<li>Use <code><a href="https://rdrr.io/r/base/rm.html">rm()</a></code> and <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.off()</a></code> to clean up your environment and graphics devices</li>
</ul>
<p>These fundamentals prepare you for more advanced R programming, including the tidyverse packages covered in subsequent chapters.</p>
</section><section id="exercises" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice Exercises">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice Exercises
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Exercise 1: Vector Operations</strong></p>
<ol type="1">
<li>Create a vector of the first 20 integers</li>
<li>Calculate the mean, median, and standard deviation</li>
<li>Create a new vector containing only the even numbers</li>
<li>Calculate the sum of squares</li>
</ol>
<p><strong>Exercise 2: Data Frame Practice</strong></p>
<p>Create a data frame representing an experiment: 1. Include columns for: sample_id, group (control/treatment), measurement 2. Add 10 rows of sample data 3. Calculate the mean measurement for each group 4. Add a new column with log-transformed measurements</p>
<p><strong>Exercise 3: Lists and Matrices</strong></p>
<ol type="1">
<li>Create a list containing three components: a numeric vector, a character vector, and a data frame</li>
<li>Use indexing to extract the second element of the first component</li>
<li>Create a 4x4 matrix filled with the numbers 1-16</li>
<li>Calculate row sums and column means using <code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code>
</li>
</ol>
<p><strong>Exercise 4: Split-Apply-Combine</strong></p>
<p>Using the built-in <code>mtcars</code> dataset: 1. Calculate the mean <code>mpg</code> for each number of cylinders (<code>cyl</code>) using <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> 2. Use <code><a href="https://rdrr.io/r/stats/aggregate.html">aggregate()</a></code> to find the mean and standard deviation of <code>hp</code> by <code>cyl</code> 3. Write a custom function that returns the range (max - min) of a vector 4. Apply your function to find the range of <code>mpg</code> for each gear type</p>
<p><strong>Exercise 5: Programming Practice</strong></p>
<ol type="1">
<li>Use <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> to create a new vector that categorizes <code>mtcars$mpg</code> as “efficient” (≥25) or “inefficient” (&lt;25)</li>
<li>Write a for loop that calculates the cumulative sum of the first 10 integers</li>
<li>Create a function called <code>standardize()</code> that takes a vector and returns z-scores: (x - mean) / sd</li>
<li>Test your function on a vector of your choice</li>
</ol>
<p><strong>Exercise 6: Random Simulation</strong></p>
<ol type="1">
<li>Generate 1000 random samples from a normal distribution with mean=100 and sd=15</li>
<li>Create a histogram of the data</li>
<li>Calculate what proportion of values fall between 85 and 115</li>
<li>Compare to the theoretical proportion for a normal distribution</li>
</ol>
<p><strong>Exercise 7: File I/O</strong></p>
<ol type="1">
<li>Create a data frame with experimental data</li>
<li>Save it as a CSV file</li>
<li>Read it back into a new variable</li>
<li>Verify the data matches the original</li>
</ol>
</div>
</div>
</section><section id="additional-resources" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="additional-resources">Additional Resources</h2>
<p><strong>Official Documentation and Tutorials</strong></p>
<ul>
<li>
<a href="https://www.r-project.org">The R Project Homepage</a> — Official R website with downloads and documentation</li>
<li>
<a href="https://cran.r-project.org/doc/manuals/R-intro.html">An Introduction to R</a> — Comprehensive official manual</li>
<li>
<a href="https://r4ds.had.co.nz">R for Data Science</a> — Free online book covering the tidyverse approach</li>
</ul>
<p><strong>Quick References</strong></p>
<ul>
<li>
<a href="https://www.statmethods.net">Quick-R</a> — Concise reference for common R tasks</li>
<li>
<a href="https://posit.co/resources/cheatsheets/">RStudio Cheat Sheets</a> — One-page references for popular packages</li>
</ul>
<p><strong>Bioinformatics-Specific</strong></p>
<ul>
<li>
<a href="https://www.bioconductor.org">Bioconductor</a> — R packages for bioinformatics and computational biology</li>
<li>
<a href="http://library.open.oregonstate.edu/computationalbiology/">A Primer for Computational Biology</a> — O’Neil, S.T. 2017</li>
</ul>
<p><strong>Recommended Books</strong></p>
<ul>
<li>Logan, M. 2010. <em>Biostatistical Design and Analysis Using R</em> — Excellent introduction to R for statistical analysis in the life sciences</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-rproject2024" class="csl-entry" role="listitem">
R Core Team (2024). <a href="https://www.R-project.org/">R: A language and environment for statistical computing</a>.
</div>
<div id="ref-wickham2023r" class="csl-entry" role="listitem">
Wickham, H., Çetinkaya-Rundel, M., &amp; Grolemund, G. (2023). <em><a href="https://r4ds.hadley.nz/">R for data science: Import, tidy, transform, visualize, and model data</a></em>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/06-shell-scripting.html" class="pagination-link" aria-label="Shell Scripting">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Shell Scripting</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/08-tidy-data.html" class="pagination-link" aria-label="Tidy Data Principles">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tidy Data Principles</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 William A. Cresko | Knight Campus for Accelerating Scientific Impact</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/wcresko/BioE_Comp_Tools_Book/edit/main/chapters/07-r-programming.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/wcresko/BioE_Comp_Tools_Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>


</body></html>